<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"willzhuang.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.3.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta property="og:type" content="website">
<meta property="og:title" content="Zhuang&#39;s Diary">
<meta property="og:url" content="https://willzhuang.github.io/page/8/index.html">
<meta property="og:site_name" content="Zhuang&#39;s Diary">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Weiming Zhuang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://willzhuang.github.io/page/8/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>
<title>Zhuang's Diary</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Zhuang's Diary</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">日拱一卒，功不唐捐 // never too late</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Weiming Zhuang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">157</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">73</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://willzhuang.github.io/2020/05/30/%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/30/%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E5%85%A5%E9%97%A8/" class="post-title-link" itemprop="url">数字货币入门</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-30 14:57:01" itemprop="dateCreated datePublished" datetime="2020-05-30T14:57:01+08:00">2020-05-30</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2020-11-02 18:16:50" itemprop="dateModified" datetime="2020-11-02T18:16:50+08:00">2020-11-02</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>2020年1月21日，国际清算银行（BIS）、加拿大央行、英国央行、日本央行、欧央行、瑞典央行和瑞士央行官网同时发布一则信息：成立央行小组，开展CBDC应用案例研发。</p>
<h3 id="加拿大"><a href="#加拿大" class="headerlink" title="加拿大"></a>加拿大</h3><p>加拿大央行与瑞典央行已进入CBDC的试验测试阶段：2016年加拿大银行和新加坡金融管理局分别启动了Jasper和Ubin项目，探索分布式账户技术（DLT）在银行间大额支付系统的应用。双方都采用了R3联盟的DLT技术，开发了国内银行间支付结算的批发型数字货币原型系统，并经过几个阶段的后续试验验证，但仅限于在国内尝试。2019年加拿大银行和新加坡金管局合作开发Jasper-Ubin项目，在没有中介代理的环境下，实现了跨境、跨币种和跨平台支付中应用CBDC的试验成功。可以说在批发型CBDC应用于银行间大额支付结算和跨境支付方面，加拿大央行已经进入了概念验证试验的阶段，走在国际前列。</p>
<h3 id="瑞典"><a href="#瑞典" class="headerlink" title="瑞典"></a>瑞典</h3><p>瑞典央行的情况与加拿大不同，其无现金化趋势和速度为全球关注。发行CBDC“电子克朗“的目的是确保国家货币发行权、维护国内支付结算体系稳定发展、让金融服务普惠社会各类群体。从2017年启动电子克朗研发计划到目前进入测试阶段。它着眼的方向是零售型CBDC。</p>
<p>英国央行与欧央行对CBDC进行了原型设计与概念验证：笔者前文《英国：发行数字货币，还是发行塑料钞，这是一个问题》对英国开展数字货币的研发有介绍。简单说，英国作为全球首个央行数字货币模型RSCoin的创始者，虽然后来没有像加拿大、瑞典那样有更实质性的动作，但研究的步子一直没有停顿。加新两国的联合项目，也有英国的参与：2018年下，英格兰银行和加拿大央行、新加坡金管局以及4家商业银行、2家第三方机构参与了Jasper项目第4阶段的研究活动，对解决跨境支付存在的挑战和摩擦，创建交易新模式提出了建议，为2019年加新两国的DLT系统对接奠定了研究基础。此外，英国央行前行长马克·卡尼提出了一个“合成霸权货币”的概念，意欲以此取代目前以美元为主导的国际货币组合。</p>
<h3 id="欧央行"><a href="#欧央行" class="headerlink" title="欧央行"></a>欧央行</h3><p>对CBDC的研发早已做了大量准备工作，拉加德就任行长以来，欧央行在CBDC方面的研发大幅度提速，最近在它主导下，十几个欧盟国家央行与埃森哲和R3联盟合作，开发设计了一种基于DLT的“欧洲链”系统，解决CBDC小额支付中隐私与反洗钱的平衡问题。并经过概念验证。</p>
<h3 id="日本"><a href="#日本" class="headerlink" title="日本"></a>日本</h3><p>日本央行与瑞士央行暂处于CBDC理论研究阶段：日本是一个现金偏好明显的国家，80%日常购物仍使用现金（《日本时报》，2019）。甚至在2019政府为抵销消费税上涨而推出的非现金支付积分奖励情况下，民调50-70岁以上的人仍有31%至 54%无意使用非现支付手段（《每日新闻》，2019）。显然缺乏开展零售型CBDC研发的动机。天秤币发行计划推出后，日本官方态度保持低调，直到12月央行行长黑田东彦还称，当前没有推出CBDC的需要。但最近，其副行长雨宫正佳（Masayoshi Amamiya）表示：“在日本，公众对CBDC的需求可能会激增，这取决于结算系统的发展情况。如果发生这种情况，我们必须做好应对的准备。”</p>
<p>去年底央行发表了一个有关CBDC法律问题的报告，对CBDC发行后给现行私法和刑法、日本银行法、数据收集法、行政法和竞争法等法律领域带来的影响进行了探讨，是目前所见CBDC研究中讨论法律问题最为全面、深入的报告，说明准备工作并没有停顿。</p>
<h3 id="瑞士"><a href="#瑞士" class="headerlink" title="瑞士"></a>瑞士</h3><p>瑞士情况和日本相似，公众有强烈的现金偏好，即使是年轻人如此。其他国家纷纷出于反洗钱和反恐融资等目的而取消大面额现钞，降低现金消费限额，而瑞士法郎仍然保留最大面额1000瑞郎，现金交易上限是10万瑞郎。对于私人加密货币的态度它也和日本一样比较友好，有众多加密货币机构在瑞士设立。央行高管曾表态数字货币还是私有化比较合适，去年底瑞士联邦委员会仍称CBDC目前不会给瑞士带来好处，相反将引发金融稳定等风险。</p>
<h3 id="美国"><a href="#美国" class="headerlink" title="美国"></a>美国</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.digitaldollarproject.org/"><em>DIGITAL DOLLARS: ELECTRONIC CASH VS DIGITAL CURRENCY</em></a><br><em>New technological capabilities have created a dynamic, via tokenization, that allows for a digital version of central bank currency, without sacrificing stability, security or privacy.  This is about more than a federal government payments infrastructure.</em></p>
<p><em>In addition to coins and paper money, a dollar-based Central Bank Digital Currency (CBDC) could operate as a third form of money backed by the full faith and credit of the United States of America, but brings it into the truly portable digital world, opening up new possible use cases and applications.</em></p>
<p><em>Considering the importance of the U.S. dollar to the global economy, our work on a U.S. dollar-based CBDC via the Digital Dollar Project is a logical and important step as we drive towards a digital transformation of the global financial system.</em> </p>
<p><em>The Digital Dollar Project will be driven by an open, innovative, collaborative mindset, which will explore the full range of possibilities on how to best bring this to fruition</em></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.digitaldollarproject.org/">数字美元：电子现金与数字货币</a><br>新的技术通过Token化创建了一种动态的功能，该功能允许在不牺牲稳定性，安全性或私密性的情况下使用数字版本的中央银行货币。这远远超出了美国联邦政府的支付基础设施。</p>
<p>除硬币和纸币外，以美元为基础的中央银行数字货币（CBDC）可以作为第三种形式的货币，以美利坚合众国的充分信仰和信誉为后盾，但将其带入真正的便携式数字世界，打开新的可能的用例和应用程序。</p>
<p>考虑到美元对全球经济的重要性，在我们朝着全球金融体系的数字化转型迈进的过程中，我们通过“数字美元项目”在以美元为基础的CBDC方面的工作是合乎逻辑且重要的一步。</p>
<p>数字美元项目将以开放，创新，协作的心态驱动，它将探索各种方式来最大程度地实现这一目标。</p>
<p><img src="/2020/05/30/%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E5%85%A5%E9%97%A8/5.png"></p>
<p>和中国CBDC的设计几乎完全一致。本白皮书内容中并未提及”blockchain”。白皮书作者为Digital Dollar Project办公室与埃森哲</p>
<p><img src="/2020/05/30/%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E5%85%A5%E9%97%A8/6.png"></p>
<h3 id="中国"><a href="#中国" class="headerlink" title="中国"></a>中国</h3><p><img src="/2020/05/30/%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E5%85%A5%E9%97%A8/1.png"></p>
<p>中国人民银行拟推出的CBDC本质上是法定货币人民币的数字化版本，由法币储备（M0）按照1比1的比例进行兑换。</p>
<p>“从央行角度来讲，无论你是区块链还是集中账户体系，是电子支付还是所谓的移动货币，你采取任何一种技术路线，央行都可以适应。当然，你的技术路线要符合我们的门槛，比如因为是针对零售，至少要满足高并发需求，至少达到30万笔/秒。” 穆长春在会议上说到。</p>
<p>易纲在新闻发布会上表示，人民银行把数字货币和电子支付工具结合起来，将推出一揽子计划，目标是替代一部分现金。</p>
<p>作为理论上无成本的交换媒介，CBDC将能够提高支付系统的效率。 同时，在跨境金融交易的情况下，CBDC可以促成更快，更安全的结算，并允许数字金融服务领域进行更多的创新。此外，CBDC的推出还有助于打击假币，因为每个令牌和交易都需要由集中式系统进行实时的密码验证。</p>
<p>农业银行的PoC如下：</p>
<p><img src="/2020/05/30/%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E5%85%A5%E9%97%A8/2.jpg"></p>
<p><img src="/2020/05/30/%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E5%85%A5%E9%97%A8/3.png"></p>
<p><img src="/2020/05/30/%E6%95%B0%E5%AD%97%E8%B4%A7%E5%B8%81%E5%85%A5%E9%97%A8/4.jpg"></p>
<h3 id="姚前"><a href="#姚前" class="headerlink" title="姚前"></a>姚前</h3><p>2020-04刊文</p>
<p>目前大多数国家的央行数字货币（Central Bank Digital Currency，CBDC）实验都是基于区块链技术展开的。但时至今日，CBDC是否采用区块链技术依然存有争议，一种典型的观点是区块链的去中心化与中央银行的集中管理存在冲突，因此不建议CBDC采用该技术。笔者认为，区块链技术正以前所未有的速度在发展，并与各项主流技术在深度融合，因此无论从技术角度还是业务角度，现实应用中的区块链都与“原教旨主义”的理解有所不同。如何运用区块链技术来更好的服务于中心化管理下的分布式运营，可能是CBDC当前需要重点探索的方向。本文以三个典型场景为例，讨论了区块链在CBDC中的可能应用和解决方案，指出虽然区块链的技术特点是不依赖中心机构，但不代表其不能纳入到现有中心机构的体系内，只要通过合理的设计，中央银行恰恰可以利用区块链将分布式运营有效整合起来，更好地实现对CBDC的中心化管控，两者并不存在必然冲突。</p>
<p><strong>场景一：CBDC验钞</strong></p>
<p>笔者曾提出“一币、两库、三中心”的央行数字货币体系。“一币”即央行数字货币，是由央行担保并签名发行的代表具体金额的加密数字串。“两库”指数字货币发行库和数字货币商业银行库，前者是中央银行在CBDC私有云上存放CBDC发行基金的数据库，按照中央银行的现金运营管理体系进行管理，后者是商业银行存放CBDC的数据库，可以在商业银行的数据中心也可以在CBDC私有云上，遵循商业银行现金运营管理规范。“三中心”则包括认证中心、登记中心和大数据分析中心。</p>
<p>其中，登记中心记录CBDC及对应用户身份，完成权属登记，并记录流水，完成CBDC产生、流通、清点核对及消亡全过程登记。其主要功能组件分为发行登记、确权发布、确权查询网站应用、分布式账本服务几个部分。发行登记进行CBDC的发行、流通、回笼过程及权属记录；确权发布将发行登记的权属信息进行脱敏后异步发布到CBDC确权分布式账本中；确权查询网站依托分布式账本面向公众提供在线权属查询服务；分布式账本服务保证中央银行与商业银行的CBDC权属信息的一致。</p>
<p>通俗来说，可以理解为我们在登记中心利用分布式账本不可篡改、不可伪造特性，构建了一个“网上验钞机”，即CBDC确权账本，对外通过互联网提供查询服务。这种设计对当前分布式账本技术而言，在中央银行和商业银行既集中又分散的二元模式下，提供了一种巧妙的应用思路，一方面将核心的发行登记账本对外界进行隔离和保护，同时利用分布式账本优势，提高确权查询数据和系统的安全性和可信度；另一方面，由于分布式账本仅用于对外提供查询访问，交易处理仍由发行登记系统来完成，以细化原子交易颗粒度的方式来进行交易的分布式计算处理，这样可以通过业务设计的方式有效规避现有分布式账本在交易处理上的技术性能瓶颈。显然，这样的设计充分发挥了区块链的技术优势，保障CBDC验钞的可信，但并未影响中央银行对CBDC的全局管控。</p>
<p>尤其是，这种双账本包容性设计，既延续了传统技术的成熟稳定性，又为新的分布式账本技术留有空间，使得两种分布式技术相互兼容、并行不悖、优势互补，并在演进过程中，竞争择优。</p>
<p><strong>场景二：批发端支付结算</strong></p>
<p>目前各国正在开展的CBDC实验，主要针对批发端场景，且大多基于区块链技术。比如，加拿大的 Jasper 项目，试验基于区块链技术的大额支付系统；新加坡的Ubin项目，评估在分布式账本上以数字新元的代币形式进行支付结算的效果；欧洲央行和日本央行的Stella项目，旨在研究分布式账本技术（DLT）在金融市场基础设施中的应用，评估现有支付体系的特定功能是否能够在DLT环境下安全高效地运转。还有中国香港的LionRock项目、泰国的Inthanon项目等均是试验基于区块链技术的CBDC。这些区块链技术的应用都在中央银行的集中管理和严格控制下展开。</p>
<p>以新加坡的Ubin项目为例，其采用了与加拿大Jasper项目一样的数字存托凭证（Digital Deposit Receipt，DDR）模式。为了支持分布式账本中DDR的发行，现有新加坡电子支付系统（MEPS +），也就是新加坡的RTGS系统，专门建立一个DDR资金抵押账户，每日开始时，参与银行请求中央银行将其RTGS账户中的资金转移到DDR资金抵押账户，以此作为抵押，分布式账本创建相应等值的DDR，发送到各银行的DDR钱包，由此参与银行之间可开展基于分布式账本的转账和支付。日终，分布式账本系统将向MEPS+发送一个网络结算文件，MEPS+依此调整DDR资金抵押账户余额，匹配参与者在DLT网络中的DDR余额。</p>
<p>可见，去中心化的分布式账本与现有成熟的中央主导的金融基础设施并不排斥，完全可以相互融合，相互补充。一方面，基于区块链的DDR支付系统为现有RTGS系统提供了一种不依赖传统账户的新型支付方式，有效补充了现有支付清算体系。另一方面，DDR作为RTGS中电子化法定货币的数字化形态延伸，其最终可以转换回RTGS账户价值，并通过RTGS系统对外结算，也就是说，RTGS系统解决了区块链DDR到传统账户资金的结算最终性问题，这侧面也说明了区块链的结算最终性可以有机融合到现有清结算体系中。此外，由于DDR 是通过100%资金抵押生成，不影响货币供应量，因此分布式账本也不会影响到中央银行对货币的总量管控。</p>
<p>显然，在技术逻辑上，中央银行主导的基于区块链的新型支付系统是完全可行的。某种意义上，参照Ubin项目的数字存托凭证模式，可以无需借助类似网联支付平台这样的中间渠道，各家支付机构和商业银行可以通过在金融专网中构建对等网络的方式，以统一的区块链网络连接起来，开展支付清算。考虑到目前区块链技术的交易性能还在演进的过程中，上述清算业务宜在批发层面展开。</p>
<p>应该说，区块链的去中心化是指去中介，但不去监管。在联盟链的环境下，中央银行等监管部门不但可以对区块链所承载的业务及其风险进行中心化管控，而且还可以实现穿透式非现场监管。</p>
<p><strong>场景三：现金数字化</strong></p>
<p>似乎现金的数字化与准备金的数字化（即前述的数字存托凭证）没有本质上的差别，只是前者面向社会公众，而后者仅局限于银行间流通，但面向社会公众就引发了一个难题，倘若允许公众在中央银行开户，中央银行将面临着极大的服务压力，并可能引发存款搬家，导致狭义银行。</p>
<p>一种解决思路是100%备付准备金模式。代理运营机构向中央银行存缴100%备付准备金，随后在其账本上发行相应数额的数字货币可视为央行数字货币。IMF经济学家把它称为合成央行数字货币（sCBDC）。据此，我国第三方支付机构100%备付准备金存缴中央银行之后，它们虚拟账户中的资金就是央行数字货币了。若此，则中国早就是全球首个实现法币数字化的泱泱大国。</p>
<p>但仔细琢磨，这一思路存在着缺陷：一是技术上，100%准备金存缴意味着数字货币的发行、流通、回笼等全生命周期均要依附于传统账户体系，尤其是跨机构CBDC的流通，除了CBDC账本更新外，还要处理相应准备金账户间的清结算，只能牺牲系统灵活性，加以额度管控的方式去应对，而且还需要成立专门的清算机构提供互联互通服务。这不仅增大中央银行中心系统的压力和复杂性，也就是说，还是没有解决央行的服务压力，而且难以实现“账户松耦合”的要求；二是管理上，这种方式央行和运营机构在发行流通过程中是紧绑定的，央行依然承担中心化压力。如何保证代理运营机构100%备付准备金后没有超发货币，尤其是当代理运营机构运营的支付网络不受中心化管控时，中央银行更难以掌控运营代理层的货币发行量，这在一定程度上也构成了某些反对区块链技术应用于CBDC的理由。</p>
<p>视角决定思路，如果换一个角度看，会得到另一种完全不同的更优的解决方案。现在提到CBDC，许多人是自顶向下，从中央银行发行到商业银行，再从商业银行发行到个人的视角来理解CBDC的技术逻辑，所以总有一个乱发票子的担忧。实物货币受制于印钞造币环节，非如此不可，但数字货币的“印钞造币”可以瞬间完成，无需这种制约，而这才是其优势所在。如果以自底向上的视角看，可以惊讶地发现，数字货币最终用户并没有“发行”的概念，而是“兑换”的理念，是手里有多少现金，有多少存款，去兑换CBDC。所以从这角度看，乱发票子的问题并没有那么突出，代理运营机构兑换出的CBDC，不是中央银行给与的货币发行额度，而是用户用实实在在的真金白银等额兑换的结果，中央银行只是站在全局的角度统计相关信息并予以监管。实际上，目前无论是私人的稳定代币，还是各国研发的CBDC，都是按需兑换的思路，而不是扩表发行，这是一个非常关键的点。这一点对货币政策而言，意义重大，表明其没有根本性的变化；对于技术路线而言，意味着可以不拘泥于实物货币的发行流程，系统的设计可以更为简洁，局面因此大为改观。</p>
<p>基于自底向上的兑换视角，可以提出一个CBDC简化版实现方案。具体思路是：业务由底层客户发起，客户申请兑换CBDC并将其托管至代理运营机构。代理运营机构记录客户托管CBDC的明细账本，为每个托管客户单独建立明细账。代理运营机构收到客户兑换并托管CBDC请求后，在收取现金或扣减客户存款的同时，将等额CBDC记录在该客户明细账下，然后向中央银行缴回现金或扣减存款准备金，并以批量方式混同托管至中央银行。中央银行记录代理运营机构的总账本，是一个总量的概念，与代理运营机构的明细账本构成上下两级双账本结构。当同一家代理运营机构的客户之间发生CBDC支付时，只需在该机构的明细账本上变更权属，无需变更中央银行总账本。当发生跨代理运营机构的CBDC支付时，首先由相关的代理运营机构交互处理，在各自明细账本上完成CBDC的权属变更，然后由中央银行在总账本上定期批量变更各机构总账。为提高效率，减少风险，可考虑引入持续净额头寸调整、流动性节约（LSM）等机制。</p>
<p>这一方案有以下优点：一是明确了持有者对CBDC具有完全掌控权。未经持有者的签名或同意，其他任何主体均不能动用CBDC。这就使CBDC真正具备现金属性，与存款类货币本质不同。二是央行不对底层客户单独建档，也就是说，普通公众不在中央银行“开户”，降低了中央银行的服务压力，同时真正实现了“账户松耦合”的要求，因准备金账户批量调整，CBDC系统相对独立于RTGS系统。三是各家代理运营机构可以根据自己的理解，在满足统一标准的基础上，发挥各自特长构建自身的数字货币代理运营系统，有助于竞争，便于客户选择。由于是按需兑换，而不是扩表发行，因此就没有了运营代理层超发货币的担忧。另外，虽然底层客户交易信息只存储在中间层，不存储在中央银行账本上，出于政策需要或监管需要，中央银行有权向下一层的代理运营机构提取信息明细，从而在分布式运营条件下实现了中心化管控。</p>
<p><strong>结语</strong></p>
<p>区块链作为一种可能成为未来金融基础设施的新兴技术，对于中央银行和商业银行二元模式而言，有助于实现分布式运营，同时并不会影响集中管理。本文通过三个典型场景进一步论证了区块链技术的去中心化特点可以纳入到CBDC的分布式运营与央行的集中管理体系中。可将区块链技术应用于CBDC的登记账本，对CBDC验钞，保障可信。在批发端场景，各国开展的实验也表明，基于区块链技术的CBDC和支付系统具有可行性。而在现金数字化的零售场景，本文认为之所以目前CBDC研发方案一直无法发挥出央行中心管控下的分布式运营应有的优势，问题在于自顶向下的“发行”视角，对此，本文基于自底向上的“兑换”视角，提出了全新的CBDC实现方案，这一方案同时实现了“管控中心化，运营分布式”的目标。</p>
<p>“物物而不物于物”，“形而上者之为道，形而下者之为器，以道御器”，这是我国古代哲人的思想。集中管理与分布处理历来需要辩证统一地看待，不宜“先入为主”地将制度层面的中心化管控与技术层面的分布式处理简单对立起来。当前，各国基于区块链技术的央行数字货币实验进展迅速，内容已涉及隐私保护、数据安全、交易性能、身份认证、券款对付、款款对付等广泛议题。作为一项崭新的技术，区块链当然还有这样那样的缺点与不足，但这不是我们轻言放弃的理由。Facebook的Libra项目已在研发基于安全、可扩展和可靠区块链的新一代金融基础设施，这是一个全新的赛道，机遇与挑战并存，“逆水行舟，不进则退”。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://willzhuang.github.io/2020/05/19/%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E%E6%AF%94%E8%BE%83%E4%B8%8E%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/19/%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E%E6%AF%94%E8%BE%83%E4%B8%8E%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">零知识证明比较与分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-19 17:26:31" itemprop="dateCreated datePublished" datetime="2020-05-19T17:26:31+08:00">2020-05-19</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2020-11-02 18:16:50" itemprop="dateModified" datetime="2020-11-02T18:16:50+08:00">2020-11-02</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li>Zero-Knowledge Proofs ==&gt; <a target="_blank" rel="noopener" href="https://zkp.science/">https://zkp.science/</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/matter-labs/awesome-zero-knowledge-proofs">https://github.com/matter-labs/awesome-zero-knowledge-proofs</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://willzhuang.github.io/2020/05/18/%E4%BD%93%E9%AA%8CHyperledger-Burrow-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/18/%E4%BD%93%E9%AA%8CHyperledger-Burrow-4/" class="post-title-link" itemprop="url">体验Hyperledger-Burrow-4</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-18 16:26:31" itemprop="dateCreated datePublished" datetime="2020-05-18T16:26:31+08:00">2020-05-18</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2020-11-02 18:16:50" itemprop="dateModified" datetime="2020-11-02T18:16:50+08:00">2020-11-02</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="CheckTx"><a href="#CheckTx" class="headerlink" title="CheckTx"></a>CheckTx</h3><p>在burrow项目中，<code>/consensus/abci/app.go</code>:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(app *App)</span> <span class="title">CheckTx</span><span class="params">(req types.RequestCheckTx)</span> <span class="title">types</span>.<span class="title">ResponseCheckTx</span></span> &#123;</span><br><span class="line">	......</span><br><span class="line">	checkTx := ExecuteTx(logHeader, app.checker, app.txDecoder, req.GetTx())</span><br><span class="line">	......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此处的 <code>ExecuteTx</code> 位于 <code>/execution/execution.go</code> :</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// If the tx is invalid, an error will be returned.</span></span><br><span class="line"><span class="comment">// Unlike ExecBlock(), state will not be altered.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(exe *executor)</span> <span class="title">Execute</span><span class="params">(txEnv *txs.Envelope)</span> <span class="params">(txe *exec.TxExecution, err error)</span></span> &#123;</span><br><span class="line">	......</span><br><span class="line">	<span class="comment">// Verify transaction signature against inputs</span></span><br><span class="line">	err = txEnv.Verify(exe.params.ChainID)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		logger.InfoMsg(<span class="string">&quot;Transaction Verify failed&quot;</span>, structure.ErrorKey, err)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> txExecutor, ok := exe.contexts[txEnv.Tx.Type()]; ok &#123;</span><br><span class="line">		<span class="comment">// Establish new TxExecution</span></span><br><span class="line">		txe := exe.block.Tx(txEnv)</span><br><span class="line">		<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">if</span> r := <span class="built_in">recover</span>(); r != <span class="literal">nil</span> &#123;</span><br><span class="line">				err = fmt.Errorf(<span class="string">&quot;recovered from panic in executor.Execute(%s): %v\n%s&quot;</span>, txEnv.String(), r,</span><br><span class="line">					debug.Stack())</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;()</span><br><span class="line"></span><br><span class="line">		err = exe.validateInputsAndStorePublicKeys(txEnv)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			logger.InfoMsg(<span class="string">&quot;Transaction validate failed&quot;</span>, structure.ErrorKey, err)</span><br><span class="line">			txe.PushError(err)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		err = txExecutor.Execute(txe, txe.Envelope.Tx.Payload)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			logger.InfoMsg(<span class="string">&quot;Transaction execution failed&quot;</span>, structure.ErrorKey, err)</span><br><span class="line">			txe.PushError(err)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Increment sequence numbers for Tx inputs</span></span><br><span class="line">		err = exe.updateSequenceNumbers(txEnv)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			logger.InfoMsg(<span class="string">&quot;Updating sequences failed&quot;</span>, structure.ErrorKey, err)</span><br><span class="line">			txe.PushError(err)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// Return execution for this tx</span></span><br><span class="line">		<span class="keyword">return</span> txe, <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;unknown transaction type: %v&quot;</span>, txEnv.Tx.Type())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此处 <code>txExecutor.Execute(txe, txe.Envelope.Tx.Payload)</code> 因 <code>txExecutor</code> 类型的不同，分别对应至 <code>/txs/payload/payload.go</code> 中的 <code>Type</code> ，如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Account transactions</span></span><br><span class="line">TypeSend  = Type(<span class="number">0x01</span>)</span><br><span class="line">TypeCall  = Type(<span class="number">0x02</span>)</span><br><span class="line">TypeName  = Type(<span class="number">0x03</span>)</span><br><span class="line">TypeBatch = Type(<span class="number">0x04</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Validation transactions</span></span><br><span class="line">TypeBond   = Type(<span class="number">0x11</span>)</span><br><span class="line">TypeUnbond = Type(<span class="number">0x12</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Admin transactions</span></span><br><span class="line">TypePermissions = Type(<span class="number">0x21</span>)</span><br><span class="line">TypeGovernance  = Type(<span class="number">0x22</span>)</span><br><span class="line">TypeProposal    = Type(<span class="number">0x23</span>)</span><br><span class="line">TypeIdentify    = Type(<span class="number">0x24</span>)</span><br></pre></td></tr></table></figure>

<p>根据 <code>Type</code> 不同，在如下 <code>contexts</code> 对应的 Context 的 Execute 方法则会不同，分别对应为如下代码文件中的 <code>Execute</code> 方法：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">├── burrow</span><br><span class="line">│   ├── execution</span><br><span class="line">│   │   ├── contexts</span><br><span class="line">│   │   │   ├── bond_context.go</span><br><span class="line">│   │   │   ├── bond_context_test.go</span><br><span class="line">│   │   │   ├── call_context.go</span><br><span class="line">│   │   │   ├── governance_context.go</span><br><span class="line">│   │   │   ├── identify_context.go</span><br><span class="line">│   │   │   ├── name_context.go</span><br><span class="line">│   │   │   ├── permissions_context.go</span><br><span class="line">│   │   │   ├── proposal_context.go</span><br><span class="line">│   │   │   ├── send_context.go</span><br><span class="line">│   │   │   ├── shared.go</span><br><span class="line">│   │   │   └── unbond_context.go</span><br></pre></td></tr></table></figure>

<p>例如，在执行发送 <code>TypeCall</code> 类型的交易时， <code>txExecutor.Execute(txe, txe.Envelope.Tx.Payload)</code> 对应的具体逻辑为 <code>/execution/contexts/call_context.go</code> 中的 <code>Execute</code> 方法：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ctx *CallContext)</span> <span class="title">Execute</span><span class="params">(txe *exec.TxExecution, p payload.Payload)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> ok <span class="keyword">bool</span></span><br><span class="line">	ctx.tx, ok = p.(*payload.CallTx)</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		<span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;payload must be CallTx, but is: %v&quot;</span>, p)</span><br><span class="line">	&#125;</span><br><span class="line">	ctx.txe = txe</span><br><span class="line">	inAcc, outAcc, err := ctx.Precheck()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> err</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// That the fee less than the input amount is checked by Precheck to be greater than or equal to fee</span></span><br><span class="line">	value := ctx.tx.Input.Amount - ctx.tx.Fee</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ctx.RunCall &#123;</span><br><span class="line">		<span class="keyword">return</span> ctx.Deliver(inAcc, outAcc, value)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ctx.Check(inAcc, value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="DeliverTx"><a href="#DeliverTx" class="headerlink" title="DeliverTx"></a>DeliverTx</h3><p>在执行 <code>ExecuteTx(logHeader, app.committer, app.txDecoder, req.GetTx())</code> 中，<code>executor execution.Executor</code> 被指定为 <code>app.committer</code> , 与 CheckTX 执行同样的 <code>Execute</code> 逻辑</p>
<h3 id="Commit"><a href="#Commit" class="headerlink" title="Commit"></a>Commit</h3><p>具体执行逻辑为 <code>/execution/execution.go</code> 中的 <code>func (exe *executor) Commit(header *abciTypes.Header) (stateHash []byte, err error)</code> </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://willzhuang.github.io/2020/05/18/%E4%BD%93%E9%AA%8CHyperledger-Burrow-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/18/%E4%BD%93%E9%AA%8CHyperledger-Burrow-3/" class="post-title-link" itemprop="url">体验Hyperledger-Burrow-3</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-18 14:52:31" itemprop="dateCreated datePublished" datetime="2020-05-18T14:52:31+08:00">2020-05-18</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2020-11-02 18:16:50" itemprop="dateModified" datetime="2020-11-02T18:16:50+08:00">2020-11-02</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="burrow-natives-Dump-Solidity-interface-contracts-for-Burrow-native-contracts"><a href="#burrow-natives-Dump-Solidity-interface-contracts-for-Burrow-native-contracts" class="headerlink" title="./burrow natives , Dump Solidity interface contracts for Burrow native contracts."></a>./burrow natives , Dump Solidity interface contracts for Burrow native contracts.</h3><p>抽出Burrow内置的solidity接口合约。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">➜  script ./burrow natives       </span><br><span class="line">pragma solidity &gt;=<span class="number">0.4</span><span class="number">.24</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* acmstate.ReaderWriter for managing Secure Native authorizations.</span></span><br><span class="line"><span class="comment">* <span class="doctag">@dev </span>This interface describes the functions exposed by the native permissions layer in burrow.</span></span><br><span class="line"><span class="comment">* <span class="doctag">@dev </span>These functions can be accessed as if this contract were deployed at a special address (0x0A758FEB535243577C1A79AE55BED8CA03E226EC).</span></span><br><span class="line"><span class="comment">* <span class="doctag">@dev </span>This special address is defined as the last 20 bytes of the sha3 hash of the the contract name.</span></span><br><span class="line"><span class="comment">* <span class="doctag">@dev </span>To instantiate the contract use:</span></span><br><span class="line"><span class="comment">* <span class="doctag">@dev </span>Permissions permissions = Permissions(address(uint256(keccak256(&quot;Permissions&quot;))));</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">interface Permissions &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@notice </span>Adds a role to an account</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Account account address</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Role role name</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return </span>result whether role was added</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">addRole</span>(<span class="params">address _account, string memory _role</span>) <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> (<span class="params">bool _result</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@notice </span>Removes a role from an account</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Account account address</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Role role name</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return </span>result whether role was removed</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">removeRole</span>(<span class="params">address _account, string memory _role</span>) <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> (<span class="params">bool _result</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@notice </span>Indicates whether an account has a role</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Account account address</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Role role name</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return </span>result whether account has role</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">hasRole</span>(<span class="params">address _account, string memory _role</span>) <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> (<span class="params">bool _result</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@notice </span>Sets the permission flags for an account. Makes them explicitly set (on or off).</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Account account address</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Permission the base permissions flags to set for the account</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Set whether to set or unset the permissions flags at the account level</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return </span>The permission flag that was set as uint64</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setBase</span>(<span class="params">address _account, uint64 _permission, bool _set</span>) <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> (<span class="params">uint64 _result</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@notice </span>Unsets the permissions flags for an account. Causes permissions being unset to fall through to global permissions.</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Account account address</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Permission the permissions flags to unset for the account</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return </span>The permission flag that was unset as uint64</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">unsetBase</span>(<span class="params">address _account, uint64 _permission</span>) <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> (<span class="params">uint64 _result</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@notice </span>Indicates whether an account has a subset of permissions set</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Account account address</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Permission the permissions flags (mask) to check whether enabled against base permissions for the account</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return </span>result whether account has the passed permissions flags set</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">hasBase</span>(<span class="params">address _account, uint64 _permission</span>) <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> (<span class="params">bool _result</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@notice </span>Sets the global (default) permissions flags for the entire chain</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Permission the permissions flags to set</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param </span>Set whether to set (or unset) the permissions flags</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return </span>The permission flag that was set as uint64</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setGlobal</span>(<span class="params">uint64 _permission, bool _set</span>) <span class="title">public</span> <span class="title">view</span> <span class="title">returns</span> (<span class="params">uint64 _result</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="burrow-dump-Dump-chain-state-to-backup"><a href="#burrow-dump-Dump-chain-state-to-backup" class="headerlink" title="./burrow dump , Dump chain state to backup"></a>./burrow dump , Dump chain state to backup</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  script ./burrow dump local backup_dump</span><br><span class="line">Sourcing config <span class="keyword">from</span> first <span class="keyword">of</span>: defaults</span><br><span class="line">Sourcing config <span class="keyword">from</span> defaults</span><br><span class="line">Sourcing config <span class="keyword">from</span> first <span class="keyword">of</span>: genesis file at genesis.json</span><br><span class="line">Sourcing config <span class="keyword">from</span> genesis file at genesis.json</span><br><span class="line">&#123;<span class="string">&quot;log_channel&quot;</span>:<span class="string">&quot;Info&quot;</span>,<span class="string">&quot;message&quot;</span>:<span class="string">&quot;Dumping accounts&quot;</span>&#125;</span><br><span class="line">&#123;<span class="string">&quot;log_channel&quot;</span>:<span class="string">&quot;Info&quot;</span>,<span class="string">&quot;message&quot;</span>:<span class="string">&quot;Dumping names&quot;</span>&#125;</span><br><span class="line">&#123;<span class="string">&quot;log_channel&quot;</span>:<span class="string">&quot;Info&quot;</span>,<span class="string">&quot;message&quot;</span>:<span class="string">&quot;Dumping events&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h3 id="burrow-restore-Restore-new-chain-from-backup"><a href="#burrow-restore-Restore-new-chain-from-backup" class="headerlink" title="./burrow restore, Restore new chain from backup"></a>./burrow restore, Restore new chain from backup</h3><p>从backup文件恢复区块链</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://willzhuang.github.io/2020/05/12/%E4%BD%93%E9%AA%8CHyperledger-Burrow-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/05/12/%E4%BD%93%E9%AA%8CHyperledger-Burrow-2/" class="post-title-link" itemprop="url">体验Hyperledger-Burrow-2</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-12 09:08:31" itemprop="dateCreated datePublished" datetime="2020-05-12T09:08:31+08:00">2020-05-12</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2020-11-02 18:16:50" itemprop="dateModified" datetime="2020-11-02T18:16:50+08:00">2020-11-02</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>文档链接=&gt;<a target="_blank" rel="noopener" href="https://hyperledger.github.io/burrow/">https://hyperledger.github.io/burrow/</a></p>
<p>github链接=&gt;<a target="_blank" rel="noopener" href="https://github.com/hyperledger/burrow/">https://github.com/hyperledger/burrow/</a></p>
<p>接前文《体验Hyperledger-Burrow-1》，启动4个节点如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  script ps aux | grep burrow</span><br><span class="line">USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">will      21409  2.1  0.8 133268 66036 pts/1    SNl  08:52   1:02 ./burrow start --config=burrow000.toml</span><br><span class="line">will      21410  1.9  0.7 133268 59212 pts/1    SNl  08:52   0:56 ./burrow start --config=burrow001.toml</span><br><span class="line">will      21411  2.0  0.8 133268 65924 pts/1    SNl  08:52   0:59 ./burrow start --config=burrow002.toml</span><br><span class="line">will      21416  2.0  0.7 133268 63416 pts/1    SNl  08:52   1:01 ./burrow start --config=burrow003.toml</span><br></pre></td></tr></table></figure>

<h3 id="制作增加节点的配置文件"><a href="#制作增加节点的配置文件" class="headerlink" title="制作增加节点的配置文件"></a>制作增加节点的配置文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./burrow spec -v1 | ./burrow configure -s- &gt; burrow_add.toml</span><br></pre></td></tr></table></figure>

<p>运行完成后，增加公私钥文档如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  data pwd</span><br><span class="line">/home/will/documents/burrow/script/.keys/data</span><br><span class="line">➜  data cat 035B1B192A16FF8086C36304024010502CEB2DE0.json </span><br><span class="line">&#123;&quot;CurveType&quot;:&quot;ed25519&quot;,&quot;Address&quot;:&quot;5ECA9967F5D363F21C4606CC971710200A64C5BC&quot;,&quot;PublicKey&quot;:&quot;4F3530024CF75A7AFC4D168CF2975C285D03CEBB1CBE82E21AD9C76531A63128&quot;,&quot;AddressHash&quot;:&quot;go-crypto-0.5.0&quot;,&quot;PrivateKey&quot;:&#123;&quot;Crypto&quot;:&quot;none&quot;,&quot;Plain&quot;:&quot;486059FB274248423F92B7522D5A237AB99B38C80F84D46F720EAE1506D8E2DF4F3530024CF75A7AFC4D168CF2975C285D03CEBB1CBE82E21AD9C76531A63128&quot;&#125;&#125;</span><br><span class="line">➜  names pwd</span><br><span class="line">/home/will/documents/burrow/script/.keys/names</span><br><span class="line">➜  names cat Validator_0</span><br><span class="line">035B1B192A16FF8086C36304024010502CEB2DE0</span><br></pre></td></tr></table></figure>

<p>修改burrow_add.toml配置:<br>1.删除GenesisDoc的内容，因为genesis.json中已经包含了节点们的GenesisDoc；<br>2.增加PersistentPeers，PersistentPeers在burrow000.toml中可以找到；<br>3关闭grpc端口，关闭rpc.info等，否则会跟已有的4个节点端口冲突</p>
<h3 id="发出增加validator的Tx"><a href="#发出增加validator的Tx" class="headerlink" title="发出增加validator的Tx"></a>发出增加validator的Tx</h3><p>制作增加validator Tx 交易的文件：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jobs:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">AddValidator</span></span><br><span class="line">  <span class="attr">update-account:</span></span><br><span class="line">    <span class="attr">target:</span> <span class="string">4F3530024CF75A7AFC4D168CF2975C285D03CEBB1CBE82E21AD9C76531A63128</span></span><br><span class="line">    <span class="attr">power:</span> <span class="number">222222</span></span><br><span class="line">    <span class="attr">permissions:</span> [<span class="string">root</span>, <span class="string">send</span>, <span class="string">call</span>, <span class="string">createContract</span>, <span class="string">createAccount</span>, <span class="string">bond</span>, <span class="string">name</span>, <span class="string">proposal</span>, <span class="string">input</span>, <span class="string">batch</span>, <span class="string">identify</span>, <span class="string">hasBase</span>, <span class="string">setBase</span>, <span class="string">unsetBase</span>, <span class="string">setGlobal</span>, <span class="string">hasRole</span>, <span class="string">addRole</span>, <span class="string">removeRole</span>]</span><br></pre></td></tr></table></figure>

<p>其中<code>4F3530024CF75A7AFC4D168CF2975C285D03CEBB1CBE82E21AD9C76531A63128</code> 是新节点的publickey。</p>
<p>执行交易命令（<code>DCF0F3BD45EA59B2D471729EC22838DF7B119012</code> 是增加节点前已经启动的4个节点中的Full Account节点。），即在已经启动的节点上执行本交易：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">./burrow deploy -c 127.0.0.1:10997 --mempool-signing=true --address=DCF0F3BD45EA59B2D471729EC22838DF7B119012 deploy.yaml</span><br><span class="line">log_channel=Info message=&quot;Using chain&quot; Chain=127.0.0.1:10997 Signer=</span><br><span class="line">log_channel=Info message=&quot;Loading Playbook File.&quot;</span><br><span class="line">log_channel=Info message=&quot;Loading playbook file&quot; path=/home/will/documents/burrow/script filename=/home/will/documents/burrow/script/deploy.yaml</span><br><span class="line">log_channel=Info message=&quot;*****Executing Job*****&quot; JobName=defaultAddr Type=Account</span><br><span class="line">log_channel=Info message=&quot;Setting Account&quot; account=DCF0F3BD45EA59B2D471729EC22838DF7B119012</span><br><span class="line">log_channel=Info message=&quot;*****Executing Job*****&quot; JobName=AddValidator Type=UpdateAccount</span><br><span class="line">log_channel=Info message=GovTx account=&quot;unsupported value type&quot;</span><br><span class="line">log_channel=Info message=&quot;Using mempool signing since no keyClient set, pass --keys to sign locally or elsewhere&quot;</span><br><span class="line">log_channel=Info message=&quot;Using mempool signing&quot;</span><br><span class="line">log_channel=Info message=&quot;Tx Return&quot; TransactionHash=5a1a57e975e5ead5079c12c63c473e1c04c59cf82fe9974f191faaf1d8aeb8b8 BlockHeight=18</span><br><span class="line">log_channel=Info message=&quot;Job Vars&quot; name=input value=DCF0F3BD45EA59B2D471729EC22838DF7B119012</span><br><span class="line">log_channel=Info message=&quot;Job Vars&quot; name=native value=</span><br><span class="line">log_channel=Info message=&quot;Job Vars&quot; name=power value=222222</span><br><span class="line">log_channel=Info message=&quot;Job Vars&quot; name=sequence value=</span><br><span class="line">log_channel=Info message=&quot;Job Vars&quot; name=address value=</span><br><span class="line">log_channel=Info message=&quot;Job Vars&quot; name=publicKey value=D90E05FAD677699B4FEE56B567F85D3A90438B4B627C27CED0D4C850BDC97876</span><br><span class="line">log_channel=Info message=&quot;Writing to current directory&quot; output=/home/will/documents/burrow/script/deploy.output.json</span><br><span class="line">log_channel=Info message=&quot;JOBS THAT SUCCEEEDED&quot; count=1</span><br><span class="line">log_channel=Info message=&quot;Playbook result&quot; jobNo=0 file=deploy.yaml time=230.744184ms</span><br></pre></td></tr></table></figure>

<p>注意：新创建的validator没有余额。</p>
<h3 id="启动新增加的节点"><a href="#启动新增加的节点" class="headerlink" title="启动新增加的节点"></a>启动新增加的节点</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./burrow start --config=burrow_add.toml --genesis=genesis.json --address=5ECA9967F5D363F21C4606CC971710200A64C5BC</span><br></pre></td></tr></table></figure>

<p><code>5ECA9967F5D363F21C4606CC971710200A64C5BC</code> 是被增加节点的地址(address)。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">➜  script ps aux | grep burrow</span><br><span class="line">USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">will      21409  2.1  0.8 133268 66036 pts/1    SNl  08:52   1:02 ./burrow start --config=burrow000.toml</span><br><span class="line">will      21410  1.9  0.7 133268 59212 pts/1    SNl  08:52   0:56 ./burrow start --config=burrow001.toml</span><br><span class="line">will      21411  2.0  0.8 133268 65924 pts/1    SNl  08:52   0:59 ./burrow start --config=burrow002.toml</span><br><span class="line">will      21416  2.0  0.7 133268 63416 pts/1    SNl  08:52   1:01 ./burrow start --config=burrow003.toml</span><br><span class="line">will      21505  2.2  0.7 133268 58864 pts/1    Sl+  08:55   1:01 ./burrow start --config=burrow_add.toml --genesis=genesis.json --address=DCF0F3BD45EA59B2D471729EC22838DF7B119012</span><br></pre></td></tr></table></figure>

<p>ed25519是tendermint选择的加密曲线，secp256k1是ethereum选择的加密曲线。</p>
<p>两者都可以在<code>./burrow keys list</code> 中看到账户地址和名称。在web3.getAccounts中只能够看到secp256k1曲线下生成的账户地址，metamask和remix也是如此。</p>
<p><code> burrow keys gen -n -t secp256k1 --name zhuang</code> 如果不指定 <code>-n</code> 的话，需要输入密码。 </p>
<h3 id="发送转账交易"><a href="#发送转账交易" class="headerlink" title="发送转账交易"></a>发送转账交易</h3><p>创建转账交易 deploy_sendToken.yaml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jobs:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sendTxTest1</span></span><br><span class="line">  <span class="attr">send:</span></span><br><span class="line">      <span class="attr">destination:</span> <span class="string">0DE8C14FE07FA693D3A6F65D826647D39E9A3BB0</span></span><br><span class="line">      <span class="attr">amount:</span> <span class="number">2000</span></span><br></pre></td></tr></table></figure>

<p>发起</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">➜  script ./burrow keys gen -n -t secp256k1 --name zhuang1</span><br><span class="line">0DE8C14FE07FA693D3A6F65D826647D39E9A3BB0</span><br><span class="line">➜  script ./burrow deploy --address CCC93802D38A33B636D8B2B74218021A571CF252 deploy_sendToken.yaml</span><br><span class="line">log_channel=Info message=&quot;Using chain&quot; Chain=127.0.0.1:10997 Signer=</span><br><span class="line">log_channel=Info message=&quot;Loading Playbook File.&quot;</span><br><span class="line">log_channel=Info message=&quot;Loading playbook file&quot; path=/home/will/documents/burrow/script filename=/home/will/documents/burrow/script/deploy_sendToken.yaml</span><br><span class="line">log_channel=Info message=&quot;*****Executing Job*****&quot; JobName=defaultAddr Type=Account</span><br><span class="line">log_channel=Info message=&quot;Setting Account&quot; account=CCC93802D38A33B636D8B2B74218021A571CF252</span><br><span class="line">log_channel=Info message=&quot;*****Executing Job*****&quot; JobName=sendTxTest1 Type=Send</span><br><span class="line">log_channel=Info message=&quot;Sending Transaction&quot; source=CCC93802D38A33B636D8B2B74218021A571CF252 destination=0DE8C14FE07FA693D3A6F65D826647D39E9A3BB0 amount=2000</span><br><span class="line">log_channel=Info message=SendTx send=&quot;unsupported value type&quot;</span><br><span class="line">log_channel=Info message=&quot;Using mempool signing since no keyClient set, pass --keys to sign locally or elsewhere&quot;</span><br><span class="line">log_channel=Info message=&quot;Using mempool signing&quot;</span><br><span class="line">log_channel=Info message=&quot;Tx Return&quot; TransactionHash=a0abda87ea4751beaeae04d5ac67c35114b9f068720db6e1795ec7083c4a872e BlockHeight=27</span><br><span class="line">log_channel=Info message=&quot;Writing to current directory&quot; output=/home/will/documents/burrow/script/deploy_sendToken.output.json</span><br><span class="line">log_channel=Info message=&quot;JOBS THAT SUCCEEEDED&quot; count=1</span><br><span class="line">log_channel=Info message=&quot;Playbook result&quot; jobNo=0 file=deploy_sendToken.yaml time=347.234362ms</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Weiming Zhuang</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="/js/local-search.js"></script>






  




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>




</body>
</html>
