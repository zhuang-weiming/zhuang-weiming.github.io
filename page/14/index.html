<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zhuang-weiming.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.3.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta property="og:type" content="website">
<meta property="og:title" content="Zhuang&#39;s Diary">
<meta property="og:url" content="https://zhuang-weiming.github.io/page/14/index.html">
<meta property="og:site_name" content="Zhuang&#39;s Diary">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Weiming Zhuang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://zhuang-weiming.github.io/page/14/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>
<title>Zhuang's Diary</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Zhuang's Diary</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">言之有物，持之以恒</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Weiming Zhuang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">268</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/zhuangweiming/" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;zhuangweiming&#x2F;" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i>Linkedin</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2022/12/26/DID-veramo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/12/26/DID-veramo/" class="post-title-link" itemprop="url">DID-veramo</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-12-26 16:22:00" itemprop="dateCreated datePublished" datetime="2022-12-26T16:22:00+08:00">2022-12-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2023-01-15 21:45:21" itemprop="dateModified" datetime="2023-01-15T21:45:21+08:00">2023-01-15</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Veramo 中的功能是通过插件系统添加到代理中的。</p>
<h3 id="Plugins-Architecture"><a href="#Plugins-Architecture" class="headerlink" title="Plugins Architecture"></a><a target="_blank" rel="noopener" href="https://veramo.io/docs/veramo_agent/plugins">Plugins Architecture</a></h3><p><img src="/2022/12/26/DID-veramo/1.jpeg"></p>
<h3 id="DID-Methods"><a href="#DID-Methods" class="headerlink" title="DID Methods"></a>DID Methods</h3><p><img src="/2022/12/26/DID-veramo/2.jpeg" alt="DIDs and DID documents are recorded on a Verifiable Data Registry; DIDs resolve   to DID documents; DIDs refer to DID subjects; a DID controller controls a DID document; DID URLs contains a DID; DID URLs dereferenced to DID document fragments or external resources; DID resolver implements resolve function; DID URL dereferencer implements dereferencing function; DID method operates a   Verfiable Data Registry; DID resolver and DID URL dereferencer instruct a DID method."></p>
<h3 id="Core-Supported-DID-Methods"><a href="#Core-Supported-DID-Methods" class="headerlink" title="Core Supported DID Methods"></a>Core Supported DID Methods</h3><p>Veramo 核心插件支持以下 did 方法。</p>
<h3 id="did-ethr"><a href="#did-ethr" class="headerlink" title="did:ethr"></a><code>did:ethr</code></h3><p><code>did:ethr:0xc530503a148babcaca68565cfa576d6f43427a2d</code></p>
<p>Ethr-DID 为以太坊地址提供了一种可扩展的身份识别方法，使任何以太坊地址都能够收集链上和链下数据。因为 Ethr-DID 允许任何以太坊密钥对成为身份，所以它比基于智能合约的身份方法更具可扩展性和隐私保护性。</p>
<p>这种特殊的 DID 方法依赖于 ethr-did-registry。 ethr-did-registry 是一个智能合约，可以促进链下（和链上）身份验证的公钥解析。 它还有助于密钥轮换、委托分配和撤销以允许第 3 方签名者，以及设置和撤销链下属性数据。 这些交互和事件被聚合使用以使用 ethr-did-resolver 构建 DID 文档。</p>
<h3 id="did-web"><a href="#did-web" class="headerlink" title="did:web"></a><code>did:web</code></h3><p><code>did:web:veramo-agent.herokuapp.com</code></p>
<p>Web-DID 利用域名系统，允许 Web 来源的所有者将其转换为 DID。创建 Web-DID 就像创建 DID 文档并将其托管在众所周知的 URL 下一样简单。 每次解析 DID 时，DID 文档都必须通过 HTTPS GET 可用。 这意味着创建一个 DID，不需要区块链，但它有一定的权衡。 Web-DID 的安全性通过实施 TLS 植根于现有的互联网 PKI。 Web-DID 可以直接托管在网络域的众所周知的 URL 下，例如 <a target="_blank" rel="noopener" href="http://www.example.com/.well-known/did.json%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%89%98%E7%AE%A1%E5%9C%A8%E7%89%B9%E5%AE%9A%E7%9A%84%E5%AD%90%E8%B7%AF%E5%BE%84%E4%B8%8B%E3%80%82%E4%BD%BF%E7%94%A8%E5%AD%90%E8%B7%AF%E5%BE%84%E5%85%81%E8%AE%B8%E5%9C%A8%E4%B8%80%E4%B8%AA%E7%BD%91%E7%BB%9C%E5%9F%9F%E4%B8%8B%E6%89%98%E7%AE%A1%E5%A4%9A%E4%B8%AA">www.example.com/.well-known/did.json，也可以托管在特定的子路径下。使用子路径允许在一个网络域下托管多个</a> DID。此方法还可用于允许 Web 应用程序为其用户创建 Web-DID，例如 <a target="_blank" rel="noopener" href="http://www.example.com/users/username/.well-known/did.json%E3%80%82">www.example.com/users/username/.well-known/did.json。</a></p>
<p>虽然 Web-DID 是一种非常有用的技术，可以将 Web2 连接到 Web3，并且特别允许公司非常轻松地创建他们的 DID，但它在安全和隐私方面存在一些缺点（例如，跟踪）。</p>
<h3 id="did-key"><a href="#did-key" class="headerlink" title="did:key"></a><code>did:key</code></h3><p>did: key:z6MkpTHR8VNsBxYAAWHut2Geadd9jSwuBV8xRoAnwWsdvktH</p>
<p>Key-DID 代表了一种非常轻量级的自我证明 DID 方法，它不需要任何外部实用程序，例如区块链。Key-DID 是通过生成加密密钥对（例如，Curve25519）创建的。使用 Curve25519 将自动向 DID 文档添加两个条目，可用于 EdDSA（即 Ed25519）和 ECDH/加密（即，使用 X25519）。Key-DID 始终解析为相同的 DID 文档，并且由于它是不可变的，所以添加服务端点和其他密钥是不可能的。</p>
<h3 id="Message-Handlers"><a href="#Message-Handlers" class="headerlink" title="Message Handlers"></a>Message Handlers</h3><p>创建代理实例时，您指定要使用的消息处理程序以及调用它们的顺序。例如，如果您的应用程序从 QR 码捕获可验证凭证，其中数据被编码为 JWT，您将在代理设置中按顺序指定 <strong>url</strong>、<strong>did-comm</strong>、<strong>did-jwt</strong> 和 <strong>credential-w3c</strong> 处理程序。</p>
<h3 id="url"><a href="#url" class="headerlink" title="url"></a><code>url</code></h3><p>UrlMessageHandler 解析来自 URL 的消息，通常来自查询字符串。进一步的解析可能在 JWT 和/或 DIDComm 处理程序中执行。该处理程序支持获取缩短的 URL 重定向。</p>
<h3 id="did-comm"><a href="#did-comm" class="headerlink" title="did-comm"></a><code>did-comm</code></h3><p>DIDCommMessageHandler 使用收件人的私钥解密传入的消息。 解密的消息将传递给后续的消息处理程序。</p>
<p><img src="/2022/12/26/DID-veramo/3.jpeg"></p>
<h3 id="did-jwt"><a href="#did-jwt" class="headerlink" title="did-jwt"></a><code>did-jwt</code></h3><p>JWT MessageHandler 解码 JWT 并创建消息对象。</p>
<p><img src="/2022/12/26/DID-veramo/4.jpeg"></p>
<h3 id="credential-w3c"><a href="#credential-w3c" class="headerlink" title="credential-w3c"></a><code>credential-w3c</code></h3><p>W3CMessageHandler 检查可验证凭证和可验证演示的消息有效负载，并相应地格式化消息对象。</p>
<p><img src="/2022/12/26/DID-veramo/5.jpeg"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2022/12/26/DID-VC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/12/26/DID-VC/" class="post-title-link" itemprop="url">DID-VC</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-12-26 11:24:00" itemprop="dateCreated datePublished" datetime="2022-12-26T11:24:00+08:00">2022-12-26</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-12-27 09:27:44" itemprop="dateModified" datetime="2022-12-27T09:27:44+08:00">2022-12-27</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Verifiable-Credential"><a href="#Verifiable-Credential" class="headerlink" title="Verifiable Credential"></a>Verifiable Credential</h3><p>可验证数据只是使用加密算法进行数字签名的数据。Verifiable Credential 可验证凭证，可以代表物理凭证所代表的所有相同信息。</p>
<p>它具有<strong>发行者</strong>、<strong>主题</strong>、<strong>证明</strong>和<strong>可验证数据</strong>等属性。</p>
<p><a target="_blank" rel="noopener" href="https://www.w3.org/TR/vc-data-model/#example-a-simple-example-of-a-verifiable-credential">目前W3C的示例</a>：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;@context&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;https://www.w3.org/2018/credentials/v1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://www.w3.org/2018/credentials/examples/v1&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;http://example.edu/credentials/1872&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;type&quot;</span>: [<span class="string">&quot;VerifiableCredential&quot;</span>, <span class="string">&quot;AlumniCredential&quot;</span>],</span><br><span class="line">  <span class="attr">&quot;issuer&quot;</span>: <span class="string">&quot;https://example.edu/issuers/565049&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;issuanceDate&quot;</span>: <span class="string">&quot;2010-01-01T19:23:24Z&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;credentialSubject&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;did:example:ebfeb1f712ebc6f1c276e12ec21&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;alumniOf&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;did:example:c276e12ec21ebfeb1f712ebc6f1&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: [&#123;</span><br><span class="line">        <span class="attr">&quot;value&quot;</span>: <span class="string">&quot;Example University&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;lang&quot;</span>: <span class="string">&quot;en&quot;</span></span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        <span class="attr">&quot;value&quot;</span>: <span class="string">&quot;Exemple d&#x27;Université&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;lang&quot;</span>: <span class="string">&quot;fr&quot;</span></span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;proof&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;RsaSignature2018&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;created&quot;</span>: <span class="string">&quot;2017-06-18T21:19:10Z&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;proofPurpose&quot;</span>: <span class="string">&quot;assertionMethod&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;verificationMethod&quot;</span>: <span class="string">&quot;https://example.edu/issuers/565049#key-1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;jws&quot;</span>: <span class="string">&quot;eyJhbGciOiJSUzI1NiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..TCYt5X</span></span><br><span class="line"><span class="string">      sITJX1CxPCT8yAV-TVkIEq_PbChOMqsLfRoPsnsgw5WEuts01mq-pQy7UJiN5mgRxD-WUc</span></span><br><span class="line"><span class="string">      X16dUEMGlv50aqzpqh4Qktb3rk-BuQy72IFLOqV0G_zS245-kronKb78cPN25DGlcTwLtj</span></span><br><span class="line"><span class="string">      PAYuNzVBAh4vGHSrQyHUdBBPM&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Decentralized-Identifier"><a href="#Decentralized-Identifier" class="headerlink" title="Decentralized Identifier"></a>Decentralized Identifier</h3><p>DID 的风格或更准确地说是 DID 方法定义了如何执行该 DID 方法的 DID 的 CRUD 操作。 每个 DID 方法在特定用例中都有不同的权衡。 例如，可以在没有区块链的情况下创建 Web DID，但存在依赖于区块链的 DID 方法。 它们都是有效的 DID，但有不同的保证。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://veramo.dev/.well-known/did.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;@context&quot;</span>: <span class="string">&quot;https://w3id.org/did/v1&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;did:web:veramo.dev&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;publicKey&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;did:web:veramo.dev#0405aa19bb98a5fd29c15a730cb5064ca128dea19247b896b1a7bdad0b4bccccda9b47366cd1359e740d938e5a47d7bed0501150e8a1623805ac47c489421b1506&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Secp256k1VerificationKey2018&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;controller&quot;</span>: <span class="string">&quot;did:web:veramo.dev&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;publicKeyHex&quot;</span>: <span class="string">&quot;0405aa19bb98a5fd29c15a730cb5064ca128dea19247b896b1a7bdad0b4bccccda9b47366cd1359e740d938e5a47d7bed0501150e8a1623805ac47c489421b1506&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;authentication&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Secp256k1SignatureAuthentication2018&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;publicKey&quot;</span>: <span class="string">&quot;did:web:veramo.dev#0405aa19bb98a5fd29c15a730cb5064ca128dea19247b896b1a7bdad0b4bccccda9b47366cd1359e740d938e5a47d7bed0501150e8a1623805ac47c489421b1506&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;service&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;did:web:veramo.dev#msg&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Messaging&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;serviceEndpoint&quot;</span>: <span class="string">&quot;https://veramo.dev/messaging&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Handles incoming POST messages&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>








      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2022/11/25/FMR-%E5%B8%82%E5%9C%BA%E9%A3%8E%E9%99%A9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/25/FMR-%E5%B8%82%E5%9C%BA%E9%A3%8E%E9%99%A9/" class="post-title-link" itemprop="url">FMR-市场风险</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-11-25 15:21:00" itemprop="dateCreated datePublished" datetime="2022-11-25T15:21:00+08:00">2022-11-25</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2024-02-27 11:29:22" itemprop="dateModified" datetime="2024-02-27T11:29:22+08:00">2024-02-27</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>按照风险的驱动因素，金融风险可以分为市场风险market risk，信用风险credit risk，操作风险operational risk，流动性风险liquidity risk。</p>
<p>最常见的市场风险包括利率风险，汇率风险，通货膨胀风险，证券价格风险，波动率风险等。</p>
<p>市场风险分析方法：</p>
<ol>
<li><p>缺口分析法 gap analysis，即资产负债缺口分析法。当利率发生变化时，资产和负债之间产生“缺口”，通过比较缺口的大小，可以得到利率变化时市场价值变动的程度，亦即产生的<strong>利率风险</strong>的大小。GAP（缺口）= RSA（利率敏感性资产）- RSL（利率敏感性负债）</p>
</li>
<li><p>久期分析法 duration analysis，即持续期分析法或者期限弹性分析法。其通过对各时间段段缺口赋予相应权重，得到加权缺口，然后对这些加权缺口求和，以此估算<strong>利率</strong>变动对市场价值的影响。</p>
</li>
</ol>
<p>相对于缺口分析只是考虑净收入的变化，久期分析则考察资产或者负债的价值，是一种更为准确的利率风险计量方法。</p>
<ol start="3">
<li>场景分析法 scenario analysis，又称假设分析法 what-if analysis。通过设定不同的情景，分析在每一种情景下的收益或者亏损，从而对<strong>整个投资组合的未来风险情况进行评估</strong>，做出最佳决策。</li>
<li>投资组合理论 portfolio theory，是一种衡量<strong>市场风险</strong>的方法。</li>
<li>希腊字母估计市场风险。</li>
</ol>
<table>
<thead>
<tr>
<th>希腊字母</th>
<th>符号</th>
<th>风险评估</th>
</tr>
</thead>
<tbody><tr>
<td>Delta</td>
<td>Δ</td>
<td>标的资产价格变化引起金融衍生品价格变化</td>
</tr>
<tr>
<td>Gamma</td>
<td>Γ</td>
<td>标的资产价格变化引起Delta变化</td>
</tr>
<tr>
<td>Theta</td>
<td>Θ</td>
<td>时间引起衍生品价格变化</td>
</tr>
<tr>
<td>Vega</td>
<td>Λ</td>
<td>市场波动率变化引起金融衍生品价格变化</td>
</tr>
<tr>
<td>Rho</td>
<td>ρ</td>
<td>利率变化引起金融衍生品价格变化</td>
</tr>
</tbody></table>
<ol start="6">
<li><p>风险价值 Value at Risk - VaR，也叫在险价值。作为经典的市场风险度量，可以用来评估资产的风险，帮助金融机构合理分散或者规避风险。摩根大通J.P.Morgan Chase开源了RiskMetrics系统，很快被金融机构采用，<strong>广泛地用来计算包括市场风险、信用风险以及操作风险等在内的金融风险</strong>。</p>
<p>6.1 参数法计算风险价值 parametric approach，一般假设未来收益满足正态分布，这是因为如股票收益率等风险因子一般都可以用正态分布近似，而资产组合通常也可以用风险因子等线性组合来表示，并且正态分布的任意线性组合仍然为正态分布，因此资产祝贺的预期收益分布仍然为正态分布。</p>
<p>在市场上，价格低标准差通常变化较大，价格本身对于标准差来说，变化并不大。所以，<strong>参数法的关键是要计算出分布的标准差σ</strong>，正因为如此，参数法又时也被称为方差协方差方法。该原理容易理解，计算量也较小。</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> pandas_datareader</span><br><span class="line"><span class="keyword">import</span> scipy.stats <span class="keyword">as</span> stats</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits <span class="keyword">import</span> mplot3d</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> cm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设投资组合包含以下公司</span></span><br><span class="line">tickers = [<span class="string">&#x27;GOOGL&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;AAPL&#x27;</span>,<span class="string">&#x27;NFLX&#x27;</span>,<span class="string">&#x27;AMZN&#x27;</span>]</span><br><span class="line">ticker_num = <span class="built_in">len</span>(tickers)</span><br><span class="line">price_data = []</span><br><span class="line"><span class="keyword">for</span> ticker <span class="keyword">in</span> <span class="built_in">range</span>(ticker_num):</span><br><span class="line">    <span class="comment"># 获取股票的历史数据</span></span><br><span class="line">    prices = pandas_datareader.DataReader(tickers[ticker], start=<span class="string">&#x27;2015-11-30&#x27;</span>, end = <span class="string">&#x27;2020-11-30&#x27;</span>, data_source=<span class="string">&#x27;yahoo&#x27;</span>)   </span><br><span class="line">    price_data.append(prices[[<span class="string">&#x27;Adj Close&#x27;</span>]])</span><br><span class="line">    df_stocks = pd.concat(price_data, axis=<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># stock log returns计算“日对数回报率”</span></span><br><span class="line">logreturns = np.log(df_stocks/df_stocks.shift(<span class="number">1</span>))[<span class="number">1</span>:]  </span><br><span class="line">logreturns.columns = tickers </span><br><span class="line">logreturns.head() </span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设它们的对数回报率满足正态分布，下面代码计算并展示股票的回报率分布</span></span><br><span class="line"><span class="comment"># plot log return distribution for GOOGL</span></span><br><span class="line">plt.style.use(<span class="string">&#x27;ggplot&#x27;</span>)</span><br><span class="line">mu, std = stats.norm.fit(logreturns[<span class="string">&#x27;GOOGL&#x27;</span>])</span><br><span class="line">x = np.linspace(mu<span class="number">-5</span>*std, mu+<span class="number">5</span>*std, <span class="number">500</span>)</span><br><span class="line">logreturns[<span class="string">&#x27;GOOGL&#x27;</span>].hist(bins=<span class="number">60</span>, density=<span class="literal">True</span>, histtype=<span class="string">&quot;stepfilled&quot;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">x = np.linspace(mu - <span class="number">3</span>*std, mu+<span class="number">3</span>*std, <span class="number">500</span>)</span><br><span class="line">plt.plot(x, stats.norm.pdf(x, mu, std))</span><br><span class="line">plt.title(<span class="string">&quot;Log return distribution for GOOGL&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Return&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Density&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot log return distribution</span></span><br><span class="line">rows = <span class="number">2</span></span><br><span class="line">cols = <span class="number">2</span></span><br><span class="line">fig, axs = plt.subplots(rows, cols, figsize=(<span class="number">12</span>,<span class="number">6</span>))</span><br><span class="line">ticker_n = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rows):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(cols):</span><br><span class="line">        mu, std = stats.norm.fit(logreturns[tickers[ticker_n]])</span><br><span class="line">        x = np.linspace(mu<span class="number">-5</span>*std, mu+<span class="number">5</span>*std, <span class="number">500</span>)</span><br><span class="line">        axs[i,j].hist(logreturns[tickers[ticker_n]], bins=<span class="number">60</span>, density=<span class="literal">True</span>, histtype=<span class="string">&quot;stepfilled&quot;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">        axs[i,j].plot(x, stats.norm.pdf(x, mu, std))</span><br><span class="line">        axs[i,j].set_title(<span class="string">&quot;Log return distribution for &quot;</span>+tickers[ticker_n])</span><br><span class="line">        axs[i,j].set_xlabel(<span class="string">&quot;Return&quot;</span>)</span><br><span class="line">        axs[i,j].set_ylabel(<span class="string">&quot;Density&quot;</span>)</span><br><span class="line">        ticker_n = ticker_n + <span class="number">1</span></span><br><span class="line">plt.tight_layout()</span><br></pre></td></tr></table></figure>

<p>​    6.2 历史法计算风险价值 historical approach，这是一种全值估计方法 full revaluation，具体是指利用风险因子的历史数据，计算过去某段时期收益的频度分布，并以此来模拟风险因子的未来收益分布，然后根据置信水平，确定相应的最大可能损失。</p>
<p>​    6.3 蒙特卡洛法计算风险价值 Monte Carlo simulation，这也是风险价值计算中最常应用的模型之一。首先通过分析历史数据建立风险因子的随机过程模型，然后反复模拟风险因子变量的随机过程，每一次模拟都可以得到风险因子的一个未来变化的情景，以及投资组合在持有期期末的一个可能价值。通过大量的模拟，投资组合价值的模拟分布将最终收敛于该组合的真实分布，根据该分布，可以计算风险价值。</p>
<p><img src="/2022/11/25/FMR-%E5%B8%82%E5%9C%BA%E9%A3%8E%E9%99%A9/1.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> pandas_datareader</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设投资组合包含以下公司</span></span><br><span class="line">tickers = [<span class="string">&#x27;GOOGL&#x27;</span>,<span class="string">&#x27;FB&#x27;</span>,<span class="string">&#x27;AAPL&#x27;</span>,<span class="string">&#x27;NFLX&#x27;</span>,<span class="string">&#x27;AMZN&#x27;</span>]</span><br><span class="line">ticker_num = <span class="built_in">len</span>(tickers)</span><br><span class="line">price_data = []</span><br><span class="line"><span class="keyword">for</span> ticker <span class="keyword">in</span> <span class="built_in">range</span>(ticker_num):   </span><br><span class="line">    prices = pandas_datareader.DataReader(tickers[ticker], start=<span class="string">&#x27;2015-11-30&#x27;</span>, end = <span class="string">&#x27;2020-11-30&#x27;</span>, data_source=<span class="string">&#x27;yahoo&#x27;</span>)   </span><br><span class="line">    price_data.append(prices[[<span class="string">&#x27;Adj Close&#x27;</span>]])</span><br><span class="line">    df_stocks = pd.concat(price_data, axis=<span class="number">1</span>)</span><br><span class="line">df_stocks.columns = tickers</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后计算股票的累积回报率</span></span><br><span class="line"><span class="comment"># cumulative returns</span></span><br><span class="line">stock_return = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ticker_num):  </span><br><span class="line">    return_tmp = np.log(df_stocks[[tickers[i]]]/df_stocks[[tickers[i]]].shift(<span class="number">1</span>))[<span class="number">1</span>:]  </span><br><span class="line">    return_tmp = (return_tmp+<span class="number">1</span>).cumprod()</span><br><span class="line">    stock_return.append(return_tmp[[tickers[i]]])</span><br><span class="line">    return_all = pd.concat(stock_return,axis=<span class="number">1</span>)</span><br><span class="line">return_all.head()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用曲线更直观地展示所有股票的回报率</span></span><br><span class="line"><span class="comment"># plot cumulative returns of all stocks</span></span><br><span class="line">plt.style.use(<span class="string">&#x27;ggplot&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i, col <span class="keyword">in</span> <span class="built_in">enumerate</span>(return_all.columns):</span><br><span class="line">    return_all[col].plot()</span><br><span class="line">plt.title(<span class="string">&#x27;Cumulative returns&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Date&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Return&#x27;</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">30</span>)</span><br><span class="line">plt.legend(return_all.columns)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定投资组合中各个股票的比重，并且在持有期内保持不变。进而计算得到整个投资组合的预期回报和股价</span></span><br><span class="line"><span class="comment"># lastest return and price values</span></span><br><span class="line">latest_return = return_all.iloc[<span class="number">-1</span>,:]</span><br><span class="line">latest_price = df_stocks.iloc[<span class="number">-1</span>,:]</span><br><span class="line">sigma = latest_return.std()</span><br><span class="line"><span class="comment"># weights for stocks in the portfolio</span></span><br><span class="line">stock_weight = [<span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.1</span>, <span class="number">0.15</span>, <span class="number">0.25</span>] </span><br><span class="line"><span class="comment"># calculate expected return</span></span><br><span class="line">expected_return = latest_return.dot(stock_weight)</span><br><span class="line">print(<span class="string">&#x27;The weighted expected portfolio return: %.2f&#x27;</span> % expected_return)</span><br><span class="line"><span class="comment"># calculate weighted price</span></span><br><span class="line">price = latest_price.dot(stock_weight)</span><br><span class="line">print(<span class="string">&#x27;The weighted price of the portfolio: %.0f&#x27;</span> % price)</span><br><span class="line"></span><br><span class="line"><span class="comment">#假设该投资组合的回报率符合正态分布，以一天中的每一分钟作为步长，即分为1440个节点，利用蒙特卡洛模拟随机产生500个回报率数值。</span></span><br><span class="line"><span class="comment"># monte carlo simulation</span></span><br><span class="line">MC_num = <span class="number">500</span></span><br><span class="line">confidence_level = <span class="number">0.95</span></span><br><span class="line">time_step = <span class="number">1440</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(MC_num):  </span><br><span class="line">  daily_returns = np.random.normal(expected_return/time_step, sigma/np.sqrt(time_step), time_step)</span><br><span class="line">  plt.plot(daily_returns)</span><br><span class="line">plt.axhline(np.percentile(daily_returns,(<span class="number">1.0</span>-confidence_level)*<span class="number">100</span>), color=<span class="string">&#x27;r&#x27;</span>, linestyle=<span class="string">&#x27;dashed&#x27;</span>)</span><br><span class="line">plt.axhline(np.percentile(daily_returns,confidence_level*<span class="number">100</span>), color=<span class="string">&#x27;g&#x27;</span>, linestyle=<span class="string">&#x27;dashed&#x27;</span>)</span><br><span class="line">plt.axhline(np.mean(daily_returns), color=<span class="string">&#x27;b&#x27;</span>, linestyle=<span class="string">&#x27;solid&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Time&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Return&#x27;</span>)</span><br><span class="line"><span class="comment"># 可视化，红线处为风险价值</span></span><br><span class="line"><span class="comment"># plot return distribution</span></span><br><span class="line">sns.distplot(daily_returns, kde=<span class="literal">True</span>, color=<span class="string">&#x27;lightblue&#x27;</span>)</span><br><span class="line">plt.axvline(np.percentile(daily_returns,(<span class="number">1.0</span>-confidence_level)*<span class="number">100</span>), color=<span class="string">&#x27;red&#x27;</span>, linestyle=<span class="string">&#x27;dashed&#x27;</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">plt.title(<span class="string">&quot;Return distribution&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Return&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Frequency&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设初始投资金额为100万美元，得到VaR值为 33185</span></span><br><span class="line">initial_investment  = <span class="number">1000000</span></span><br><span class="line">VaR = initial_investment*np.percentile(daily_returns,(<span class="number">1.0</span>-confidence_level)*<span class="number">100</span>)</span><br><span class="line">print(<span class="string">&#x27;The value at risk is %.0f&#x27;</span> % VaR)</span><br></pre></td></tr></table></figure>

<p>若为了获得更多的场景，更多的模拟，这里的计算量会迅速上升，从而导致整体的运算速度较慢。</p>
<p>关联阅读 - <a target="_blank" rel="noopener" href="https://willzhuang.github.io/2022/11/21/FMR-%E6%B3%A2%E5%8A%A8%E7%8E%87/">FMR-波动率</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2022/11/21/FMR-%E6%B3%A2%E5%8A%A8%E7%8E%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/11/21/FMR-%E6%B3%A2%E5%8A%A8%E7%8E%87/" class="post-title-link" itemprop="url">FMR-波动率</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-11-21 15:21:00" itemprop="dateCreated datePublished" datetime="2022-11-21T15:21:00+08:00">2022-11-21</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2023-09-14 13:54:23" itemprop="dateModified" datetime="2023-09-14T13:54:23+08:00">2023-09-14</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>金融资产价格包括股票，期货，期权，目前本人在思考加密货币的价格是否可以套用经典的金融风险模型，学习笔记汇报如下，<u>由于比较书写数学公式不便，本文只记录了关键说明和程序代码</u>。</p>
<h3 id="1-EWMA"><a href="#1-EWMA" class="headerlink" title="1. EWMA"></a>1. EWMA</h3><p>指数移动加权平均 - Exponentially  Weighted Moving Average, EWMA.</p>
<p>EWMA波动率迭代告诉我们，当前一天的波动率是前一天波动率的函数，这也提供了一种用过去波动率预测未来波动率的方法。这种方法，不需要保存过去所有的数值，而且计算量较小，因此在实际中广泛使用。</p>
<p>The ewm() function is used to provide exponential weighted functions. 指数加权功能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># Creating the series. Using the range() function, we create a series and set the index to shot.</span></span><br><span class="line">my_series=pd.Series(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>,<span class="number">5</span>), index=[x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;shot&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Printing the series</span></span><br><span class="line">print(my_series)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Using Series.ewm(). We calculate the exponential weight of elements in the series using the ewm() function and set the com and adjust parameters.</span></span><br><span class="line">print(my_series.ewm(com=<span class="number">0.5</span>, adjust=<span class="literal">True</span>).mean())</span><br></pre></td></tr></table></figure>

<p>其中，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Series.ewm(self, com=<span class="literal">None</span>, span=<span class="literal">None</span>, halflife=<span class="literal">None</span>, alpha=<span class="literal">None</span>, min_periods=<span class="number">0</span>, adjust=<span class="literal">True</span>, ignore_na=<span class="literal">False</span>, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong><code>com</code></strong>: This represents the decay in terms of the center of mass, α=1/(1+com), for com≥0. 根据Center of Mass质心指定衰减。</p>
</li>
<li><p><strong><code>span</code></strong>: This represents the decay in terms of the span, α=2/(span+1), for span≥1. 根据跨度范围（例如，天数）指定衰减。</p>
</li>
<li><p><strong><code>halflife</code></strong>: This represents the decay in terms of the half-life, α=1−exp(log(0.5)/halflife), for halflife&gt;0. 根据半衰期指定衰减。</p>
</li>
<li><p><strong><code>alpha</code></strong>: This indicates smoothing factor α, 0&lt;α≤1. 衰减系数。</p>
</li>
<li><p><strong><code>min_periods</code></strong>: This represents the minimum number of observations needed to have a value in the window. The default value is <code>0</code>. </p>
</li>
<li><p><strong><code>adjust</code></strong>: This is divided by the decaying adjustment factor into the initial periods to consider the imbalance in the relative weightings (looking at the EWMA as a moving average). 计算权重的方式。</p>
</li>
<li><p><strong><code>ignore_na</code></strong>: This specifies that the missing values should be ignored when calculating weights. The default is <code>False</code>. 如何对待空值。</p>
</li>
<li><p><strong><code>axis</code></strong>: The default value is 0. It specifies the axis on which the function is to be performed. If the value is 0, the operation is performed across the rows. Otherwise, the operation is performed across the columns. 数轴。</p>
</li>
</ul>
<h3 id="2-自回归条件异方差模型ARCH"><a href="#2-自回归条件异方差模型ARCH" class="headerlink" title="2. 自回归条件异方差模型ARCH"></a>2. 自回归条件异方差模型ARCH</h3><p>EWMA与实际情况有不符合的地方，例如，股票收益的波动率是随着时间而变化的。异方差（heteroscedasticity）是指一系列的随机变量值的方差不同。这个模型以自回归方式，通过刻画随时间变异的条件方差，成功解决了时间序列的波动性问题。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas_datareader</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> arch <span class="keyword">import</span> arch_model</span><br><span class="line"><span class="comment"># sp500 price</span></span><br><span class="line">sp500 = pandas_datareader.data.DataReader([<span class="string">&#x27;sp500&#x27;</span>], data_source=<span class="string">&#x27;fred&#x27;</span>, start=<span class="string">&#x27;12-28-2009&#x27;</span>, end=<span class="string">&#x27;12-28-2020&#x27;</span>)</span><br><span class="line"><span class="comment"># daily log return</span></span><br><span class="line">log_return_daily = np.log(sp500 / sp500.shift(<span class="number">1</span>))</span><br><span class="line">log_return_daily.dropna(inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># ARCH(1) model</span></span><br><span class="line">arch=arch_model(y=log_return_daily,mean=<span class="string">&#x27;Constant&#x27;</span>,lags=<span class="number">0</span>,vol=<span class="string">&#x27;ARCH&#x27;</span>,p=<span class="number">1</span>,o=<span class="number">0</span>,q=<span class="number">0</span>,dist=<span class="string">&#x27;normal&#x27;</span>)</span><br><span class="line">archmodel=arch.fit()</span><br><span class="line">archmodel.summary()</span><br><span class="line">archmodel.plot()</span><br></pre></td></tr></table></figure>



<h3 id="3-广义自回归条件异方差模型GARCH"><a href="#3-广义自回归条件异方差模型GARCH" class="headerlink" title="3. 广义自回归条件异方差模型GARCH"></a>3. 广义自回归条件异方差模型GARCH</h3><p>GARCH是对ARCH建模的一种重要推广。其后，又有诸如NGARCH，IGARCH，EGARCH等一系列针对不同应用等衍生模型相继出现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GARCH(1,1) model</span></span><br><span class="line">garch=arch_model(y=log_return_daily,mean=<span class="string">&#x27;Constant&#x27;</span>,lags=<span class="number">0</span>,vol=<span class="string">&#x27;GARCH&#x27;</span>,p=<span class="number">1</span>,o=<span class="number">0</span>,q=<span class="number">1</span>,dist=<span class="string">&#x27;normal&#x27;</span>)</span><br><span class="line">garchmodel=garch.fit()</span><br><span class="line">garchmodel.summary()</span><br><span class="line">garchmodel.plot()</span><br></pre></td></tr></table></figure>



<h3 id="4-模型比较"><a href="#4-模型比较" class="headerlink" title="4.模型比较"></a>4.模型比较</h3><p>对于EWMA模型，利用了通常用的0.94，即 JP Morgan 的RiskMetrics采用的设定。所以，下图中，EWMA中的 λ 通常为 0.94。当GARCH(1, 1)模型的参数 β=0 时，即为ARCH(1, 1)模型。而当 ω=0，α=1-λ，β=λ 时，GARCH(1, 1)模型变换成为EWMA模型。</p>
<p><img src="/2022/11/21/FMR-%E6%B3%A2%E5%8A%A8%E7%8E%87/1.png"></p>
<h3 id="5-隐含波动率"><a href="#5-隐含波动率" class="headerlink" title="5.隐含波动率"></a>5.隐含波动率</h3><p>请参考相关阅读中的金融分享管理 - 视频 <a target="_blank" rel="noopener" href="https://space.bilibili.com/513194466/channel/seriesdetail?sid=650176%E3%80%82">https://space.bilibili.com/513194466/channel/seriesdetail?sid=650176。</a></p>
<p><strong>疑问：市场波动率模型以布朗运动位基础，这真的符合市场的实际情况吗？特别是长期投资？如乔布斯，国家资本主义，等等。</strong></p>
<p>相关阅读：</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2022/10/27/AIGC-%E7%BB%98%E7%94%BB%E5%88%9D%E4%BD%93%E9%AA%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/10/27/AIGC-%E7%BB%98%E7%94%BB%E5%88%9D%E4%BD%93%E9%AA%8C/" class="post-title-link" itemprop="url">AIGC-绘画初体验</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-10-27 11:48:00" itemprop="dateCreated datePublished" datetime="2022-10-27T11:48:00+08:00">2022-10-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2023-09-05 15:29:58" itemprop="dateModified" datetime="2023-09-05T15:29:58+08:00">2023-09-05</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>AI-Generated Content，字面意思是AI生产内容。AI写诗、AI作曲、AI绘画、AI换脸……甚至有创始人认为，游戏中导入图片生成模型的“捏脸系统”都是AIGC。</p>
<p><a target="_blank" rel="noopener" href="https://jina.ai/product/disco-art/">https://jina.ai/product/disco-art/</a> 是较为直接的一个体验。</p>
<p>下图为其主页的静态展示：</p>
<p><img src="/2022/10/27/AIGC-%E7%BB%98%E7%94%BB%E5%88%9D%E4%BD%93%E9%AA%8C/1.png"></p>
<h3 id="在线体验"><a href="#在线体验" class="headerlink" title="在线体验"></a>在线体验</h3><p><a target="_blank" rel="noopener" href="https://colab.research.google.com/github/jina-ai/discoart/blob/main/discoart.ipynb">https://colab.research.google.com/github/jina-ai/discoart/blob/main/discoart.ipynb</a></p>
<ol>
<li>按照python notebook的步骤，逐步启动。</li>
<li>Specify parameters，在制定参数的步骤，输入描述文字，目前只支持英文，并输入初始图片。就可以开始Preview了。</li>
</ol>
<p>非常的简单哦～。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/13/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/54/">54</a><a class="extend next" rel="next" href="/page/15/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Weiming Zhuang</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>




</body>
</html>
