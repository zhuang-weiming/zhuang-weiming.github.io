<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zhuang-weiming.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.3.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta property="og:type" content="website">
<meta property="og:title" content="Zhuang&#39;s Diary">
<meta property="og:url" content="https://zhuang-weiming.github.io/index.html">
<meta property="og:site_name" content="Zhuang&#39;s Diary">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Weiming Zhuang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://zhuang-weiming.github.io/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>
<title>Zhuang's Diary</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Zhuang's Diary</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">è¨€ä¹‹æœ‰ç‰©ï¼ŒæŒä¹‹ä»¥æ’</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Weiming Zhuang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">268</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/zhuangweiming/" title="Linkedin â†’ https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;zhuangweiming&#x2F;" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i>Linkedin</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2025/02/27/cv-en-2025/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/02/27/cv-en-2025/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-02-27 09:33:08 / Modified: 10:52:12" itemprop="dateCreated datePublished" datetime="2025-02-27T09:33:08+08:00">2025-02-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="WEIMING-ZHUANG"><a href="#WEIMING-ZHUANG" class="headerlink" title="WEIMING ZHUANG"></a><strong>WEIMING ZHUANG</strong></h3><p>ğŸ“± 18642696200 Â· ğŸ“§ <a href="mailto:&#122;&#119;&#109;&#x31;&#x33;&#54;&#50;&#48;&#48;&#x40;&#x67;&#109;&#97;&#x69;&#x6c;&#46;&#x63;&#x6f;&#109;">&#122;&#119;&#109;&#x31;&#x33;&#54;&#50;&#48;&#48;&#x40;&#x67;&#109;&#97;&#x69;&#x6c;&#46;&#x63;&#x6f;&#109;</a> Â· <a href="https://zhuang-weiming.github.io/">Blog</a><br><strong>Summary</strong><br>Seasoned Fin-Tech strategist and technical leader with 15+ years of expertise in blockchain, AI, cloud, and regulatory technologies. Proven track record in driving digital transformation, vendor governance, and cross-border innovation at global institutions (HSBC, Dalian Commodity Exchange, Ant Financial). Holder of 13 patents, PMPÂ® certified, and bilingual (English/Chinese) communicator. Recognized withÂ <strong>Red Dot Award</strong>,Â <strong>HSBC Tech Excellence</strong>, andÂ <strong>Shanghai Blockchain Innovation Champion</strong>Â for pioneering solutions in decentralized identity, federated learning, and CBDCs.</p>
<hr>
<h3 id="Professional-Experience"><a href="#Professional-Experience" class="headerlink" title="Professional Experience"></a><strong>Professional Experience</strong></h3><p><strong>HSBC Lab | Lead Full Stack Engineer</strong>Â <em>(Dec 2021â€“Present)</em></p>
<ul>
<li><p>SpearheadedÂ <strong>CBDC (e-HKD)</strong>,Â <strong>Web3.0 (DID/NFT)</strong>, andÂ <strong>AI/ML</strong>Â initiatives, aligning with HSBCâ€™s global Fin-Tech roadmap. Led cross-border deployment ofÂ <strong>UI Test Robot</strong>Â (30% efficiency gain) andÂ <strong>LLM fine-tuning workflows</strong>, earningÂ <strong>2024 HSBC Tech Reward &amp; Recognition</strong>Â andÂ <strong>Red Dot Award</strong>Â for decentralized identity solutions</p>
<p>  .</p>
</li>
<li><p>Directed R&amp;D budget allocation ($2M+), vendor governance (10+ partners), and compliance frameworks for cloud/AI projects.</p>
</li>
<li><p>Co-developedÂ <strong>EasyFL</strong>, a low-code federated learning platform reducing FL application code by 10x and accelerating training by 1.5x</p>
<p>  .</p>
</li>
</ul>
<p><strong>Dalian Commodity Exchange | Lead Architect</strong>Â <em>(Jul 2020â€“Dec 2021)</em></p>
<ul>
<li><p>Architected blockchain solutions for commodity trading, achievingÂ <strong>CAICT Trusted Blockchain Certification</strong>Â and enabling $50M+ warehouse receipt financing for COFCO</p>
<p>  .</p>
</li>
<li><p>Optimized IT governance processes, reducing vendor SLA compliance gaps by 25%.</p>
</li>
</ul>
<p><strong>Shanghai Insurance Exchange | Technical Lead</strong>Â <em>(Apr 2017â€“Jun 2020)</em></p>
<ul>
<li><p>BuiltÂ <strong>SHIE Blockchain</strong>Â for reinsurance and digital policies, publishedÂ <em>Blockchain in Insurance Industry</em>Â inÂ <em>Modern Bankers</em>. Led CAICT blockchain ratings (2018, 2021) and wonÂ <strong>2018 Shanghai Blockchain Innovation Competition</strong></p>
<p>  .</p>
</li>
</ul>
<p><strong>Ant Financial | Blockchain Expert</strong>Â <em>(Jul 2016â€“Mar 2017)</em></p>
<ul>
<li>DesignedÂ <strong>Ant Chain</strong>â€™s consensus algorithm for charitable donations, presented atÂ <strong>MIIT Blockchain Conference</strong>.</li>
</ul>
<p><strong>IBM | Senior Architect/Consultant</strong>Â <em>(May 2007â€“Jul 2016)</em></p>
<ul>
<li>Delivered blockchain POCs for ICBC and Postal Savings Bank, certifiedÂ <strong>IBM IT Application Consulting Expert</strong>.</li>
</ul>
<hr>
<h3 id="Key-Innovations-amp-Leadership"><a href="#Key-Innovations-amp-Leadership" class="headerlink" title="Key Innovations &amp; Leadership"></a><strong>Key Innovations &amp; Leadership</strong></h3><ul>
<li><p><strong>Patents</strong>: 13 filed (WO/US/CN), includingÂ <em>AI Vision for Fraud Detection</em>,Â <em>Raft-Based Blockchain Consensus</em>, andÂ <em>NFT User Verification</em></p>
<p>  .</p>
</li>
<li><p><strong>Awards</strong>: Red Dot Award (DID), HSBC Tech Excellence, Shanghai Financial Reform Research Achiever (2018â€“19).</p>
</li>
<li><p><strong>Publications</strong>: AuthoredÂ <em>EasyFL: Low-Code Federated Learning Platform</em>Â (arXiv 2021)</p>
<p>  ,Â <em>When Foundation Models Meet Federated Learning</em>Â (Sony AI, 2023)</p>
<p>  , andÂ <em>Blockchain in Insurance</em>(Modern Bankers).</p>
</li>
<li><p><strong>Leadership</strong>: Mentored teams to win Red Dot Award and CAICT certifications; speaker at MIIT Blockchain Conference</p>
<p>  .</p>
</li>
</ul>
<hr>
<h3 id="Education-amp-Certifications"><a href="#Education-amp-Certifications" class="headerlink" title="Education &amp; Certifications"></a><strong>Education &amp; Certifications</strong></h3><ul>
<li><p><strong>M.Sc. &amp; B.Sc. in Electrical Engineering</strong>, Dalian Maritime University (2000â€“2007)</p>
</li>
<li><p><strong>Certifications</strong>: PMPÂ® (2010â€“2013), IREB CPRE, IBM IT Application Consulting Expert, Secure Code Warrior (Orange Belt).</p>
</li>
<li><p><strong>Honors</strong>: Dalian 2020 Urgent Talent Certification, Sony AI Research Scientist (2023â€“Present)</p>
<p>  .</p>
</li>
</ul>
<hr>
<h3 id="Technical-Skills"><a href="#Technical-Skills" class="headerlink" title="Technical Skills"></a><strong>Technical Skills</strong></h3><ul>
<li><strong>Blockchain</strong>: Hyperledger, Ant Chain, DID/NFT frameworks.</li>
<li><strong>AI/ML</strong>: Federated Learning (EasyFL), LLM fine-tuning, PyTorch, TensorFlow.</li>
<li><strong>Cloud</strong>: AWS, Azure, IBM Cloud.</li>
<li><strong>Languages</strong>: Python, Java, Solidity, JavaScript.</li>
</ul>
<hr>
<h3 id="Tailoring-Notes"><a href="#Tailoring-Notes" class="headerlink" title="Tailoring Notes"></a><strong>Tailoring Notes</strong></h3><ol>
<li><p><strong>Vendor &amp; Compliance Focus</strong>: Highlighted CAICT certifications, HSBC governance, and cross-border project leadership.</p>
</li>
<li><p><strong>AI/FL Expertise</strong>: Integrated federated learning innovations (EasyFL, Sony AI research) to align with AI-driven banking trends</p>
<p> .</p>
</li>
<li><p><strong>Global Impact</strong>: Emphasized e-HKD (Hong Kong), COFCO financing (China), and Red Dot Award (international).</p>
</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2025/02/13/SFT%E3%80%81DPO%E3%80%81GRPO%E4%B8%89%E7%A7%8D%E8%AE%AD%E7%BB%83%E5%99%A8%E7%9A%84%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE%E4%B8%8E%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/02/13/SFT%E3%80%81DPO%E3%80%81GRPO%E4%B8%89%E7%A7%8D%E8%AE%AD%E7%BB%83%E5%99%A8%E7%9A%84%E8%AE%AD%E7%BB%83%E6%95%B0%E6%8D%AE%E4%B8%8E%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/" class="post-title-link" itemprop="url">SFTã€DPOã€GRPOä¸‰ç§è®­ç»ƒå™¨çš„è®­ç»ƒæ•°æ®ä¸åº”ç”¨åœºæ™¯</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-02-13 18:22:00" itemprop="dateCreated datePublished" datetime="2025-02-13T18:22:00+08:00">2025-02-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2025-02-17 18:21:32" itemprop="dateModified" datetime="2025-02-17T18:21:32+08:00">2025-02-17</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ç»“è®ºæ€»ç»“ï¼š"><a href="#ç»“è®ºæ€»ç»“ï¼š" class="headerlink" title="ç»“è®ºæ€»ç»“ï¼š"></a>ç»“è®ºæ€»ç»“ï¼š</h2><table>
<thead>
<tr>
<th>æ¨¡å‹åç§°</th>
<th>SFTTrainer - Supervised Fine-Tuning Trainer - ç›‘ç£å¼å¾®è°ƒè®­ç»ƒå™¨</th>
<th>DPOTrainer - Direct Preference Optimization Trainer - ç›´æ¥åå¥½ä¼˜åŒ–è®­ç»ƒå™¨</th>
<th>GRPOTrainer - Generative Reward Policy Optimization Trainer - ç”Ÿæˆå¼å¥–åŠ±ç­–ç•¥ä¼˜åŒ–è®­ç»ƒå™¨</th>
</tr>
</thead>
<tbody><tr>
<td>è®­ç»ƒç›®æ ‡</td>
<td>æ¨¡ä»¿è®­ç»ƒæ•°æ®</td>
<td>å¯¹é½äººç±»åå¥½</td>
<td>æœ€å¤§åŒ–å¥–åŠ±å‡½æ•°</td>
</tr>
<tr>
<td>æ•°æ®éœ€æ±‚</td>
<td>è¾“å…¥-è¾“å‡ºæ•°æ®å¯¹ã€‚æ•°æ®å½¢å¼æ˜¯ â€œæŒ‡ä»¤ -&gt; æœŸæœ›è¾“å‡ºâ€ çš„å¯¹åº”å…³ç³»</td>
<td>åå¥½æ•°æ®ã€‚â€æŒ‡ä»¤ -&gt; (åå¥½è¾“å‡º, éåå¥½è¾“å‡º)â€ çš„æˆå¯¹æ¯”è¾ƒ</td>
<td>å¥–åŠ±ä¿¡å·ã€‚æ•°æ®å½¢å¼æ˜¯ä¸€ä¸ªæ•°å€¼å¥–åŠ±ï¼Œç”¨äºè¯„ä»·æ¨¡å‹åœ¨ç¯å¢ƒä¸­çš„è¡Œä¸º</td>
</tr>
<tr>
<td>æ ¸å¿ƒç®—æ³•</td>
<td>ç›‘ç£å­¦ä¹  (äº¤å‰ç†µæŸå¤±)</td>
<td>ç›´æ¥åå¥½ä¼˜åŒ– (DPO æŸå¤±)</td>
<td>å¼ºåŒ–å­¦ä¹  (PPO ç®—æ³•)</td>
</tr>
<tr>
<td>ä¼˜åŠ¿</td>
<td>ç®€å•æ˜“ç”¨, é«˜æ•ˆ, é€‚ç”¨å¤šç§ä»»åŠ¡</td>
<td>æ›´ç¬¦åˆäººç±»åå¥½, é¿å…å¥–åŠ±å‡½æ•°è®¾è®¡éš¾é¢˜, è®­ç»ƒç¨³å®š, å¯¹å¥–åŠ±å‡½æ•°åå·®æ›´é²æ£’</td>
<td>ç›´æ¥ä¼˜åŒ–ç›®æ ‡æŒ‡æ ‡, å¯å­¦ä¹ å¤æ‚ç­–ç•¥, é€‚ç”¨äºä¸ç¯å¢ƒäº¤äº’ä»»åŠ¡, ç²¾ç»†è¡Œä¸ºæ§åˆ¶</td>
</tr>
<tr>
<td>åŠ£åŠ¿</td>
<td>å¯èƒ½æ”¾å¤§æ•°æ®åå·®, éš¾å¤„ç†å¤æ‚åå¥½, å¯èƒ½è¿‡æ‹Ÿåˆ</td>
<td>éœ€è¦åå¥½æ•°æ®, å¯¹åå¥½æ•°æ®è´¨é‡æ•æ„Ÿ, å¯èƒ½ç‰ºç‰²éƒ¨åˆ†ç”Ÿæˆèƒ½åŠ›</td>
<td>è®­ç»ƒå¤æ‚ä¸ç¨³å®š, å¥–åŠ±å‡½æ•°è®¾è®¡å›°éš¾, è®¡ç®—æˆæœ¬é«˜, å¯èƒ½å¥–åŠ±å‡½æ•°åç§»</td>
</tr>
<tr>
<td>å¤æ‚åº¦</td>
<td>ä½</td>
<td>ä¸­</td>
<td>é«˜</td>
</tr>
<tr>
<td>åº”ç”¨åœºæ™¯ç¤ºä¾‹</td>
<td>- å†…å®¹ç”Ÿæˆ: è‡ªåŠ¨ç”Ÿæˆäº§å“æè¿°ã€æ–°é—»ç¨¿ã€ç¤¾äº¤åª’ä½“æ–‡æ¡ˆç­‰ã€‚<br>- æŒ‡ä»¤è·Ÿéš: ç®€å•çš„é—®ç­”ç³»ç»Ÿã€æ–‡æ¡£æ‘˜è¦ã€ä»£ç ç”Ÿæˆç­‰ã€‚ <br>- æ•°æ®å¢å¼º: ç”Ÿæˆç‰¹å®šæ ¼å¼æˆ–é£æ ¼çš„åˆæˆæ•°æ®ï¼Œä¾‹å¦‚ç‰¹å®šé£æ ¼çš„æ–‡æœ¬æˆ–ä»£ç ã€‚<br></td>
<td>- å¯¹è¯ç³»ç»Ÿ: è®­ç»ƒå®¢æœæœºå™¨äººã€èŠå¤©æœºå™¨äººï¼Œä½¿å…¶å›å¤æ›´ç¤¼è²Œã€æ›´äººæ€§åŒ–ã€æ›´ç¬¦åˆç”¨æˆ·æœŸæœ›ã€‚<br>- å†…å®¹å®¡æ ¸: è®­ç»ƒæ¨¡å‹åˆ¤æ–­æ–‡æœ¬æ˜¯å¦å®‰å…¨ã€æ— å®³ã€ç¬¦åˆé“å¾·æ ‡å‡†ã€‚<br>- åå¥½æ’åº: è®­ç»ƒæ¨¡å‹æ ¹æ®ç”¨æˆ·åå¥½å¯¹å¤šä¸ªé€‰é¡¹è¿›è¡Œæ’åºæˆ–é€‰æ‹© (ä¾‹å¦‚ï¼Œæ’åºæ–°é—»æ‘˜è¦ã€æ¨èå•†å“)ã€‚</td>
<td>- æ¸¸æˆ AI: è®­ç»ƒæ¸¸æˆ Botï¼Œåœ¨æ¸¸æˆä¸­è·å¾—é«˜åˆ†æˆ–æˆ˜èƒœå¯¹æ‰‹ã€‚<br>- äº¤æ˜“ç­–ç•¥: è®­ç»ƒäº¤æ˜“æœºå™¨äººï¼Œä½¿å…¶åœ¨è‚¡ç¥¨å¸‚åœºæˆ–åŠ å¯†è´§å¸å¸‚åœºä¸­æœ€å¤§åŒ–æ”¶ç›Šã€‚<br>- æœºå™¨äººæ§åˆ¶: è®­ç»ƒæœºå™¨äººå®Œæˆå¤æ‚ä»»åŠ¡ï¼Œä¾‹å¦‚å¯¼èˆªã€ç‰©ä½“æŠ“å–ç­‰ï¼Œæœ€å¤§åŒ–ä»»åŠ¡å®Œæˆæ•ˆç‡æˆ–æˆåŠŸç‡ã€‚ <br>- å¤æ‚å¯¹è¯ç­–ç•¥: è®­ç»ƒå¯¹è¯ç³»ç»Ÿè¿›è¡Œå¤šè½®å¯¹è¯ï¼Œæœ€ç»ˆè¾¾æˆç”¨æˆ·ç›®æ ‡ (ä¾‹å¦‚ï¼Œé¢„å®šé¤å…ã€è§£å†³å¤æ‚é—®é¢˜)ã€‚</td>
</tr>
</tbody></table>
<h2 id="1-è¾“å…¥-è¾“å‡ºæ•°æ®å¯¹-Input-Output-Data-Pairs-SFTTrainer-ä½¿ç”¨"><a href="#1-è¾“å…¥-è¾“å‡ºæ•°æ®å¯¹-Input-Output-Data-Pairs-SFTTrainer-ä½¿ç”¨" class="headerlink" title="1. è¾“å…¥-è¾“å‡ºæ•°æ®å¯¹ (Input-Output Data Pairs) - SFTTrainer ä½¿ç”¨"></a>1. è¾“å…¥-è¾“å‡ºæ•°æ®å¯¹ (Input-Output Data Pairs) - SFTTrainer ä½¿ç”¨</h2><p>è¿™ç§æ•°æ®å½¢å¼æ˜¯æœ€ç›´æ¥çš„ï¼Œç”¨äºç›‘ç£å¼å¾®è°ƒ (SFTTrainer)ã€‚ æ¯ä¸ªæ•°æ®æ ·æœ¬éƒ½åŒ…å«ä¸€ä¸ª è¾“å…¥ (Input) å’Œä¸€ä¸ªæœŸæœ›çš„ è¾“å‡º (Output)ã€‚</p>
<p>åº”ç”¨åœºæ™¯ä¾‹å­ï¼š<strong>æŒ‡ä»¤è·Ÿéš (Instruction Following)</strong> - ç®€å•çš„é—®ç­”ä»»åŠ¡<br><strong>ç¤ºä¾‹ï¼š</strong></p>
<ul>
<li>é—®ç­”ç³»ç»Ÿï¼š â€œé—®é¢˜ -&gt; ç­”æ¡ˆâ€</li>
<li>ç¿»è¯‘ä»»åŠ¡ï¼š â€œåŸæ–‡ -&gt; è¯‘æ–‡â€</li>
<li>æ‘˜è¦ç”Ÿæˆï¼š â€œæ–‡ç«  -&gt; æ‘˜è¦â€</li>
<li>æ ·ä¾‹æ•°æ®æ ¼å¼ (JSON æ ¼å¼ç¤ºä¾‹):<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span>: <span class="string">&quot;æ³•å›½çš„é¦–éƒ½æ˜¯å“ªé‡Œï¼Ÿ&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;output&quot;</span>: <span class="string">&quot;æ³•å›½çš„é¦–éƒ½æ˜¯å·´é»ã€‚&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span>: <span class="string">&quot;è¯·å†™ä¸€ä¸ªå…³äºå¤å¤©çš„ç®€çŸ­æ•…äº‹ã€‚&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;output&quot;</span>: <span class="string">&quot;é˜³å…‰æ´’åœ¨é‡‘è‰²çš„æ²™æ»©ä¸Šï¼Œæµ·é£è½»è½»å¹æ‹‚ï¼Œå­©å­ä»¬åœ¨æµ·è¾¹å¬‰æˆï¼Œå†°æ·‡æ·‹èåŒ–åœ¨ç”œç”œçš„ç¬‘å®¹é‡Œï¼Œå¤å¤©çœŸç¾å¥½ã€‚&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span>: <span class="string">&quot;å°†è¿™å¥è¯ç¿»è¯‘æˆè‹±æ–‡ï¼šä½ å¥½ä¸–ç•Œã€‚&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;output&quot;</span>: <span class="string">&quot;Hello world.&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ... æ›´å¤šæ•°æ®æ ·æœ¬</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
è§£é‡Š:</li>
<li>â€œinstructionâ€ (è¾“å…¥): ä»£è¡¨ç”¨æˆ·ç»™æ¨¡å‹çš„æŒ‡ä»¤æˆ–é—®é¢˜ã€‚</li>
<li>â€œoutputâ€ (è¾“å‡º): ä»£è¡¨æ¨¡å‹åº”è¯¥ç”Ÿæˆçš„æœŸæœ›å›å¤æˆ–ç­”æ¡ˆã€‚</li>
<li>æ•°æ®ç›®æ ‡: SFTTrainer çš„ç›®æ ‡æ˜¯è®©æ¨¡å‹å­¦ä¹ å°† â€œinstructionâ€ æ˜ å°„åˆ° â€œoutputâ€ï¼Œæ¨¡ä»¿è®­ç»ƒæ•°æ®ä¸­çš„è¿™ç§å¯¹åº”å…³ç³»ã€‚</li>
</ul>
<p>åº”ç”¨åœºæ™¯ä¾‹å­ï¼š<strong>å†…å®¹ç”Ÿæˆ (Content Generation)</strong> - ç”Ÿæˆäº§å“æè¿°</p>
<ul>
<li>æ ·ä¾‹æ•°æ®æ ¼å¼ (JSON æ ¼å¼ç¤ºä¾‹):<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;input&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;product_name&quot;</span>: <span class="string">&quot;æ™ºèƒ½å’–å•¡æœº&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;features&quot;</span>: [<span class="string">&quot;ä¸€é”®æ“ä½œ&quot;</span>, <span class="string">&quot;å¤šç§å’–å•¡æ¨¡å¼&quot;</span>, <span class="string">&quot;å¯é¢„çº¦&quot;</span>, <span class="string">&quot;è‡ªåŠ¨æ¸…æ´—&quot;</span>],</span><br><span class="line">      <span class="attr">&quot;materials&quot;</span>: [<span class="string">&quot;ä¸é”ˆé’¢&quot;</span>, <span class="string">&quot;è€çƒ­ç»ç’ƒ&quot;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;output&quot;</span>: <span class="string">&quot;è¿™æ¬¾æ™ºèƒ½å’–å•¡æœºè®©æ‚¨åœ¨å®¶ä¹Ÿèƒ½è½»æ¾äº«å—å’–å•¡é¦†çº§çš„ç¾å‘³ã€‚ä¸€é”®æ“ä½œï¼Œå¤šç§å’–å•¡æ¨¡å¼éšå¿ƒé€‰æ‹©ï¼Œæ›´æœ‰é¢„çº¦åŠŸèƒ½ï¼Œè®©æ‚¨æ—©æ™¨é†’æ¥å°±èƒ½å“å°åˆ°é¦™æµ“å’–å•¡ã€‚é‡‡ç”¨ä¸é”ˆé’¢å’Œè€çƒ­ç»ç’ƒæè´¨ï¼Œåšå›ºè€ç”¨ï¼Œå¹¶å…·å¤‡è‡ªåŠ¨æ¸…æ´—åŠŸèƒ½ï¼Œçœå¿ƒçœåŠ›ã€‚&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ... æ›´å¤šæ•°æ®æ ·æœ¬</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
è§£é‡Š:</li>
<li>â€œinputâ€ (è¾“å…¥): å¯ä»¥æ˜¯æ›´ç»“æ„åŒ–çš„ä¿¡æ¯ï¼Œä¾‹å¦‚äº§å“çš„ç‰¹å¾ã€æè´¨ç­‰ã€‚</li>
<li>â€œoutputâ€ (è¾“å‡º): æ˜¯åŸºäºè¾“å…¥ä¿¡æ¯ç”Ÿæˆçš„æœŸæœ›äº§å“æè¿°æ–‡æœ¬ã€‚</li>
</ul>
<h2 id="2-åå¥½æ•°æ®-Pairwise-Ranking-DPOTrainer-ä½¿ç”¨"><a href="#2-åå¥½æ•°æ®-Pairwise-Ranking-DPOTrainer-ä½¿ç”¨" class="headerlink" title="2. åå¥½æ•°æ® (Pairwise Ranking) - DPOTrainer ä½¿ç”¨"></a>2. åå¥½æ•°æ® (Pairwise Ranking) - DPOTrainer ä½¿ç”¨</h2><p>è¿™ç§æ•°æ®å½¢å¼ç”¨äºç›´æ¥åå¥½ä¼˜åŒ– (DPOTrainer)ã€‚ å¯¹äºåŒä¸€ä¸ªè¾“å…¥ï¼Œæˆ‘ä»¬æä¾›ä¸¤ä¸ªæ¨¡å‹ç”Ÿæˆçš„è¾“å‡ºï¼Œå¹¶æ ‡æ³¨å“ªä¸ªè¾“å‡ºæ›´ç¬¦åˆåå¥½ã€‚</p>
<p>åº”ç”¨åœºæ™¯ä¾‹å­ï¼š<strong>å¯¹è¯ç³»ç»Ÿ (Chatbot)</strong> - æå‡å›å¤è´¨é‡å’Œåå¥½</p>
<ul>
<li>æ ·ä¾‹æ•°æ®æ ¼å¼ (JSON æ ¼å¼ç¤ºä¾‹):<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span>: <span class="string">&quot;ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;chosen&quot;</span>: <span class="string">&quot;ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œé˜³å…‰æ˜åªšï¼Œéå¸¸é€‚åˆæˆ·å¤–æ´»åŠ¨ã€‚&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;rejected&quot;</span>: <span class="string">&quot;å¤©æ°”è¿˜è¡Œã€‚&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;instruction&quot;</span>: <span class="string">&quot;è¯·é—®ä½ èƒ½æ¨èä¸€å®¶é™„è¿‘çš„æ„å¤§åˆ©é¤å…å—ï¼Ÿ&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;chosen&quot;</span>: <span class="string">&quot;å½“ç„¶ï¼Œé™„è¿‘æœ‰ä¸€å®¶è¯„ä»·å¾ˆé«˜çš„æ„å¤§åˆ©é¤å…ï¼Œåå«â€œæ‰˜æ–¯å¡çº³é˜³å…‰â€ï¼Œä»–ä»¬å®¶çš„æŠ«è¨å’Œæ„é¢éå¸¸å—æ¬¢è¿ï¼Œåœ°å€æ˜¯â€¦ [åœ°å€ä¿¡æ¯] â€¦ï¼Œæ‚¨è¦æˆ‘å¸®æ‚¨æŸ¥è¯¢ä¸€ä¸‹ç”µè¯æˆ–è€…é¢„å®šå—ï¼Ÿ&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;rejected&quot;</span>: <span class="string">&quot;æˆ‘æ¨èä¸€å®¶æ„å¤§åˆ©é¤å…ã€‚&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ... æ›´å¤šæ•°æ®æ ·æœ¬</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li>è§£é‡Š:<ul>
<li>â€œinstructionâ€ (è¾“å…¥): ç”¨æˆ·çš„é—®é¢˜æˆ–æŒ‡ä»¤ã€‚</li>
<li>â€œchosenâ€ (åå¥½è¾“å‡º): è¢«è®¤ä¸ºæ›´å¥½æˆ–æ›´ç¬¦åˆåå¥½çš„å›å¤ã€‚ä¾‹å¦‚ï¼Œæ›´è¯¦ç»†ã€æ›´ç¤¼è²Œã€æ›´ä¹äºåŠ©äººçš„å›å¤ã€‚</li>
<li>â€œrejectedâ€ (éåå¥½è¾“å‡º): è¢«è®¤ä¸ºç›¸å¯¹è¾ƒå·®æˆ–ä¸å¤ªç¬¦åˆåå¥½çš„å›å¤ã€‚ä¾‹å¦‚ï¼Œæ›´ç®€çŸ­ã€æ›´ç”Ÿç¡¬ã€ä¿¡æ¯é‡è¾ƒå°‘çš„å›å¤ã€‚</li>
<li>æ•°æ®ç›®æ ‡: DPOTrainer å­¦ä¹ åˆ°ï¼Œå¯¹äºç›¸åŒçš„ â€œinstructionâ€ï¼Œæ¨¡å‹åº”è¯¥å€¾å‘äºç”Ÿæˆç±»ä¼¼ â€œchosenâ€ è¿™æ ·çš„å›å¤ï¼Œè€Œä¸æ˜¯ â€œrejectedâ€ è¿™æ ·çš„å›å¤ã€‚åå¥½å¯ä»¥æ˜¯åŸºäºç¤¼è²Œç¨‹åº¦ã€ä¿¡æ¯é‡ã€æ˜¯å¦ä¹äºåŠ©äººã€æ˜¯å¦ç¬¦åˆç‰¹å®šä»·å€¼è§‚ç­‰ç­‰ã€‚</li>
</ul>
</li>
</ul>
<h2 id="3-å¥–åŠ±ä¿¡å·-Reward-Signal-GRPOTrainer-ä½¿ç”¨"><a href="#3-å¥–åŠ±ä¿¡å·-Reward-Signal-GRPOTrainer-ä½¿ç”¨" class="headerlink" title="3. å¥–åŠ±ä¿¡å· (Reward Signal) - GRPOTrainer ä½¿ç”¨"></a>3. å¥–åŠ±ä¿¡å· (Reward Signal) - GRPOTrainer ä½¿ç”¨</h2><p>å¥–åŠ±ä¿¡å·æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œç”¨äºè¯„ä»·æ¨¡å‹åœ¨ç‰¹å®šç¯å¢ƒæˆ–ä»»åŠ¡ä¸­ç”Ÿæˆçš„è¾“å‡ºè´¨é‡ã€‚ GRPOTrainer ä½¿ç”¨å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼Œç›®æ ‡æ˜¯æœ€å¤§åŒ–æ¨¡å‹è·å¾—çš„ç´¯ç§¯å¥–åŠ±ã€‚</p>
<p>åº”ç”¨åœºæ™¯ä¾‹å­ï¼š<strong>æ¸¸æˆ AI (Game AI)</strong> - è®­ç»ƒæ¸¸æˆ Bot ä¸‹å›´æ£‹</p>
<ul>
<li>å¥–åŠ±å‡½æ•°ç¤ºä¾‹ (Python ä¼ªä»£ç ):<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reward_function</span>(<span class="params">game_state, action</span>):</span></span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  å®šä¹‰å›´æ£‹æ¸¸æˆä¸­çš„å¥–åŠ±å‡½æ•°.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Args:</span></span><br><span class="line"><span class="string">    game_state: å½“å‰çš„æ£‹å±€çŠ¶æ€.</span></span><br><span class="line"><span class="string">    action: æ¨¡å‹é‡‡å–çš„è½å­åŠ¨ä½œ.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Returns:</span></span><br><span class="line"><span class="string">    reward:  ä¸€ä¸ªæ•°å€¼å¥–åŠ±ä¿¡å·.</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> is_illegal_move(game_state, action): <span class="comment"># è½å­æ˜¯å¦ä¸ºéæ³•</span></span><br><span class="line">    reward = <span class="number">-10</span>  <span class="comment"># éæ³•è½å­ï¼Œè´Ÿå¥–åŠ±ï¼Œæƒ©ç½šæ¨¡å‹</span></span><br><span class="line">  <span class="keyword">elif</span> is_capture_opponent_piece(game_state, action): <span class="comment"># æ˜¯å¦åƒæ‰å¯¹æ–¹æ£‹å­</span></span><br><span class="line">    reward = +<span class="number">5</span>   <span class="comment"># åƒæ‰å¯¹æ–¹æ£‹å­ï¼Œæ­£å¥–åŠ±</span></span><br><span class="line">  <span class="keyword">elif</span> is_win(game_state): <span class="comment"># æ˜¯å¦èµ¢å¾—æ¸¸æˆ</span></span><br><span class="line">    reward = +<span class="number">100</span>  <span class="comment"># èµ¢å¾—æ¸¸æˆï¼Œå·¨å¤§æ­£å¥–åŠ±</span></span><br><span class="line">  <span class="keyword">elif</span> is_lose(game_state): <span class="comment"># æ˜¯å¦è¾“æ‰æ¸¸æˆ</span></span><br><span class="line">    reward = <span class="number">-50</span>  <span class="comment"># è¾“æ‰æ¸¸æˆï¼Œè´Ÿå¥–åŠ±</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    reward = <span class="number">-0.1</span> <span class="comment"># å¸¸è§„è½å­ï¼Œè½»å¾®è´Ÿå¥–åŠ± (é¼“åŠ±å°½å¿«ç»“æŸæ¸¸æˆï¼Œé¿å…æ— æ„ä¹‰çš„æ­¥éª¤ - å¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´)</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> reward</span><br></pre></td></tr></table></figure></li>
<li>è§£é‡Š:<ul>
<li>å¥–åŠ±å‡½æ•°: <code>reward_function</code> å°±æ˜¯ä¸€ä¸ªå¥–åŠ±å‡½æ•°ï¼Œå®ƒæ ¹æ®å½“å‰çš„æ¸¸æˆçŠ¶æ€å’Œæ¨¡å‹é‡‡å–çš„åŠ¨ä½œï¼Œè®¡ç®—å‡ºä¸€ä¸ªæ•°å€¼å¥–åŠ±ã€‚</li>
<li>å¥–åŠ±ä¿¡å·: æ¯æ¬¡æ¨¡å‹åœ¨æ¸¸æˆä¸­æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œåï¼Œç¯å¢ƒ (å›´æ£‹æ¸¸æˆ) ä¼šæ ¹æ® <code>reward_function</code> è®¡ç®—å‡ºä¸€ä¸ªå¥–åŠ±å€¼ï¼Œå¹¶å°†è¿™ä¸ªå¥–åŠ±å€¼åé¦ˆç»™æ¨¡å‹ã€‚</li>
<li>æ•°æ®ç›®æ ‡: GRPOTrainer é€šè¿‡ä¸æ–­å°è¯•ä¸åŒçš„åŠ¨ä½œï¼Œå¹¶æ ¹æ®è·å¾—çš„å¥–åŠ±ä¿¡å·å­¦ä¹ ï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªç­–ç•¥ (å³æ¨¡å‹çš„å‚æ•°)ï¼Œä½¿å¾—åœ¨å›´æ£‹æ¸¸æˆä¸­èƒ½å¤Ÿè·å¾—å°½å¯èƒ½é«˜çš„ç´¯ç§¯å¥–åŠ± (ä¾‹å¦‚ï¼Œæœ€ç»ˆèµ¢å¾—æ¸¸æˆ)ã€‚</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2025/02/11/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E8%A6%81%E5%8D%A0%E7%94%A8%E5%A4%9A%E5%B0%91%E6%98%BE%E5%AD%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/02/11/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E8%A6%81%E5%8D%A0%E7%94%A8%E5%A4%9A%E5%B0%91%E6%98%BE%E5%AD%98/" class="post-title-link" itemprop="url">å¤§æ¨¡å‹è¦å ç”¨å¤šå°‘æ˜¾å­˜</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-02-11 09:48:00" itemprop="dateCreated datePublished" datetime="2025-02-11T09:48:00+08:00">2025-02-11</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2025-02-27 10:52:31" itemprop="dateModified" datetime="2025-02-27T10:52:31+08:00">2025-02-27</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="éƒ¨ç½²è¦å ç”¨å¤šå°‘æ˜¾å­˜"><a href="#éƒ¨ç½²è¦å ç”¨å¤šå°‘æ˜¾å­˜" class="headerlink" title="éƒ¨ç½²è¦å ç”¨å¤šå°‘æ˜¾å­˜"></a>éƒ¨ç½²è¦å ç”¨å¤šå°‘æ˜¾å­˜</h2><p>ä»¥è¿è¡Œç²¾åº¦ä¸º INT8 çš„å¤§æ¨¡å‹ä¸ºä¾‹ï¼Œè¿™ç§ç²¾åº¦çš„å‚æ•°ï¼Œä¸€ä¸ªå‚æ•°éœ€è¦å ç”¨ä¸€ä¸ªå­—èŠ‚ã€‚<br>$1Bå‚æ•°æ¨¡å‹ = 10äº¿å‚æ•° * æ¯ä¸ªå‚æ•°å ç”¨1Byte$<br>$1Gæ˜¾å­˜ = 1024<em>1024</em>1024Byte$<br>ä¹Ÿå°±æ˜¯è¯´<br><strong>INT8 ç²¾åº¦ç±»å‹ï¼š1B å‚æ•°éœ€è¦çº¦ 1G æ˜¾å­˜ã€‚</strong></p>
<table>
<thead>
<tr>
<th>dtype</th>
<th align="center">1Bæ¨¡å‹éœ€è¦å ç”¨çš„æ˜¾å­˜</th>
</tr>
</thead>
<tbody><tr>
<td>float32</td>
<td align="center">4G</td>
</tr>
<tr>
<td>fp16/bf16</td>
<td align="center">2G</td>
</tr>
<tr>
<td>int8</td>
<td align="center">1G</td>
</tr>
<tr>
<td>int4</td>
<td align="center">0.5G</td>
</tr>
<tr>
<td>ç„¶åå°±å¯ä»¥å¿«é€Ÿè®¡ç®—å„ä¸ªç±»å‹ç²¾åº¦çš„å¤§æ¨¡å‹éœ€è¦å¤šå°‘æ˜¾å­˜ï¼Œä¾‹å¦‚ f16 çš„ 70B å‚æ•°å¤§æ¨¡å‹ï¼Œå°±éœ€è¦â€œç²¾åº¦è†¨èƒ€ç³»æ•°â€ 2*70=140Gæ˜¾å­˜ã€‚</td>
<td align="center"></td>
</tr>
</tbody></table>
<h2 id="è®­ç»ƒè¦å ç”¨å¤šå°‘æ˜¾å­˜"><a href="#è®­ç»ƒè¦å ç”¨å¤šå°‘æ˜¾å­˜" class="headerlink" title="è®­ç»ƒè¦å ç”¨å¤šå°‘æ˜¾å­˜"></a>è®­ç»ƒè¦å ç”¨å¤šå°‘æ˜¾å­˜</h2><p>è¿™é‡Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªåœ¨çº¿çš„ç½‘é¡µå·¥å…·ï¼š<a target="_blank" rel="noopener" href="https://huggingface.co/spaces/hf-accelerate/model-memory-usage">https://huggingface.co/spaces/hf-accelerate/model-memory-usage</a><br><img src="/2025/02/11/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E8%A6%81%E5%8D%A0%E7%94%A8%E5%A4%9A%E5%B0%91%E6%98%BE%E5%AD%98/1.jpg"></p>
<p>æ¨¡å‹åŒ…æ‹¬ï¼š DeepSeek R1 (671B)ï¼ŒDeepSeek R1 Distill Qwen 7Bï¼Œ 14Bï¼Œ 32Bï¼Œ ä»¥åŠ DeepSeek R1 Distill Llama 8Bï¼Œ 70B è¿™äº›æ¨¡å‹ï¼Œ</p>
<ol>
<li>å‡è®¾åœ¨å¹¶å‘ 3 ä¸ªç”¨æˆ·çš„æƒ…å†µä¸‹è¿è¡Œè¿™äº›æ¨¡å‹æ‰€éœ€çš„èµ„æºï¼Ÿ</li>
<li>å…³äº DeepSeek R1 ç³»åˆ—æ¨¡å‹åœ¨ä¸åŒæ•°æ®é‡ä¸‹è¿›è¡Œå¾®è°ƒï¼ˆå¹¶éå…¨é‡è®­ç»ƒï¼‰ï¼Œå¹¶åœ¨ä¸€å¤©å†…å®Œæˆå¾®è°ƒæ‰€éœ€çš„ç¡¬ä»¶èµ„æºã€‚åˆ†åˆ«åœ¨ 1Kï¼Œ1Mï¼Œ1GBï¼Œ1T æ•°æ®é‡ä¸‹è®­ç»ƒè¿™äº›æ¨¡å‹æ‰€éœ€çš„èµ„æºå’Œè®­ç»ƒæ—¶é•¿ã€‚</li>
</ol>
<p>æ ¹æ®æ‚¨æä¾›çš„ä¿¡æ¯ï¼Œä»¥åŠä¹‹å‰çš„åˆ†æï¼Œä»¥ä¸‹æ˜¯å…³äº DeepSeek R1 ç³»åˆ—æ¨¡å‹å¾®è°ƒç¡¬ä»¶èµ„æºéœ€æ±‚çš„å…¨é¢åˆ†æï¼Œå¹¶ä»¥è¡¨æ ¼å½¢å¼å‘ˆç°ï¼š</p>
<h2 id="DeepSeek-R1-æ¨¡å‹å¾®è°ƒç¡¬ä»¶èµ„æºéœ€æ±‚æ€»è¡¨-å•æ—¥å†…å®Œæˆ"><a href="#DeepSeek-R1-æ¨¡å‹å¾®è°ƒç¡¬ä»¶èµ„æºéœ€æ±‚æ€»è¡¨-å•æ—¥å†…å®Œæˆ" class="headerlink" title="DeepSeek R1 æ¨¡å‹å¾®è°ƒç¡¬ä»¶èµ„æºéœ€æ±‚æ€»è¡¨ (å•æ—¥å†…å®Œæˆ)"></a>DeepSeek R1 æ¨¡å‹å¾®è°ƒç¡¬ä»¶èµ„æºéœ€æ±‚æ€»è¡¨ (å•æ—¥å†…å®Œæˆ)</h2><p>é‡‡ç”¨BF16ï¼ˆ2å­—èŠ‚/å‚æ•°ï¼‰çš„æƒ…å†µä¸‹ï¼Œè€ƒè™‘åˆ° Unsloth ä¸»è¦ä¼˜åŒ– LoRA å¾®è°ƒï¼Œå¹¶ä¸”æ›´é€‚ç”¨äºå• GPU æˆ–å°‘é‡ GPU åœºæ™¯ï¼ŒåŸºäº Unsloth ä¼˜åŒ– LoRA å¾®è°ƒçš„å‡è®¾ï¼Œé‡æ–°è¯„ä¼° DeepSeek R1 ç³»åˆ—æ¨¡å‹åœ¨ä¸­å°æ•°æ®é‡ (1K, 1M, 1G, 10G) ä¸‹çš„ç¡¬ä»¶èµ„æºéœ€æ±‚ã€‚ å¯¹äºè¶…å¤§æ•°æ®é‡ (100G) å’Œè¶…å¤§æ¨¡å‹ (DeepSeek-R1-671B)ï¼Œæˆ‘ä»ç„¶ä¿ç•™ ZeRO-3 ä¼˜åŒ–ã€‚</p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>æ•°æ®size</th>
<th>GPU é…ç½® (æ˜¾å­˜éœ€æ±‚)</th>
<th>CPU æ ¸å¿ƒæ•°</th>
<th>å†…å­˜</th>
<th>å­˜å‚¨ (SSD/NVMe)</th>
<th>ç½‘ç»œå¸¦å®½</th>
<th>å…³é”®é…ç½®è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>DeepSeek-R1-671B BF16</strong></td>
<td>1M</td>
<td>16Ã—A100 80G</td>
<td>64æ ¸</td>
<td>512GB</td>
<td>2TB</td>
<td>25Gbps RDMA</td>
<td>æ¨¡å‹å¹¶è¡Œ (TP=16) + æ•°æ®å¹¶è¡Œ (DP=2)</td>
</tr>
<tr>
<td></td>
<td>1G</td>
<td>64Ã—A100 80G</td>
<td>256æ ¸</td>
<td>1TB</td>
<td>5TB</td>
<td>50Gbps RDMA</td>
<td>TP=8 + DP=8 + ZeRO-3</td>
</tr>
<tr>
<td></td>
<td>10G</td>
<td>128Ã—A100 80G</td>
<td>512æ ¸</td>
<td>2TB</td>
<td>10TB</td>
<td>100Gbps RDMA</td>
<td>TP=8 + DP=16 + ZeRO-3</td>
</tr>
<tr>
<td></td>
<td>100G</td>
<td>192Ã—A100 80G</td>
<td>768æ ¸</td>
<td>4TB</td>
<td>15TB</td>
<td>150Gbps RDMA</td>
<td>TP=8 + DP=24 + ZeRO-3</td>
</tr>
<tr>
<td><strong>Distill-Qwen-7B 4-bit</strong></td>
<td>1M</td>
<td>1Ã—A10G 24G (Unsloth)</td>
<td>8æ ¸</td>
<td>64GB</td>
<td>500GB</td>
<td>1Gbps</td>
<td>å•å¡ 4-bit LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>1G</td>
<td>2Ã—A10G 24G (Unsloth)</td>
<td>16æ ¸</td>
<td>128GB</td>
<td>1TB</td>
<td>5Gbps</td>
<td>DP=2 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>10G</td>
<td>4Ã—A10G 24G (Unsloth)</td>
<td>32æ ¸</td>
<td>256GB</td>
<td>2TB</td>
<td>5Gbps</td>
<td>DP=4 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>100G</td>
<td>8Ã—A10G 24G (Unsloth)</td>
<td>64æ ¸</td>
<td>512GB</td>
<td>3TB</td>
<td>10Gbps</td>
<td>DP=8 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td><strong>Distill-Qwen-14B 4-bit</strong></td>
<td>1M</td>
<td>1Ã—A100 40G (Unsloth)</td>
<td>16æ ¸</td>
<td>128GB</td>
<td>1TB</td>
<td>5Gbps</td>
<td>å•å¡ LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>1G</td>
<td>4Ã—A100 40G (Unsloth)</td>
<td>32æ ¸</td>
<td>256GB</td>
<td>2TB</td>
<td>10Gbps</td>
<td>DP=4 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>10G</td>
<td>8Ã—A100 40G (Unsloth)</td>
<td>64æ ¸</td>
<td>512GB</td>
<td>3TB</td>
<td>10Gbps</td>
<td>DP=8 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>100G</td>
<td>16Ã—A100 40G (Unsloth)</td>
<td>128æ ¸</td>
<td>1TB</td>
<td>5TB</td>
<td>25Gbps</td>
<td>DP=16 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td><strong>Distill-Qwen-32B BF16</strong></td>
<td>1G</td>
<td>4Ã—A100 80G (Unsloth)</td>
<td>64æ ¸</td>
<td>512GB</td>
<td>2TB</td>
<td>10Gbps</td>
<td>TP=4 + DP=2</td>
</tr>
<tr>
<td></td>
<td>10G</td>
<td>8Ã—A100 80G (Unsloth)</td>
<td>128æ ¸</td>
<td>1TB</td>
<td>3TB</td>
<td>25Gbps</td>
<td>DP=8 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>100G</td>
<td>32Ã—A100 80G</td>
<td>256æ ¸</td>
<td>2TB</td>
<td>10TB</td>
<td>50Gbps RDMA</td>
<td>TP=4 + DP=8 + ZeRO-3</td>
</tr>
<tr>
<td><strong>Distill-Llama-8B 4-bit</strong></td>
<td>1M</td>
<td>1Ã—A10G 24G (Unsloth)</td>
<td>8æ ¸</td>
<td>64GB</td>
<td>500GB</td>
<td>1Gbps</td>
<td>å•å¡ LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>1G</td>
<td>2Ã—A10G 24G (Unsloth)</td>
<td>16æ ¸</td>
<td>128GB</td>
<td>1TB</td>
<td>5Gbps</td>
<td>DP=2 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>10G</td>
<td>4Ã—A10G 24G (Unsloth)</td>
<td>32æ ¸</td>
<td>256GB</td>
<td>2TB</td>
<td>5Gbps</td>
<td>DP=4 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td></td>
<td>100G</td>
<td>8Ã—A10G 24G (Unsloth)</td>
<td>48æ ¸</td>
<td>384GB</td>
<td>3TB</td>
<td>10Gbps</td>
<td>DP=8 + LoRA å¾®è°ƒ (Unsloth)</td>
</tr>
<tr>
<td><strong>Distill-Llama-70B BF16</strong></td>
<td>1M</td>
<td>8Ã—A100 80G</td>
<td>64æ ¸</td>
<td>512GB</td>
<td>2TB</td>
<td>25Gbps RDMA</td>
<td>TP=4 + DP=2 (ZeRO-3 for 70B still recommended)</td>
</tr>
<tr>
<td></td>
<td>1G</td>
<td>32Ã—A100 80G</td>
<td>128æ ¸</td>
<td>1TB</td>
<td>5TB</td>
<td>25Gbps RDMA</td>
<td>TP=4 + DP=8 (ZeRO-3 for 70B still recommended)</td>
</tr>
<tr>
<td></td>
<td>10G</td>
<td>64Ã—A100 80G</td>
<td>256æ ¸</td>
<td>2TB</td>
<td>10TB</td>
<td>50Gbps RDMA</td>
<td>TP=8 + DP=8 + ZeRO-3</td>
</tr>
<tr>
<td></td>
<td>100G</td>
<td>128Ã—A100 80G</td>
<td>512æ ¸</td>
<td>4TB</td>
<td>15TB</td>
<td>100Gbps RDMA</td>
<td>TP=8 + DP=16 + ZeRO-3</td>
</tr>
</tbody></table>
<p><strong>GPU é…ç½® (æ˜¾å­˜éœ€æ±‚)</strong>: æŒ‡å®Œæˆå¾®è°ƒä»»åŠ¡æ‰€éœ€çš„ GPU å‹å·å’Œæ•°é‡ï¼Œä»¥åŠæ€»æ˜¾å­˜éœ€æ±‚ã€‚ä¾‹å¦‚ â€œ16Ã—A100 80Gâ€ è¡¨ç¤ºéœ€è¦ 16 å¼  80GB æ˜¾å­˜çš„ A100 GPUã€‚<br><strong>CPU æ ¸å¿ƒæ•°</strong>: è®­ç»ƒä»»åŠ¡æ‰€éœ€çš„ CPU æ ¸å¿ƒæ•°é‡ï¼Œä¸»è¦ç”¨äºæ•°æ®é¢„å¤„ç†å’Œæ¨¡å‹ç®¡ç†ã€‚<br><strong>å†…å­˜</strong>: ç³»ç»Ÿå†…å­˜éœ€æ±‚ï¼Œç”¨äºæ•°æ®ç¼“å­˜ã€æ¨¡å‹åŠ è½½å’Œè®­ç»ƒè¿‡ç¨‹ä¸­çš„ä¸´æ—¶æ•°æ®å­˜å‚¨ã€‚<br><strong>å­˜å‚¨ (SSD/NVMe)</strong>: é«˜é€Ÿå›ºæ€ç¡¬ç›˜å®¹é‡éœ€æ±‚ï¼Œç”¨äºå­˜å‚¨è®­ç»ƒæ•°æ®ã€æ¨¡å‹å‚æ•°å’Œä¸­é—´ç»“æœã€‚NVMe SSD æä¾›æ›´å¿«çš„è¯»å†™é€Ÿåº¦ï¼Œé€‚ç”¨äºå¤§æ•°æ®é‡è®­ç»ƒã€‚<br><strong>ç½‘ç»œå¸¦å®½</strong>: å¤š GPU è®­ç»ƒæ—¶æ‰€éœ€çš„ç½‘ç»œå¸¦å®½ï¼Œç”¨äº GPU ä¹‹é—´çš„æ•°æ®é€šä¿¡ã€‚RDMA (Remote Direct Memory Access) ç½‘ç»œæä¾›æ›´ä½çš„å»¶è¿Ÿå’Œæ›´é«˜çš„å¸¦å®½ï¼Œé€‚ç”¨äºå¤§è§„æ¨¡åˆ†å¸ƒå¼è®­ç»ƒã€‚<br><strong>å…³é”®é…ç½®è¯´æ˜</strong>: ç®€è¦æè¿°äº†é’ˆå¯¹ä¸åŒæ¨¡å‹å’Œæ•°æ®é‡æ‰€é‡‡ç”¨çš„å…³é”®å¹¶è¡Œç­–ç•¥å’Œä¼˜åŒ–æŠ€æœ¯ï¼Œä¾‹å¦‚æ¨¡å‹å¹¶è¡Œ (TP)ã€æ•°æ®å¹¶è¡Œ (DP)ã€ZeRO-3 ä¼˜åŒ–å’Œæ¢¯åº¦ç´¯ç§¯ç­‰ã€‚<br><strong>é¢„ä¼°å¹¶å‘ 3 ç”¨æˆ·æ˜¾å­˜éœ€æ±‚</strong>: ç²—ç•¥ä¼°è®¡ä¸ºæ¨¡å‹å‚æ•°æ˜¾å­˜å ç”¨çš„ 3 å€æˆ–æ›´é«˜ã€‚å› ä¸ºå¹¶å‘ç”¨æˆ·éœ€è¦æ¨¡å‹çš„å¤šä»½å‰¯æœ¬æˆ–å…±äº«æ¨¡å‹ä½†éœ€è¦é¢å¤–çš„ä¸Šä¸‹æ–‡ç¼“å­˜ç­‰ã€‚å®é™…æƒ…å†µå¯èƒ½æ›´å¤æ‚ã€‚</p>
<ol>
<li><strong>Unsloth å¯¹èµ„æºéœ€æ±‚çš„å½±å“</strong>:<ul>
<li><strong>ä¸­å°æ¨¡å‹ (Distill-Qwen-7B/14B/32B, Distill-Llama-8B) å’Œä¸­å°æ•°æ®é‡ (1K - 100G)</strong>: ä½¿ç”¨ Unsloth åº“è¿›è¡Œ LoRA å¾®è°ƒï¼Œå¯ä»¥æ˜¾è‘—é™ä½ GPU èµ„æºéœ€æ±‚ã€‚ä¾‹å¦‚ï¼ŒDistill-Qwen-7B åœ¨ 1K æ•°æ®é‡ä¸‹ï¼Œå•å¼  A10G 24G å³å¯å®Œæˆå¾®è°ƒï¼›å³ä½¿åœ¨ 100G æ•°æ®é‡ä¸‹ï¼Œä¹Ÿä»…éœ€ 8 å¼  A10G 24G GPUã€‚</li>
<li><strong>è¶…å¤§æ¨¡å‹ (DeepSeek-R1-671B) å’Œå¤§æ•°æ®é‡ (100G)</strong>: å¯¹äºè¿™äº›æç«¯æƒ…å†µï¼ŒUnsloth çš„ä¼˜åŒ–å¯èƒ½ä¸è¶³ä»¥å®Œå…¨è§£å†³æ˜¾å­˜ç“¶é¢ˆã€‚å› æ­¤ï¼Œè¡¨æ ¼ä¸­ä»ç„¶ä¿ç•™äº† ZeRO-3 ä¼˜åŒ–ï¼Œå¹¶ç»“åˆ Unsloth çš„ FlashAttention-2 ä¼˜åŒ–ï¼Œä»¥æœŸè¾¾åˆ°æœ€ä½³çš„æ€§èƒ½å’Œèµ„æºæ•ˆç‡ã€‚</li>
</ul>
</li>
<li><strong>LoRA å¾®è°ƒçš„ä¼˜åŠ¿</strong>:<ul>
<li>è¡¨æ ¼ä¸­æ‰€æœ‰åŸºäº Unsloth çš„é…ç½®æ–¹æ¡ˆéƒ½å‡è®¾ä½¿ç”¨ LoRA å¾®è°ƒã€‚LoRA æœ¬èº«å°±æ˜¯ä¸€ç§å‚æ•°é«˜æ•ˆå¾®è°ƒæ–¹æ³•ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘éœ€è¦è®­ç»ƒçš„å‚æ•°é‡ï¼Œä»è€Œé™ä½æ˜¾å­˜éœ€æ±‚å’ŒåŠ é€Ÿè®­ç»ƒã€‚</li>
<li>Unsloth è¿›ä¸€æ­¥ä¼˜åŒ–äº† LoRA çš„å®ç°ï¼Œä½¿å…¶åœ¨é€Ÿåº¦å’Œæ˜¾å­˜æ•ˆç‡æ–¹é¢æ›´å…·ä¼˜åŠ¿ã€‚</li>
</ul>
</li>
<li><strong>FlashAttention-2 çš„åŠ é€Ÿä½œç”¨</strong>:<ul>
<li>Unsloth é›†æˆçš„ FlashAttention-2 å¯ä»¥æ˜¾è‘—åŠ é€Ÿè®­ç»ƒè¿‡ç¨‹ï¼Œè¿™æœ‰åŠ©äºåœ¨ â€œæ—¥å†…å®Œæˆå¾®è°ƒâ€ çš„ç›®æ ‡ä¸‹ï¼Œä½¿ç”¨æ›´å°‘çš„ GPU èµ„æºã€‚</li>
</ul>
</li>
</ol>
<h2 id="å…³é”®åˆ†æé€»è¾‘"><a href="#å…³é”®åˆ†æé€»è¾‘" class="headerlink" title="å…³é”®åˆ†æé€»è¾‘"></a>å…³é”®åˆ†æé€»è¾‘</h2><ol>
<li>æ¨¡å‹å‚æ•°é‡ vs. GPU æ˜¾å­˜:<ul>
<li>å‚æ•°é«˜æ•ˆ<strong>å¾®è°ƒ (å¦‚ LoRA) æ˜¾è‘—é™ä½äº†æ˜¾å­˜éœ€æ±‚</strong>ï¼Œå…¬å¼ä¼°ç®—å¦‚ä¸‹ï¼š $$ \text{æ˜¾å­˜} \approx \text{æ¨¡å‹å‚æ•°} \times (2\ \text{bytes} \times \text{æ¿€æ´»ç³»æ•°}) + \text{ä¼˜åŒ–å™¨çŠ¶æ€} $$ å…¶ä¸­ï¼Œæ¿€æ´»ç³»æ•°åœ¨ LoRA åœºæ™¯ä¸‹çº¦ä¸º 0.1-0.3ï¼Œä¼˜åŒ–å™¨çŠ¶æ€é€šè¿‡ ZeRO-3 ç­‰æŠ€æœ¯å¯ä»¥å¤§å¹…å‡å°‘ã€‚</li>
</ul>
</li>
<li>æ•°æ®é‡ vs. è®­ç»ƒå¹¶è¡Œåº¦:<ul>
<li>å°æ•°æ®é‡ (1K, 1M): èµ„æºéœ€æ±‚ä¸»è¦ç”±æ¨¡å‹å¤§å°å†³å®šã€‚è¾ƒå°çš„ Distill æ¨¡å‹ç”šè‡³å¯ä»¥åœ¨å•å¼ æ¶ˆè´¹çº§ GPU ä¸Šå®Œæˆå¾®è°ƒã€‚</li>
<li>å¤§æ•°æ®é‡ (1G, 1T): æ•°æ®å¹¶è¡Œæˆä¸ºå…³é”®ã€‚éœ€è¦å¢åŠ  GPU æ•°é‡ä»¥æé«˜æ•°æ®ååé‡ï¼Œå¹¶é…åˆé«˜é€Ÿç½‘ç»œ (å¦‚ RDMA) ä¿è¯å¹¶è¡Œæ•ˆç‡ã€‚</li>
</ul>
</li>
<li>è®­ç»ƒæ—¶é•¿ä¸ç¡¬ä»¶èµ„æº:<ul>
<li>è¡¨æ ¼ä¸­çš„é…ç½®æ—¨åœ¨å°†å¾®è°ƒæ—¶é—´å‹ç¼©åˆ° <strong>ä¸€å¤©ä»¥å†…</strong>ã€‚æ›´å¿«çš„è®­ç»ƒé€Ÿåº¦é€šå¸¸éœ€è¦æ›´å¤šçš„ GPU èµ„æºå¹¶è¡Œè®¡ç®—ã€‚</li>
<li>å®é™…è®­ç»ƒæ—¶é—´è¿˜ä¼šå—åˆ° <strong>æ¨¡å‹ç»“æ„</strong>ã€<strong>è¶…å‚æ•°è®¾ç½®</strong>ã€<strong>ä¼˜åŒ–ç®—æ³•</strong> ç­‰å¤šç§å› ç´ å½±å“ã€‚ä¸Šè¿°è¡¨æ ¼æä¾›çš„æ˜¯ä¸€ä¸ª <strong>ç¡¬ä»¶é…ç½®å‚è€ƒ</strong>ï¼Œå®é™…éƒ¨ç½²æ—¶å¯èƒ½éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚</li>
</ul>
</li>
<li>ä¼˜åŒ–æŠ€æœ¯:<ul>
<li>æ··åˆç²¾åº¦è®­ç»ƒ (BF16/FP16): é™ä½æ˜¾å­˜å ç”¨å’Œè®¡ç®—å¤æ‚åº¦ï¼ŒåŠ é€Ÿè®­ç»ƒè¿‡ç¨‹ã€‚</li>
<li>æ¢¯åº¦æ£€æŸ¥ç‚¹: é€šè¿‡è®¡ç®—æ¢å–æ˜¾å­˜ï¼Œè¿›ä¸€æ­¥é™ä½æ˜¾å­˜å³°å€¼ã€‚</li>
<li>ZeRO-3: å°†ä¼˜åŒ–å™¨çŠ¶æ€ã€æ¢¯åº¦å’Œæ¨¡å‹å‚æ•°åˆ†ç‰‡åˆ°å¤šå¼  GPU ä¸Šï¼Œæå¤§åœ°å‡å°‘å•å¡æ˜¾å­˜éœ€æ±‚ï¼Œå°¤å…¶é€‚ç”¨äºè¶…å¤§æ¨¡å‹ (å¦‚ 671B)ã€‚</li>
<li>æ¨¡å‹å¹¶è¡Œ (Tensor Parallelism, TP): å°†æ¨¡å‹æŒ‰å±‚æˆ–å¼ é‡åˆ‡åˆ†åˆ°å¤šå¼  GPU ä¸Šï¼Œé™ä½å•å¡æ˜¾å­˜å‹åŠ›ï¼Œé€‚ç”¨äºè¶…å¤§æ¨¡å‹ã€‚</li>
<li>æ•°æ®å¹¶è¡Œ (Data Parallelism, DP): å°†æ•°æ®åˆ†ç‰‡åˆ°å¤šå¼  GPU ä¸Šï¼Œæ¯å¼  GPU è®­ç»ƒæ¨¡å‹å®Œæ•´å‰¯æœ¬çš„ä¸€éƒ¨åˆ†æ•°æ®ï¼Œæé«˜æ•°æ®ååé‡ï¼Œé€‚ç”¨äºå¤§æ•°æ®é‡è®­ç»ƒã€‚</li>
<li>æ¢¯åº¦ç´¯ç§¯: åœ¨æ˜¾å­˜å—é™æ—¶ï¼Œé€šè¿‡å¤šæ¬¡å°æ‰¹é‡æ¢¯åº¦è®¡ç®—ç´¯ç§¯æ¢¯åº¦ï¼Œæ¨¡æ‹Ÿå¤§æ‰¹é‡è®­ç»ƒçš„æ•ˆæœã€‚</li>
</ul>
</li>
<li>ç½‘ç»œä¸å­˜å‚¨:<ul>
<li><strong>RDMA ç½‘ç»œ</strong>: å¯¹äºå¤§è§„æ¨¡åˆ†å¸ƒå¼è®­ç»ƒ (å°¤å…¶æ˜¯æ¨¡å‹å¹¶è¡Œå’Œæ•°æ®å¹¶è¡Œç»“åˆ)ï¼ŒRDMA ç½‘ç»œå¯ä»¥æ˜¾è‘—é™ä½ GPU é—´é€šä¿¡å»¶è¿Ÿï¼Œæé«˜å¹¶è¡Œæ•ˆç‡ã€‚</li>
<li>é«˜é€Ÿ SSD/NVMe å­˜å‚¨: å¤§æ•°æ®é‡è®­ç»ƒæ—¶ï¼Œé«˜é€Ÿå­˜å‚¨å¯ä»¥åŠ é€Ÿæ•°æ®åŠ è½½ï¼Œé¿å… I/O ç“¶é¢ˆã€‚</li>
</ul>
</li>
</ol>
<p><strong>è¯·æ³¨æ„:</strong></p>
<ul>
<li>ä¸Šè¿°è¡¨æ ¼æä¾›çš„æ˜¯ <strong>ä¼°ç®—å’Œå»ºè®®</strong>ï¼Œå®é™…èµ„æºéœ€æ±‚å¯èƒ½å› å…·ä½“ä»»åŠ¡å’Œå®ç°ç»†èŠ‚æœ‰æ‰€ä¸åŒã€‚</li>
<li>åœ¨å®é™…éƒ¨ç½²æ—¶ï¼Œå»ºè®® <strong>ä»å°è§„æ¨¡é…ç½®å¼€å§‹æµ‹è¯•</strong>ï¼Œå¹¶æ ¹æ®è®­ç»ƒé€Ÿåº¦å’Œèµ„æºåˆ©ç”¨ç‡é€æ­¥è°ƒæ•´ç¡¬ä»¶é…ç½®ã€‚</li>
<li>äº‘æœåŠ¡å¹³å°é€šå¸¸æä¾›å¤šç§ GPU å®ä¾‹å’Œé«˜é€Ÿç½‘ç»œé…ç½®ï¼Œå¯ä»¥æ ¹æ®è¡¨æ ¼ä¸­çš„å»ºè®®é€‰æ‹©åˆé€‚çš„äº‘èµ„æºè¿›è¡Œæ¨¡å‹å¾®è°ƒã€‚</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2025/02/08/DeepSeek-R1%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/02/08/DeepSeek-R1%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/" class="post-title-link" itemprop="url">DeepSeek-R1çš„æ ¸å¿ƒæŠ€æœ¯</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-02-08 12:00:00 / Modified: 23:37:27" itemprop="dateCreated datePublished" datetime="2025-02-08T12:00:00+08:00">2025-02-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="DeepSeek-R1çš„å®æ–½æ­¥éª¤"><a href="#DeepSeek-R1çš„å®æ–½æ­¥éª¤" class="headerlink" title="DeepSeek-R1çš„å®æ–½æ­¥éª¤"></a>DeepSeek-R1çš„å®æ–½æ­¥éª¤</h2><p><a target="_blank" rel="noopener" href="https://huggingface.co/deepseek-ai/DeepSeek-R1">DeepSeek-R1</a>æœ¬èº«å°±æ˜¯å¼€æºçš„ï¼ŒHuggingFace <a target="_blank" rel="noopener" href="https://github.com/huggingface/open-r1">Open R1 é¡¹ç›®</a> ï¼Œ  <a target="_blank" rel="noopener" href="https://github.com/simplescaling/s1">æé£é£å›¢é˜Ÿs1é¡¹ç›®</a> ï¼Œ <a target="_blank" rel="noopener" href="https://github.com/hkust-nlp/simpleRL-reason">simpleRL-reason</a> åœ¨éƒ¨åˆ†å¤ç°DeepSeek R1ï¼Œè¿˜æœ‰ <a target="_blank" rel="noopener" href="https://github.com/Jiayi-Pan/TinyZero">TinyZero é¡¹ç›®</a>åœ¨å¤ç°DeepSeek R1-Zeroï¼Œåˆæ˜¯ä¸ºä½•ï¼Ÿ<br>æ ¹æ® DeepSeek-R1 çš„æŠ€æœ¯æŠ¥å‘Šï¼Œåˆ†3ä¸ªæ­¥éª¤å®Œæˆè¿™ä¸ªé¡¹ç›®ï¼š</p>
<ul>
<li>ç¬¬1æ­¥ï¼šç”¨ DeepSeek-R1 è’¸é¦é«˜è´¨é‡è¯­æ–™åº“ï¼Œæ¥å¤åˆ¶R1-Distillæ¨¡å‹ã€‚</li>
<li>ç¬¬2æ­¥ï¼šå¤åˆ¶ DeepSeek (V3) ç”¨æ¥æ„å»ºR1-Zeroçš„çº¯å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰pipelineã€‚è¿™å¯èƒ½æ¶‰åŠä¸ºæ•°å­¦ã€æ¨ç†å’Œä»£ç æ•´ç†æ–°çš„å¤§è§„æ¨¡æ•°æ®é›†ã€‚</li>
<li>ç¬¬3æ­¥ï¼šé€šè¿‡å¤šé˜¶æ®µè®­ç»ƒï¼Œä»åŸºç¡€æ¨¡å‹è¿‡æ¸¡åˆ°RLç‰ˆæœ¬ã€‚<br><img src="/2025/02/08/DeepSeek-R1%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/1.jpg"></li>
</ul>
<p>ç»“åˆDeepSeekçš„å®˜æ–¹æŠ€æœ¯æŠ¥å‘Šæ¥çœ‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒOpen R1é¡¹ç›®é¦–å…ˆè¦å®ç°çš„ï¼Œæ˜¯ç”¨R1æ•°æ®è’¸é¦å°æ¨¡å‹ï¼Œçœ‹çœ‹æ•ˆæœæ˜¯ä¸æ˜¯åƒDeepSeekè¯´çš„é‚£ä¹ˆå¥½ï¼š</p>
<h2 id="DeepSeek-R1çš„å®æ–½æ•ˆæœ"><a href="#DeepSeek-R1çš„å®æ–½æ•ˆæœ" class="headerlink" title="DeepSeek-R1çš„å®æ–½æ•ˆæœ"></a>DeepSeek-R1çš„å®æ–½æ•ˆæœ</h2><p>DeepSeekå¼€æºäº†6ä¸ªç”¨R1è’¸é¦çš„å°æ¨¡å‹ï¼Œå…¶ä¸­è’¸é¦ç‰ˆQwen-1.5ç”šè‡³èƒ½åœ¨éƒ¨åˆ†ä»»åŠ¡ä¸Šè¶…è¿‡GPT-4oã€‚<br><img src="/2025/02/08/DeepSeek-R1%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/2.jpg"><br>æ¥ä¸‹æ¥ï¼Œå°±æ˜¯æŒ‰ç…§DeepSeekæ‰€è¯´ï¼Œä¸ç”¨SFTï¼Œå•çº¯ä¾é RLè°ƒæ•™å‡ºR1-Zeroï¼Œåœ¨R1-Zeroçš„åŸºç¡€ä¸Šå¤åˆ»å‡ºæ€§èƒ½é€¼è¿‘o1çš„R1æ¨¡å‹ã€‚</p>
<p>å…¶ä¸­R1æŠ€æœ¯æŠ¥å‘Šè®²åˆ°ï¼ŒDeepSeek-R1è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å…¥äº†ä¸€ä¸ªå¤šé˜¶æ®µè®­ç»ƒæµç¨‹ï¼Œå…·ä½“åŒ…æ‹¬ä»¥ä¸‹4ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li>å†·å¯åŠ¨<br> ç”¨æ•°åƒä¸ªé•¿æ€ç»´é“¾ï¼ˆCoTï¼‰æ ·æœ¬å¯¹åŸºç¡€æ¨¡å‹è¿›è¡Œç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰ï¼Œä¸ºæ¨¡å‹æä¾›åˆå§‹çš„æ¨ç†èƒ½åŠ›ã€‚</li>
<li>é¢å‘æ¨ç†çš„å¼ºåŒ–å­¦ä¹ <br> åœ¨ç¬¬ä¸€ä¸ªSFTé˜¶æ®µçš„åŸºç¡€ä¹‹ä¸Šï¼Œç”¨å’Œè®­ç»ƒR1-Zeroç›¸åŒçš„å¤§è§„æ¨¡å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼Œè¿›ä¸€æ­¥æå‡æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ï¼Œç‰¹åˆ«æ˜¯åº”å¯¹ç¼–ç¨‹ã€æ•°å­¦ã€ç§‘å­¦å’Œé€»è¾‘æ¨ç†ä»»åŠ¡çš„èƒ½åŠ›ã€‚</li>
<li>æ‹’ç»é‡‡æ ·çš„ç›‘ç£å¾®è°ƒ<br> å†æ¬¡ä½¿ç”¨ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰ï¼Œæå‡æ¨¡å‹çš„éæ¨ç†èƒ½åŠ›ï¼Œå¦‚äº‹å®çŸ¥è¯†ã€å¯¹è¯èƒ½åŠ›ç­‰ã€‚</li>
<li>é’ˆå¯¹æ‰€æœ‰åœºæ™¯çš„å¼ºåŒ–å­¦ä¹ <br> è¿™æ¬¡å¼ºåŒ–å­¦ä¹ çš„é‡ç‚¹æ˜¯è®©æ¨¡å‹è¡Œä¸ºä¸äººç±»åå¥½ä¿æŒä¸€è‡´ï¼Œæå‡æ¨¡å‹çš„å¯ç”¨æ€§å’Œå®‰å…¨æ€§ã€‚<h2 id="Open-R1åšäº†ä»€ä¹ˆï¼Ÿ"><a href="#Open-R1åšäº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Open R1åšäº†ä»€ä¹ˆï¼Ÿ"></a>Open R1åšäº†ä»€ä¹ˆï¼Ÿ</h2>ç›®å‰ï¼Œåœ¨<a target="_blank" rel="noopener" href="https://github.com/huggingface/open-r1">open-r1 GitHubä»“åº“</a>ä¸­ï¼Œå·²ç»å¯ä»¥çœ‹åˆ°è¿™å‡ ä¸ªæ–‡ä»¶ï¼š</li>
</ol>
<ul>
<li><p>GRPOï¼ˆGrouped Relative Policy Optimizationï¼‰å®ç°ï¼Œ<code>grpo.py</code>: trains a model with GRPO on a given dataset.<br>  åœ¨ Open R1 å‘å¸ƒåï¼ŒGRPOå·²æ•´åˆè‡³TRLæœ€æ–°ç‰ˆæœ¬ï¼ˆ<a href="https://link.zhihu.com/?target=https://x.com/QGallouedec/status/1884978284686905468">v0.14</a>ï¼ŒJan 30, 2025ï¼‰ã€‚è¯¥æ•´åˆæ–¹æ¡ˆæ”¯æŒä½¿ç”¨å•ä¸ªæˆ–å¤šä¸ªå¥–åŠ±å‡½æ•°æ¨¡å‹è¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚GRPO å®ç°æ–¹æ¡ˆæ·±åº¦é›†æˆäº† DeepSpeed ZeRO 1/2/3 åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶ä»¥å®ç°å¤š GPU æ‰©å±•ï¼Œå¹¶é‡‡ç”¨ vLLM åŠ é€Ÿç”Ÿæˆè¿‡ç¨‹â€”â€”è¿™æ­£æ˜¯åœ¨çº¿è®­ç»ƒæ–¹æ³•çš„ä¸»è¦æ€§èƒ½ç“¶é¢ˆã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datasets <span class="keyword">import</span> load_dataset</span><br><span class="line"><span class="keyword">from</span> trl <span class="keyword">import</span> GRPOConfig, GRPOTrainer</span><br><span class="line"></span><br><span class="line">dataset = load_dataset(<span class="string">&quot;trl-lib/tldr&quot;</span>, split=<span class="string">&quot;train&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Dummy reward: rewards completions that are close to 20 characters</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reward_len</span>(<span class="params">completions, **kwargs</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [-<span class="built_in">abs</span>(<span class="number">20</span> - <span class="built_in">len</span>(completion)) <span class="keyword">for</span> completion <span class="keyword">in</span> completions]</span><br><span class="line"></span><br><span class="line">training_args = GRPOConfig(output_dir=<span class="string">&quot;Qwen2-0.5B-GRPO&quot;</span>, logging_steps=<span class="number">10</span>)</span><br><span class="line">trainer = GRPOTrainer(</span><br><span class="line">    model=<span class="string">&quot;Qwen/Qwen2-0.5B-Instruct&quot;</span>,</span><br><span class="line">    reward_funcs=reward_len,</span><br><span class="line">    args=training_args,</span><br><span class="line">    train_dataset=dataset,</span><br><span class="line">)</span><br><span class="line">trainer.train()</span><br><span class="line"><span class="comment"># (Feb 2nd)ä»å­˜åœ¨æ˜¾å­˜å ç”¨è¿‡é«˜çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ­£åœ¨é€šè¿‡æ€§èƒ½å‰–æè¿›è¡Œä¼˜åŒ–æ”¹è¿›ã€‚</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆæˆæ•°æ®ç”Ÿæˆå™¨ï¼Œ<code>generate.py</code>: generates synthetic data from a model usingÂ <a target="_blank" rel="noopener" href="https://github.com/argilla-io/distilabel">Distilabel</a>.<br>  R1 æŠ€æœ¯æŠ¥å‘Šä¸­æœ€å¼•äººæ³¨ç›®çš„å‘ç°ä¹‹ä¸€æ˜¯ï¼šä¸»æ¨¡å‹å¯ç”¨äºç”Ÿæˆåˆæˆæ¨ç†è½¨è¿¹ï¼Œè€ŒåŸºäºè¯¥æ•°æ®é›†å¾®è°ƒçš„è¾ƒå°æ¨¡å‹å¯è·å¾—ä¸ä¸»æ¨¡å‹ç›¸è¿‘çš„æ€§èƒ½æå‡ã€‚å› æ­¤Open R1è‡ªç„¶å¸Œæœ›å¤ç°è¯¥åˆæˆæ¨ç†æ•°æ®é›†ï¼Œä½¿ç¤¾åŒºèƒ½å¤Ÿåœ¨å…¶ä»–æ¨¡å‹ä¸Šè¿›è¡Œå¾®è°ƒå®éªŒã€‚<br>  é¢å¯¹ R1 è¿™ç±»è¶…å¤§æ¨¡å‹ï¼Œæ ¸å¿ƒæŒ‘æˆ˜åœ¨äºé«˜æ•ˆæ‰©å±•ç”Ÿæˆè§„æ¨¡ã€‚Open R1èŠ±è´¹ä¸€å‘¨æ—¶é—´å°è¯•äº†å¤šç§é…ç½®æ–¹æ¡ˆï¼šè¯¥æ¨¡å‹å¯éƒ¨ç½²åœ¨ 2 ä¸ª 8xH100 èŠ‚ç‚¹ï¼ˆ16 å— H100 GPUï¼‰ä¸Šï¼Œæˆ‘ä»¬æœ€åˆåŸºäºæ­¤é…ç½®ä½¿ç”¨ vLLM ä½œä¸ºæ¨ç†æœåŠ¡å™¨ã€‚ä½†å¾ˆå¿«å‘ç°è¯¥æ–¹æ¡ˆå­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼šç”±äº GPU çš„ KV ç¼“å­˜å¿«é€Ÿè€—å°½ï¼Œååé‡æœªè¾¾æœ€ä¼˜ä¸”ä»…æ”¯æŒ 8 è·¯å¹¶è¡Œè¯·æ±‚ã€‚å½“ç¼“å­˜è€—å°½æ—¶ï¼Œå ç”¨å¤§é‡ç¼“å­˜èµ„æºçš„è¯·æ±‚ä¼šè¢«æŠ¢å ï¼›è‹¥é…ç½®ä¸º<code>PreemptionMode.RECOMPUTE</code>æ¨¡å¼ï¼Œè¿™äº›è¯·æ±‚å°†åœ¨æ˜¾å­˜é‡Šæ”¾åé‡æ–°è°ƒåº¦ã€‚ä¸ºæ­¤æˆ‘ä»¬åˆ‡æ¢è‡³ 4x8xH100 èŠ‚ç‚¹é…ç½®ï¼ˆå…± 32 å— H100 GPUï¼‰ã€‚è¯¥æ–¹æ¡ˆä¸º 32 è·¯å¹¶è¡Œè¯·æ±‚æä¾›äº†å……è¶³çš„æ˜¾å­˜ä½™é‡ï¼ŒåŸºæœ¬é¿å…äº†å›  100% ç¼“å­˜å ç”¨å¯¼è‡´çš„è¯·æ±‚é‡æ–°è°ƒåº¦é—®é¢˜ã€‚åˆå§‹é˜¶æ®µæˆ‘ä»¬é‡‡ç”¨æ‰¹é‡è¯·æ±‚æŸ¥è¯¢ vLLM æœåŠ¡å™¨ï¼Œä½†å¾ˆå¿«å‘ç°æ‰¹æ¬¡ä¸­çš„é•¿å°¾æ ·æœ¬ä¼šå¯¼è‡´GPUåˆ©ç”¨ç‡æ³¢åŠ¨â€”â€”æ–°æ‰¹æ¬¡éœ€ç­‰å¾…å‰ä¸€æ‰¹æ¬¡æœ€åä¸€ä¸ªæ ·æœ¬å®Œæˆåæ‰èƒ½å¼€å§‹å¤„ç†ã€‚å°†æ‰¹é‡æ¨ç†åˆ‡æ¢ä¸ºæµå¼å¤„ç†åï¼ŒGPUåˆ©ç”¨ç‡æ˜¾è‘—ç¨³å®šã€‚<br><img src="/2025/02/08/DeepSeek-R1%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/3.jpg"></p>
<p>  è¯¥ä¼˜åŒ–ä»…éœ€ä¿®æ”¹vLLMæœåŠ¡å™¨çš„è¯·æ±‚å‘é€ä»£ç ã€‚æ‰¹é‡æ¨ç†ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># send requests in batches of 500</span></span><br><span class="line"><span class="keyword">for</span> batch <span class="keyword">in</span> batch_generator(dataset, bs=<span class="number">500</span>):</span><br><span class="line">    active_tasks = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> batch:</span><br><span class="line">        task = asyncio.create_task(send_requests(row))</span><br><span class="line">        active_tasks.add(task)</span><br><span class="line">    <span class="keyword">if</span> active_tasks:</span><br><span class="line">        <span class="keyword">await</span> asyncio.gather(*active_tasks)</span><br></pre></td></tr></table></figure>
<p>  æµå¼è¯·æ±‚çš„æ–°ç‰ˆä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">active_tasks = []</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> dataset:</span><br><span class="line">    <span class="comment"># keep the total active requests under 500</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(active_tasks) &gt;= <span class="number">500</span>:</span><br><span class="line">        done, active_tasks = <span class="keyword">await</span> asyncio.wait(</span><br><span class="line">            active_tasks,</span><br><span class="line">            return_when=asyncio.FIRST_COMPLETED</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    task = asyncio.create_task(send_requests(row))</span><br><span class="line">    active_tasks.add(task)</span><br><span class="line"></span><br><span class="line"><span class="comment"># wait for all remaining tasks to complete</span></span><br><span class="line"><span class="keyword">if</span> active_tasks:</span><br><span class="line">    <span class="keyword">await</span> asyncio.gather(*active_tasks)</span><br><span class="line">    <span class="comment"># Open R1å½“å‰çš„ç”Ÿæˆé€Ÿç‡å·²è¶‹äºç¨³å®šï¼Œä½†å¯¹äºé•¿æŸ¥è¯¢è¢«æŠ¢å æ—¶æ˜¯å¦é‡‡ç”¨CPU ç¼“å­˜ç­–ç•¥ä»éœ€è¿›ä¸€æ­¥æ¢ç´¢ã€‚</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å®æ–½ç›‘ç£å¾®è°ƒè®­ç»ƒä»£ç ï¼Œ<code>sft.py</code>: performs a simple SFT of a model on a dataset.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Train via <span class="built_in">command</span> line</span></span><br><span class="line">accelerate launch --config_file=recipes/accelerate_configs/zero3.yaml src/open_r1/sft.py \</span><br><span class="line">    --model_name_or_path Qwen/Qwen2.5-1.5B-Instruct \</span><br><span class="line">    --dataset_name HuggingFaceH4/Bespoke-Stratos-17k \</span><br><span class="line">    --learning_rate 2.0e-5 \</span><br><span class="line">    --num_train_epochs 1 \</span><br><span class="line">    --packing \</span><br><span class="line">    --max_seq_length 4096 \</span><br><span class="line">    --per_device_train_batch_size 2 \</span><br><span class="line">    --gradient_accumulation_steps 8 \</span><br><span class="line">    --gradient_checkpointing \</span><br><span class="line">    --bf16 \</span><br><span class="line">    --output_dir data/Qwen2.5-1.5B-Open-R1-Distill</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Train via YAML config</span></span><br><span class="line">accelerate launch --config_file recipes/accelerate_configs/zero3.yaml src/openr1/sft.py \</span><br><span class="line">    recipes/Qwen/Qwen2.5-1.5B-Instruct/sft/config_demo.yaml</span><br></pre></td></tr></table></figure></li>
<li><p>è®­ç»ƒå’Œè¯„ä¼°ä»£ç ï¼Œ<code>evaluate.py</code>: evaluates a model on the R1 benchmarks.</p>
</li>
</ul>
<h2 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h2><p>ç¤¾åŒºåœ¨å¤šä¸ªä¸R1ç›¸å…³çš„æ•°æ®é›†é¡¹ç›®ä¸Šéå¸¸æ´»è·ƒï¼Œä»¥ä¸‹æ˜¯ä¸€äº›äº®ç‚¹ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://huggingface.co/datasets/bespokelabs/Bespoke-Stratos-17k">bespokelabs/Bespoke-Stratos-17k</a>ï¼šè¿™æ˜¯å¯¹ Berkeley Sky-T1 æ•°æ®ç®¡çº¿çš„å¤åˆ¶ï¼Œä½¿ç”¨ DeepSeek-R1 åˆ›å»ºä¸€ä¸ªåŒ…å«é—®é¢˜ã€æ¨ç†è½¨è¿¹å’Œç­”æ¡ˆçš„æ•°æ®é›†ã€‚éšåï¼Œè¿™äº›æ•°æ®è¢«ç”¨äºé€šè¿‡ç±»ä¼¼äº R1 è®ºæ–‡ä¸­çš„è’¸é¦æ–¹æ³•ï¼Œå¾®è°ƒ 7B å’Œ 32B çš„ Qwen æ¨¡å‹ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://huggingface.co/datasets/open-thoughts/OpenThoughts-114k">open-thoughts/OpenThoughts-114k</a>ï¼šä¸€ä¸ªâ€œå¼€æ”¾çš„åˆæˆæ¨ç†æ•°æ®é›†ï¼ŒåŒ…å« 114k ä¸ªé«˜è´¨é‡æ ·æœ¬ï¼Œæ¶µç›–æ•°å­¦ã€ç§‘å­¦ã€ä»£ç å’Œè°œé¢˜â€ã€‚è¿™æ˜¯ Open Thoughts é¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://huggingface.co/datasets/cognitivecomputations/dolphin-r1">cognitivecomputations/dolphin-r1</a>ï¼šä¸€ä¸ªåŒ…å« 80 ä¸‡æ ·æœ¬çš„æ•°æ®é›†ï¼Œæ ·æœ¬æ¥è‡ª DeepSeek-R1ã€Gemini flash ä»¥åŠæ¥è‡ª DolphinChat çš„ 20 ä¸‡æ ·æœ¬ï¼Œç›®çš„æ˜¯å¸®åŠ©è®­ç»ƒ R1 é£æ ¼çš„æ¨¡å‹ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://huggingface.co/datasets/ServiceNow-AI/R1-Distill-SFT">ServiceNow-AI/R1-Distill-SFT</a>ï¼šç›®å‰æœ‰ 17,000 ä¸ªæ ·æœ¬ï¼Œè¿™æ˜¯ ServiceNow è¯­è¨€æ¨¡å‹å®éªŒå®¤ä¸ºæ”¯æŒ Open-R1 å·¥ä½œè€Œåˆ›å»ºçš„æ•°æ®é›†ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://huggingface.co/datasets/NovaSky-AI/Sky-T1_data_17k">NovaSky-AI/Sky-T1_data_17k</a>ï¼šç”¨äºè®­ç»ƒ Sky-T1-32B-Preview çš„ 17k è®­ç»ƒæ•°æ®ã€‚æœ€ç»ˆæ•°æ®åŒ…å«æ¥è‡ª APPs å’Œ TACO çš„ 5k ç¼–ç æ•°æ®ï¼Œä»¥åŠæ¥è‡ª NuminaMATH æ•°æ®é›†çš„ AIMEã€MATH å’Œ Olympiads å­é›†çš„ 10k æ•°å­¦æ•°æ®ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ç»´æŠ¤äº†æ¥è‡ª STILL-2 çš„ 1k ç§‘å­¦å’Œæ‹¼å›¾æ•°æ®ã€‚ä½¿ç”¨è¯¥æ•°æ®é›†è®­ç»ƒçš„æ¨¡å‹æˆæœ¬ä¸åˆ° 450 ç¾å…ƒã€‚</li>
<li><a target="_blank" rel="noopener" href="https://huggingface.co/datasets/Magpie-Align/Magpie-Reasoning-V2-250K-CoT-Deepseek-R1-Llama-70B">Magpie-Align/Magpie-Reasoning-V2-250K-CoT-Deepseek-R1-Llama-70B</a>ï¼šè¿™ä¸ªæ•°æ®é›†æ‰©å±•äº†Â <a target="_blank" rel="noopener" href="https://huggingface.co/papers/2406.08464">Magpie</a>Â å’Œæ–¹æ³•ï¼Œé€šè¿‡ç”Ÿæˆæ²¡æœ‰èµ·å§‹æç¤ºçš„æŒ‡ä»¤æ•°æ®æ¥åŒ…æ‹¬æ¨ç†è¿‡ç¨‹ã€‚æŒ‡ä»¤ç”± Llama 3.1 70B Instruct å’Œ Llama 3.3 70B Instruct ç”Ÿæˆï¼Œå“åº”åˆ™ç”± DeepSeek-R1-Distill-Llama-70B ç”Ÿæˆã€‚</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>SFTåï¼Œè¿›æ­¥æ˜¾è‘—ï¼Œæ€ä¹ˆåšåˆ°çš„ï¼Ÿ<br> ä¸€æ˜¯å¾®è°ƒç”¨çš„è®­ç»ƒæ•°æ®èµ·åˆ°äº†ä¸€å®šä½œç”¨ï¼›äºŒæ˜¯å¼ºåˆ¶è®©æ¨¡å‹å»¶é•¿æ€è€ƒæ—¶é—´ï¼ˆtest time scalingï¼‰ï¼Œå…·ä½“åšæ³•å«åšï¼ˆBudget Forcingï¼‰é¢„ç®—å¼ºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å¼ºåˆ¶é™åˆ¶æ¨¡å‹ä½¿ç”¨æœ€å¤§æˆ–æœ€å° tokens è¿›è¡Œæ¨ç†ï¼Œä»¥æ­¤æ§åˆ¶æ¨¡å‹çš„æ€è€ƒé•¿åº¦ã€‚<br> ä¸ºäº†å°½å¯èƒ½å»¶é•¿æ¨¡å‹çš„æ€è€ƒï¼Œä»–ä»¬å°†æ¨¡å‹çš„æ€è€ƒæ”¾åœ¨æ ‡ç­¾å†…ï¼Œå½“ç»“æŸåï¼Œä»¥ final answer ç»™å‡ºç­”æ¡ˆï¼ŒåŒæ—¶ï¼Œå½“ LLM å³å°†åœæ­¢æ€è€ƒæ—¶ï¼Œä¼šå¼ºåˆ¶è¾“å‡º Wait æ¥è¿«ä½¿æ¨¡å‹ç»§ç»­æ€è€ƒï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œæ¨¡å‹ä¼šè¿›å…¥åæ€ï¼Œå¹¶å¯èƒ½ä¼šå‘ç°è‡ªå·±çš„é”™è¯¯ã€‚<br> æ¨ç†æ—¶æ’å…¥çš„â€œWaitâ€ï¼Œä¹Ÿè®¸ä¼šåƒå½“åˆçš„ Step by Step ä¸€æ ·ï¼Œæˆä¸ºä¸€ä¸ªé­”æ³• tokenã€‚â€œè¿™æˆ–è®¸å°±æ˜¯å¤äººâ€˜ä¸‰æ€è€Œåè¡Œâ€™çš„å“²å­¦å§ï¼â€</li>
<li>R1 è®­ç»ƒçš„æ­¥éª¤æ€»ç»“ï¼š<br> 1ï¼‰ç²¾å¿ƒé€‰æ‹©è‹¥å¹²æ¡ï¼ˆå¦‚ 8000 æ¡ï¼‰é«˜è´¨é‡çš„æ•°æ®ï¼Œ<br> 2ï¼‰é€šè¿‡è®© Gemini/DeepSeek V3 è¡¥å……å®Œå–„æ€ç»´é“¾COTä¹‹åä½œä¸ºæ•°æ®é›†ï¼Œ<br> 3ï¼‰ä»¥å¼€æºçš„å¤§æ¨¡å‹ï¼ˆå¦‚ Qwen2.5-32Bï¼ŒLlama 3.1ï¼‰ä¸ºåŸºåº§å¾®è°ƒå‡ºç»“æœ(å¦‚ R1)ã€‚<br> 4ï¼‰æœ€åï¼Œåœ¨æ¨¡å‹è¾“å‡ºæ—¶ï¼Œç”¨ï¼ˆBudget Forcingï¼‰é¢„ç®—å¼ºåˆ¶æ–¹æ³•å¼ºè¡Œæ‹‰é•¿æ¨¡å‹çš„æ€è€ƒæ—¶é•¿å’Œè¾“å‡º tokenï¼Œç»“æœå‘ç°å…¶åœ¨ç‰¹å®šæµ‹è¯•é›†ä¸Šè¿›æ­¥æ˜¾è‘—ã€‚</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhuang-weiming.github.io/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/" class="post-title-link" itemprop="url">DeepSeekçš„æ ¸å¿ƒæŠ€æœ¯</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-02-07 11:36:00 / Modified: 11:37:06" itemprop="dateCreated datePublished" datetime="2025-02-07T11:36:00+08:00">2025-02-07</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ä¸€ã€å…³äºDeepSeekå…¬å¸åŠå…¶å¤§æ¨¡å‹"><a href="#ä¸€ã€å…³äºDeepSeekå…¬å¸åŠå…¶å¤§æ¨¡å‹" class="headerlink" title="ä¸€ã€å…³äºDeepSeekå…¬å¸åŠå…¶å¤§æ¨¡å‹"></a>ä¸€ã€å…³äºDeepSeekå…¬å¸åŠå…¶å¤§æ¨¡å‹</h2><h3 id="1-1-å…¬å¸æ¦‚å†µ"><a href="#1-1-å…¬å¸æ¦‚å†µ" class="headerlink" title="1.1 å…¬å¸æ¦‚å†µ"></a>1.1 å…¬å¸æ¦‚å†µ</h3><p>DeepSeek 2023å¹´7æœˆæˆç«‹äºæ­å·ï¼Œæ˜¯å¹»æ–¹é‡åŒ–æ——ä¸‹çš„å­å…¬å¸ï¼Œå…¨ç§°æ˜¯æ­å·æ·±åº¦æ±‚ç´¢äººå·¥æ™ºèƒ½åŸºç¡€æŠ€æœ¯ç ”ç©¶æœ‰é™å…¬å¸ã€‚â€æˆç«‹æ—¶é—´æ‰ä¸€å¹´å¤šâ€ã€â€æœ€è¿‘æ¨å‡ºçš„V3å·²ç»èƒ½å’ŒOpenAIçš„4oåª²ç¾â€ã€â€è®­ç»ƒæˆæœ¬ä¸åˆ°600Wç¾å…ƒâ€ã€â€APIå®šä»·ä»…æ˜¯å›½å†…å…¶ä»–å¤´éƒ¨å‚å•†å‡ ååˆ†ä¹‹ä¸€â€ã€â€APPå·²ç»åœ¨ä¸­ç¾APP storeç™»ä¸Šå…è´¹åº”ç”¨æ¦œé¦–â€ï¼›</p>
<p>ä»¥ä¸Šæ˜¯æœ€è¿‘å…³äºDeepSeekçš„ä¸€äº›æ–°é—»çƒ­ç‚¹ä¿¡æ¯ï¼Œä¸‹é¢æˆ‘ä»¬ä»å®˜ç½‘çœ‹ä¸‹ï¼š<br>DeepSeekè¿‘åŠå¹´ç›¸ç»§æ¨å‡ºäº†3ä¸ªä¸»è¦çš„å¤§æ¨¡å‹ç‰ˆæœ¬ï¼Œåˆ†åˆ«æ˜¯DeepSeek V2.5ã€DeepSeek V3ã€DeepSeek-R1ï¼ˆæ— ä¸€ä¾‹å¤–çš„éƒ½æ˜¯ç”¨äº†MOEæ¶æ„ï¼‰ã€‚åœ¨è¿™ä¹‹å‰è¿˜æ¨å‡ºäº†DeepSeek-VLã€DeepSeek Coderã€DeepSeek Mathã€‚<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/1.jpg"></p>
<h3 id="1-2-æ¨¡å‹èƒ½åŠ›"><a href="#1-2-æ¨¡å‹èƒ½åŠ›" class="headerlink" title="1.2 æ¨¡å‹èƒ½åŠ›"></a>1.2 æ¨¡å‹èƒ½åŠ›</h3><p>DeepSeekæ¨¡å‹å·²ç»å¯¹æ ‡å›½å†…Qwenã€æµ·å¤–Llamaã€GPT 4oï¼Œä»å…¬å¸ƒçš„æ¦œå•è¯„æµ‹ä¸Šçœ‹ï¼šDeepSeek-V3 åœ¨å¼€æºæ¨¡å‹ä¸­ä½åˆ—æ¦œé¦–ï¼Œä¸ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„é—­æºæ¨¡å‹ä¸åˆ†ä¼¯ä»²ã€‚<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/2.jpg"></p>
<p><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/3.jpg"></p>
<h3 id="1-3è®­æ¨æˆæœ¬"><a href="#1-3è®­æ¨æˆæœ¬" class="headerlink" title="1.3è®­æ¨æˆæœ¬"></a>1.3è®­æ¨æˆæœ¬</h3><p>æ¨ç†æˆæœ¬(APIæŠ¥ä»·)ï¼šç™¾ä¸‡Tokenè¾“å…¥ä»·æ ¼èƒ½è¾¾åˆ°1å…ƒã€‚<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/4.jpg"><br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/5.jpg"><br>è®­ç»ƒæˆæœ¬ï¼šä»æŠ€æœ¯æŠ¥å‘Šä¸­çœ‹DeepSeekç”¨çš„æ˜¯H800çš„GPUåšçš„è®­ç»ƒï¼Œè€Œä¸”åªæœ‰2åƒå¼ å·¦å³çš„H800ï¼Œæ•´ä¸ªV3çš„æ­£å¼è®­ç»ƒæˆæœ¬ä¸è¶…è¿‡600Wç¾å…ƒã€‚</p>
<blockquote>
<p>1ã€é¢„è®­ç»ƒé˜¶æ®µï¼Œæ¯ä¸‡äº¿çš„Token è®­ç»ƒV3ä½¿ç”¨ 2048 ä¸ªH800GPUé›†ç¾¤ï¼Œåªéœ€è¦ 180K ä¸ªH800 GPUå°æ—¶ï¼Œå¤§æ¦‚ 3.7 å¤©(180000/2048/24)<br>2ã€æ•´ä¸ªé¢„è®­ç»ƒæ€»è€—æ—¶ 2664K GPUå°æ—¶ï¼ˆä¸åˆ°2ä¸ªæœˆï¼‰ï¼ŒåŠ ä¸Š ä¸Šä¸‹æ–‡æ‰©å±•å’Œåè®­ç»ƒï¼Œæ€»è€—æ—¶å¤§æ¦‚2788KGPUè€—æ—¶ã€‚<br>3ã€æŒ‰ç…§ H800 æ¯å°æ—¶2ç¾å…ƒç§Ÿèµï¼Œæ€»çš„è®­ç»ƒæˆæœ¬ä¸è¶…è¿‡600Wç¾å…ƒ<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/6.jpg"></p>
</blockquote>
<p>è¿™ä¹ˆä½çš„æ¨ç†å’Œè®­ç»ƒæˆæœ¬ä¸ç”±å¼•å‡ºä»¥ä¸‹çš„é—®é¢˜ï¼š</p>
<ul>
<li>æ¨¡å‹é‡‡ç”¨äº†ä»€ä¹ˆæ ·çš„ç½‘ç»œæ¶æ„ï¼Ÿ</li>
<li>è®­ç»ƒçš„ç²¾åº¦ã€æ¡†æ¶å’Œå¹¶è¡Œç­–ç•¥æ˜¯æ€æ ·çš„ï¼Ÿ</li>
<li>æ¨¡å‹çš„éƒ¨ç½²å’Œä¼˜åŒ–æ–¹æ¡ˆæ˜¯æ€æ ·çš„ï¼Ÿ</li>
<li>åœ¨ç¡¬ä»¶å±‚çš„è®¡ç®—å’Œé€šä¿¡ä¸Šåšäº†ä»€ä¹ˆä¼˜åŒ–ï¼Ÿ</li>
</ul>
<h2 id="äºŒã€DeepSeekè®­æ¨æ ¸å¿ƒæŠ€æœ¯"><a href="#äºŒã€DeepSeekè®­æ¨æ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="äºŒã€DeepSeekè®­æ¨æ ¸å¿ƒæŠ€æœ¯"></a>äºŒã€DeepSeekè®­æ¨æ ¸å¿ƒæŠ€æœ¯</h2><h3 id="2-1-DeepSeek-V3æ¨¡å‹ç½‘ç»œæ¶æ„"><a href="#2-1-DeepSeek-V3æ¨¡å‹ç½‘ç»œæ¶æ„" class="headerlink" title="2.1 DeepSeek-V3æ¨¡å‹ç½‘ç»œæ¶æ„"></a>2.1 DeepSeek-V3æ¨¡å‹ç½‘ç»œæ¶æ„</h3><p><strong>1) DeepSeekV3 æ•´ä½“é¢„è®­ç»ƒç”¨äº†14.8ä¸‡äº¿çš„é«˜è´¨é‡Tokenï¼Œ2) å¹¶ä¸”åœ¨åæœŸåšäº†SFTå’ŒRLï¼Œæ¨¡å‹å‚æ•°é‡è¾¾åˆ° 671Bï¼Œä½†æ˜¯æ¯ä¸ªTokenä»…æ¿€æ´»37Bå‚æ•°ã€‚ä¸ºäº†åšåˆ°é«˜æ•ˆçš„æ¨ç†å’Œè®­ç»ƒï¼Œ3) DeepSeekV3è‡ªç ”äº†MLAæ³¨æ„åŠ›æœºåˆ¶å’Œæ— è¾…åŠ©æŸå¤±è´Ÿè½½å‡è¡¡ç­–ç•¥çš„MoEæ¶æ„ã€‚</strong></p>
<p>ä»æŠ€æœ¯æŠ¥å‘Šä¸­çœ‹å‡ºï¼Œæ˜¯ç»å…¸çš„Transformeræ¶æ„ï¼Œæ¯”è¾ƒäº®çœ¼çš„å°±æ˜¯å‰é¦ˆç½‘ç»œä½¿ç”¨çš„DeepSeekMoEæ¶æ„ã€Attentionæœºåˆ¶ä½¿ç”¨MLAæ¶æ„ï¼Œå…¶å®è¿™ä¸¤ä¸ªåœ¨DeepSeekV2æ¨¡å‹å·²ç»è¢«éªŒè¯ä½¿ç”¨è¿‡ã€‚<br>ä¸DeepSeek-V2ç›¸æ¯”ï¼ŒV3é¢å¤–å¼•å…¥äº†ä¸€ç§<strong>æ— è¾…åŠ©æŸå¤±çš„è´Ÿè½½å‡è¡¡ç­–ç•¥</strong>ï¼Œç”¨äºDeepSeekMoEï¼Œä»¥å‡è½»å› éœ€è¦ä¿è¯Expertè´Ÿè½½å‡è¡¡è€Œå¯¼è‡´çš„æ€§èƒ½ä¸‹é™ã€‚<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/7.jpg"></p>
<h4 id="2-1-1-DeepSeekMoE"><a href="#2-1-1-DeepSeekMoE" class="headerlink" title="2.1.1 DeepSeekMoE"></a>2.1.1 DeepSeekMoE</h4><p>ç¬¬ä¸€ä¸ªå°†MoEæ¶æ„å¼•å…¥Transformerç½‘ç»œçš„å°±æ˜¯GShardæ¶æ„äº†ï¼Œä¸ä¼ ç»Ÿå¤§æ¨¡å‹æ¶æ„ç›¸æ¯”ï¼ŒMoEæ¶æ„åœ¨æ•°æ®æµè½¬è¿‡ç¨‹ä¸­é›†æˆäº†ä¸€ä¸ªä¸“å®¶ç½‘ç»œå±‚ã€‚<br>å¯ä»¥çœ‹å‡ºä¼ ç»Ÿçš„MoEåŸºæœ¬ä¸¤éƒ¨åˆ†ç»„æˆï¼šGatingé—¨æ§ç½‘ç»œã€ç¨€ç–MoEå±‚ï¼›</p>
<blockquote>
<ul>
<li>ç¨€ç– MoE å±‚: è¿™äº›å±‚ä»£æ›¿äº†ä¼ ç»Ÿ Transformer æ¨¡å‹ä¸­çš„å‰é¦ˆç½‘ç»œ (FFN) å±‚ã€‚MoE å±‚åŒ…å«è‹¥å¹²â€œä¸“å®¶â€(ä¾‹å¦‚ 8 ä¸ª)ï¼Œæ¯ä¸ªä¸“å®¶æœ¬èº«æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç¥ç»ç½‘ç»œã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™äº›ä¸“å®¶é€šå¸¸æ˜¯å‰é¦ˆç½‘ç»œ (FFN)ï¼Œä½†å®ƒä»¬ä¹Ÿå¯ä»¥æ˜¯æ›´å¤æ‚çš„ç½‘ç»œç»“æ„ï¼Œç”šè‡³å¯ä»¥æ˜¯ MoE å±‚æœ¬èº«ï¼Œä»è€Œå½¢æˆå±‚çº§å¼çš„ MoE ç»“æ„ã€‚</li>
<li>é—¨æ§ç½‘ç»œæˆ–è·¯ç”±: è¿™ä¸ªéƒ¨åˆ†ç”¨äºå†³å®šå“ªäº›Tokenè¢«å‘é€åˆ°å“ªä¸ªä¸“å®¶ã€‚Tokençš„è·¯ç”±æ–¹å¼æ˜¯ MoE ä½¿ç”¨ä¸­çš„ä¸€ä¸ªå…³é”®ç‚¹ï¼Œå› ä¸ºè·¯ç”±å™¨ç”±å­¦ä¹ çš„å‚æ•°ç»„æˆï¼Œå¹¶ä¸”ä¸ç½‘ç»œçš„å…¶ä»–éƒ¨åˆ†ä¸€åŒè¿›è¡Œé¢„è®­ç»ƒã€‚</li>
</ul>
</blockquote>
<p><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/8.jpg"><br>å’Œä¼ ç»Ÿçš„MoEæ¶æ„ç›¸æ¯”ï¼Œ<strong>DeepSeekMoEä½¿ç”¨æ›´ç»†ç²’åº¦çš„ä¸“å®¶ï¼Œå¹¶å°†ä¸€äº›ä¸“å®¶éš”ç¦»ä¸ºå…±äº«ä¸“å®¶ï¼Œå‡å°‘ä¸“å®¶é—´çš„çŸ¥è¯†å†—ä½™</strong>ã€‚<br>ï»¿<img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/9.jpg"></p>
<p><strong>é—¨æ§ç½‘ç»œè·¯ç”±ç­–ç•¥</strong>ï¼šTopKè¡¨ç¤ºç¬¬tä¸ªTokenå’Œæ‰€æœ‰è·¯ç”±ä¸“å®¶è®¡ç®—å‡ºçš„äº²å’ŒåŠ›åˆ†æ•°ä¸­Kä¸ªæœ€é«˜åˆ†æ•°çš„é›†åˆï¼Œåœ¨DeepSeekV3ä¸­ï¼Œä½¿ç”¨sigmoidå‡½æ•°è®¡ç®—äº²å’ŒåŠ›åˆ†æ•°ï¼Œç„¶ååœ¨æ‰€æœ‰é€‰æ‹©çš„äº²å’ŒåŠ›åˆ†æ•°ä¸­åº”ç”¨å½’ä¸€åŒ–æ¥ç”Ÿæˆé—¨æ§å€¼ã€‚ï»¿<br>é€šå¸¸åœ¨MoEæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¸åŒä¸“å®¶å› ä¸ºè·¯ç”±ç­–ç•¥çš„å› ç´ ä¼šå¯¼è‡´æ¥æ”¶çš„è®­ç»ƒæ•°æ®åˆ†å¸ƒä¸å‡ï¼Œæ¯”å¦‚æ‰€æœ‰çš„Tokenéƒ½è¢«å‘é€åˆ°åªæœ‰å°‘æ•°å‡ ä¸ªå—æ¬¢è¿çš„ä¸“å®¶ï¼Œé‚£ä¹ˆæœ‰äº›ä¸“å®¶å°±å¯èƒ½æ²¡æœ‰è¢«è®­ç»ƒåˆ°ã€‚<br>ä¸šç•Œé€šç”¨çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯å¼•å…¥è¾…åŠ©æŸå¤±ï¼Œä½†æ˜¯ï¼Œæœ‰æ—¶å€™è¿‡å¤§çš„è¾…åŠ©æŸå¤±ä¼šæŸå®³æ¨¡å‹æ€§èƒ½ã€‚<br>ä¸ºäº†åœ¨è´Ÿè½½å‡è¡¡å’Œæ¨¡å‹æ€§èƒ½ä¹‹é—´å–å¾—æ›´å¥½çš„å¹³è¡¡ï¼ŒDeepSeekå¼€åˆ›äº†ä¸€ç§<strong>æ— è¾…åŠ©æŸå¤±çš„è´Ÿè½½å‡è¡¡ç­–ç•¥</strong>ï¼šä¸ºæ¯ä¸ªä¸“å®¶å¼•å…¥ä¸€ä¸ªåå·®é¡¹ biï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ç›¸åº”çš„äº²å’ŒåŠ›åˆ†æ•° Si,t ä¸­ä»¥ç¡®å®štop-Kè·¯ç”±ï¼Œå…·ä½“æ¥è¯´ï¼šå¦‚æœå…¶å¯¹åº”çš„ä¸“å®¶è¿‡è½½ï¼Œæˆ‘ä»¬å°†åå·®é¡¹å‡å°‘Î³ï¼›å¦‚æœå…¶å¯¹åº”çš„ä¸“å®¶è´Ÿè½½ä¸è¶³ï¼Œæˆ‘ä»¬å°†åå·®é¡¹å¢åŠ Î³ï¼Œå…¶ä¸­Î³æ˜¯ä¸€ä¸ªç§°ä¸ºåå·®æ›´æ–°é€Ÿåº¦çš„è¶…å‚æ•°ã€‚</p>
<blockquote>
<p>é—¨æ§ç½‘ç»œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªsoftmaxå åŠ ä¸€ä¸ªåˆ†ç±»ç½‘ç»œï¼Œé‚£ä¹ˆè¾…åŠ©losså¾€å¾€å°±æ˜¯æ·»åŠ ä¸€ä¸ªæƒ©ç½šé¡¹ï¼Œå¯¹è¾“å‡ºè¿‡å¤§çš„ logits è¿›è¡Œæƒ©ç½šï¼Œé¼“åŠ±æ¨¡å‹ç”Ÿæˆæ›´åŠ é€‚åº¦çš„ logits å€¼ï¼Œé˜²æ­¢æ¨¡å‹ç”Ÿæˆè¿‡äºæç«¯çš„è¾“å‡ºã€‚</p>
</blockquote>
<h4 id="2-1-2-MLA-å¤šå¤´æ½œåœ¨æ³¨æ„åŠ›"><a href="#2-1-2-MLA-å¤šå¤´æ½œåœ¨æ³¨æ„åŠ›" class="headerlink" title="2.1.2 MLA å¤šå¤´æ½œåœ¨æ³¨æ„åŠ›"></a>2.1.2 MLA å¤šå¤´æ½œåœ¨æ³¨æ„åŠ›</h4><p>ï»¿å¤§æ¨¡å‹æ¨ç†è¿‡ç¨‹KV Cacheæœºåˆ¶ä¸€èˆ¬æ˜¯é™åˆ¶æ¨ç†æ•ˆç‡çš„ä¸€å¤§ç“¶é¢ˆï¼Œè€Œæ ‡å‡†çš„Transformer æ¶æ„é‡Œé¢çš„MHAæ¶æ„ä¼šäº§å‡ºéå¸¸å¤šçš„KV Cacheï¼Œä¸ºäº†å‡å°‘å¯¹åº”çš„KV Cacheä¸šç•Œå®è·µè¿‡å¾ˆå¤šæ–¹æ¡ˆï¼Œä¾‹å¦‚PagedAttentionã€å¤šæŸ¥è¯¢æ³¨æ„åŠ›ï¼ˆMQAï¼‰å’Œåˆ†ç»„æŸ¥è¯¢æ³¨æ„åŠ›ï¼ˆGQAï¼‰ï¼Œä½†æ˜¯æ€§èƒ½ç›¸æ¯”åŸç”Ÿçš„MHAæœ‰ä¸€å®šå·®è·ã€‚ï»¿<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/10.jpg"><br>DeepSeek-V2ï¼Œæå‡ºä¸€ç§åˆ›æ–°çš„æ³¨æ„åŠ›æœºåˆ¶ï¼šå¤šå¤´æ½œåœ¨æ³¨æ„åŠ›ï¼ˆMLAï¼‰ã€‚<br>ç›¸æ¯”MQAçš„KVå…±ç”¨å’ŒGQAçš„KVåˆ†ç»„ï¼Œ<strong>MLAçš„æ ¸å¿ƒæ˜¯æ³¨æ„åŠ›é”®å’Œå€¼çš„ä½ç§©è”åˆå‹ç¼©ï¼Œä»¥å‡å°‘æ¨ç†è¿‡ç¨‹ä¸­çš„é”®å€¼(KV)ç¼“å­˜</strong>ã€‚ç›¸æ¯”MHAå…·æœ‰æ›´å¥½çš„æ€§èƒ½ï¼Œä½†éœ€è¦çš„ KV ç¼“å­˜é‡è¦å°‘å¾—å¤šã€‚ï»¿<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/11.jpg"></p>
<blockquote>
<p>ä½ç§©çŸ©é˜µæ˜¯æŒ‡å…¶ç§©ï¼ˆrankï¼‰è¿œå°äºå…¶è¡Œæ•°å’Œåˆ—æ•°çš„çŸ©é˜µã€‚<br>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªçŸ©é˜µï¼Œå…¶å®é™…ç»“æ„å…è®¸å®ƒè¢«åˆ†è§£ä¸ºä¸¤ä¸ªè¾ƒå°çš„çŸ©é˜µçš„ä¹˜ç§¯ã€‚è¿™ç§æƒ…å†µé€šå¸¸æ„å‘³ç€åŸçŸ©é˜µæ˜¯ä½ç§©çš„ã€‚<br>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>4Ã—5</code>çš„çŸ©é˜µ<code>A</code>ï¼Œè¿™ä¸ªçŸ©é˜µå¯ä»¥é€šè¿‡ä¸¤ä¸ªæ›´å°çš„çŸ©é˜µçš„ä¹˜ç§¯æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚ä¸€ä¸ª<code>4Ã—2</code>çš„çŸ©é˜µ<code>B</code>å’Œä¸€ä¸ª<code>2Ã—5</code>çš„çŸ©é˜µ<code>C</code>ã€‚è¿™æ„å‘³ç€åŸå§‹çŸ©é˜µ<code>A</code>çš„ä¿¡æ¯å¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªè¾ƒå°çš„çŸ©é˜µæ¥æ•æ‰ï¼Œè¡¨æ˜<code>A</code>æ˜¯ä¸€ä¸ªä½ç§©çŸ©é˜µã€‚</p>
</blockquote>
<p>ä½ç§©å‹ç¼©è®¡ç®—æ ¸å¿ƒè¿‡ç¨‹ï¼š<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/12.jpg"><br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/13.jpg"><br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/14.jpg"><br>è¿™é‡Œçš„ ht è¡¨ç¤ºç¬¬ t ä¸ªTokençš„è¾“å…¥ï¼ŒWDKV è¡¨ç¤ºKVçš„å‘ä¸‹æŠ•å½±çŸ©é˜µï¼Œå°† ht åšé™ç»´å‹ç¼©è¡¨ç¤ºï¼Œå®é™…å¾—åˆ° cKVt å°±æ˜¯è¦ç¼“å­˜çš„KVå‹ç¼©éšå‘é‡ï¼›WUKå’ŒWUVæ˜¯å‘ä¸Šåšå‡ç»´çš„æŠ•å½±çŸ©é˜µï¼Œå°†Tokençš„å‹ç¼©éšå‘é‡cKVtå¤åŸä¸ºåŸå§‹KVçŸ©é˜µï¼›<br>MLA æ¨¡å—æ¶æ„å›¾å¦‚ä¸‹ï¼š<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/15.jpg"></p>
<h3 id="2-2-è®­ç»ƒæ¨ç†æ ¸å¿ƒæŠ€æœ¯"><a href="#2-2-è®­ç»ƒæ¨ç†æ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="2.2Â è®­ç»ƒæ¨ç†æ ¸å¿ƒæŠ€æœ¯"></a>2.2Â è®­ç»ƒæ¨ç†æ ¸å¿ƒæŠ€æœ¯</h3><p><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/16.jpg"></p>
<h4 id="2-2-1-è®­ç»ƒæ¡†æ¶HAI-LLM"><a href="#2-2-1-è®­ç»ƒæ¡†æ¶HAI-LLM" class="headerlink" title="2.2.1 è®­ç»ƒæ¡†æ¶HAI-LLMï»¿"></a>2.2.1 è®­ç»ƒæ¡†æ¶HAI-LLMï»¿</h4><p>DeepSeek-V3åœ¨ä¸€ä¸ªé…å¤‡äº†2048ä¸ªNVIDIA H800 GPUçš„é›†ç¾¤ä¸Šè¿›è¡Œè®­ç»ƒï¼Œä½¿ç”¨çš„æ˜¯è‡ªç ”çš„HAI-LLMæ¡†æ¶ï¼Œæ¡†æ¶å®ç°äº†å››ç§å¹¶è¡Œè®­ç»ƒæ–¹å¼ï¼š<strong>ZeRO æ”¯æŒçš„æ•°æ®å¹¶è¡Œã€æµæ°´çº¿å¹¶è¡Œã€å¼ é‡åˆ‡ç‰‡æ¨¡å‹å¹¶è¡Œå’Œåºåˆ—å¹¶è¡Œ</strong>ã€‚ Â <br>è¿™ç§å¹¶è¡Œèƒ½åŠ›æ”¯æŒä¸åŒå·¥ä½œè´Ÿè½½çš„éœ€æ±‚ï¼Œå¯ä»¥æ”¯æŒæ•°ä¸‡äº¿è§„æ¨¡çš„è¶…å¤§æ¨¡å‹å¹¶æ‰©å±•åˆ°æ•°åƒä¸ª GPUï¼ŒåŒæ—¶è¿˜è‡ªç ”äº†ä¸€äº›é…å¥—çš„é«˜æ€§èƒ½ç®—å­haiscaleï¼Œå¯ä»¥å¸®åŠ© HAI-LLM æå¤§ä¼˜åŒ–å¤§æ¨¡å‹è®­ç»ƒçš„æ˜¾å­˜æ•ˆç‡å’Œè®¡ç®—æ•ˆç‡ã€‚</p>
<h4 id="2-2-2-æ ¸å¿ƒç®—æ³•DualPipe-åˆ›æ–°æµæ°´çº¿å¹¶è¡Œç®—æ³•"><a href="#2-2-2-æ ¸å¿ƒç®—æ³•DualPipe-åˆ›æ–°æµæ°´çº¿å¹¶è¡Œç®—æ³•" class="headerlink" title="2.2.2 æ ¸å¿ƒç®—æ³•DualPipe-åˆ›æ–°æµæ°´çº¿å¹¶è¡Œç®—æ³•"></a>2.2.2 æ ¸å¿ƒç®—æ³•DualPipe-åˆ›æ–°æµæ°´çº¿å¹¶è¡Œç®—æ³•</h4><p>i.é€šä¿¡è®¡ç®—é‡å ä¼˜åŒ–<br>DeepSeek-V3åº”ç”¨äº†16è·¯æµæ°´çº¿å¹¶è¡Œï¼ˆPPï¼‰ï¼Œè·¨è¶Š8ä¸ªèŠ‚ç‚¹çš„64è·¯ä¸“å®¶å¹¶è¡Œï¼ˆEPï¼‰ï¼Œä»¥åŠZeRO-1æ•°æ®å¹¶è¡Œï¼ˆDPï¼‰ã€‚<br>ä¸ç°æœ‰çš„æµæ°´çº¿å¹¶è¡Œæ–¹æ³•ç›¸æ¯”ï¼Œ<strong>DualPipeçš„æµæ°´çº¿æ°”æ³¡æ›´å°‘</strong>ã€‚åŒæ—¶<strong>é‡å äº†å‰å‘å’Œåå‘è¿‡ç¨‹ä¸­çš„è®¡ç®—å’Œé€šä¿¡é˜¶æ®µï¼Œè§£å†³äº†è·¨èŠ‚ç‚¹ä¸“å®¶å¹¶è¡Œå¼•å…¥çš„æ²‰é‡é€šä¿¡å¼€é”€çš„æŒ‘æˆ˜</strong>ã€‚<br>DualPipeçš„å…³é”®æ€æƒ³æ˜¯<strong>é‡å ä¸€å¯¹å•ç‹¬çš„å‰å‘å’Œåå‘å—ä¸­çš„è®¡ç®—å’Œé€šä¿¡</strong>ï¼šå°†æ¯ä¸ªå—åˆ’åˆ†ä¸ºå››ä¸ªç»„ä»¶ï¼šæ³¨æ„åŠ›ã€all-allè°ƒåº¦ã€MLPå’Œall-allç»„åˆ</p>
<blockquote>
<p>ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªè®¡ç®—å—ï¼ŒAå’ŒBï¼š<br>1.åœ¨å—Aè¿›è¡Œå‰å‘ä¼ æ’­è®¡ç®—æ—¶ï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œå—Bçš„åå‘ä¼ æ’­é€šä¿¡è¿‡ç¨‹ã€‚<br>2.å½“å—Aå®Œæˆå‰å‘ä¼ æ’­è®¡ç®—åï¼Œå¼€å§‹å®ƒçš„é€šä¿¡è¿‡ç¨‹ï¼›è€Œå—Båˆ™å¼€å§‹å®ƒçš„å‰å‘ä¼ æ’­è®¡ç®—ã€‚</p>
</blockquote>
<p><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/17.jpg"><br>é€šè¿‡ä¼˜åŒ–æ’åˆ—è¿™äº›åŠŸèƒ½æ¨¡å—ï¼Œå¹¶ç²¾ç¡®è°ƒæ§ç”¨äºé€šä¿¡å’Œè®¡ç®—çš„ GPU SMèµ„æºåˆ†é…æ¯”ä¾‹ï¼Œç³»ç»Ÿèƒ½å¤Ÿåœ¨è¿è¡Œè¿‡ç¨‹ä¸­æœ‰æ•ˆéšè—å…¨èŠ‚ç‚¹é€šä¿¡å’Œ PP é€šä¿¡å¼€é”€ã€‚<br>å¯ä»¥çœ‹å‡ºDeepSeekåœ¨PPè¿™å—ï¼Œåšäº†å¤§é‡çš„é€šä¿¡è®¡ç®—é‡å ä¼˜åŒ–ï¼Œä»æŠ€æœ¯æŠ¥å‘Šä¸­çœ‹å‡ºï¼Œå³ä½¿æ˜¯ç»†ç²’åº¦çš„all-allä¸“å®¶é€šä¿¡ï¼Œall-allçš„é€šä¿¡å¼€é”€å‡ ä¹ä¸º0ã€‚<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/18.jpg">
ï»¿</p>
<blockquote>
<ul>
<li>è®¡ç®—é€šä¿¡é‡å <br>åœ¨æ·±åº¦å­¦ä¹ å¤§è§„æ¨¡åˆ†å¸ƒå¼è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé€šä¿¡çš„é€Ÿåº¦å¾€å¾€è½åäºè®¡ç®—çš„é€Ÿåº¦ï¼Œå¦‚ä½•åœ¨é€šä¿¡çš„gapæœŸé—´å†…å¹¶è¡Œåšä¸€äº›è®¡ç®—å°±æ˜¯é«˜æ€§èƒ½è®¡ç®—å’Œé€šä¿¡é‡å ï¼Œæ˜¯å®ç°é«˜æ•ˆè®­ç»ƒçš„å…³é”®å› ç´ ã€‚</li>
<li>æµæ°´çº¿å¹¶è¡Œæ°”æ³¡é—®é¢˜<br>ä¸€äº›å¤§çš„æ¨¡å‹ä¼šé‡‡ç”¨æµæ°´çº¿å¹¶è¡Œç­–ç•¥ï¼Œå°†æ¨¡å‹çš„ä¸åŒå±‚æ”¾åœ¨ä¸åŒçš„GPUä¸Šï¼Œä½†æ˜¯ä¸åŒå±‚ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œåé¢å±‚éœ€è¦ç­‰å‰é¢çš„è®¡ç®—å®Œæ‰èƒ½å¼€å§‹è®¡ç®—ï¼Œä¼šå¯¼è‡´GPUåœ¨ä¸€æ®µæ—¶é—´æ˜¯é—²ç½®çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/19.jpg"></li>
</ul>
</blockquote>
<p>ii.è·¨èŠ‚ç‚¹å…¨å¯¹å…¨é€šä¿¡<br>DeepSeekè¿˜ä¸“é—¨å®šåˆ¶äº†é«˜æ•ˆçš„è·¨èŠ‚ç‚¹all-allé€šä¿¡å†…æ ¸(åŒ…æ‹¬è°ƒåº¦å’Œç»„åˆ)ã€‚<br>å…·ä½“æ¥è¯´ï¼šè·¨èŠ‚ç‚¹ GPU é€šè¿‡ IB å®Œå…¨äº’è¿ï¼ŒèŠ‚ç‚¹å†…é€šä¿¡é€šè¿‡ NVLink å¤„ç†ï¼Œæ¯ä¸ªTokenæœ€å¤šè°ƒåº¦åˆ° 4ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œå‡å°‘ IB é€šä¿¡é‡ã€‚åŒæ—¶<strong>ä½¿ç”¨warpä¸“ä¸šåŒ–æŠ€æœ¯åšè°ƒåº¦å’Œç»„åˆçš„ä¼˜åŒ–</strong>ã€‚</p>
<blockquote>
<p>åœ¨è°ƒåº¦è¿‡ç¨‹ä¸­ï¼Œ(1) IB å‘é€ï¼Œ(2) IB åˆ° NVLink è½¬å‘ï¼Œä»¥åŠ (3) NVLink æ¥æ”¶åˆ†åˆ«ç”±å„è‡ªçš„ warp å¤„ç†ã€‚åˆ†é…ç»™æ¯ä¸ªé€šä¿¡ä»»åŠ¡çš„ warp æ•°ä¼šæ ¹æ®æ‰€æœ‰ SM ä¸Šçš„å®é™…å·¥ä½œè´Ÿè½½åŠ¨æ€è°ƒæ•´ã€‚<br>åœ¨åˆå¹¶è¿‡ç¨‹ä¸­ï¼Œ(1) NVLink å‘é€ï¼Œ(2) NVLink åˆ° IB çš„è½¬å‘å’Œç´¯ç§¯ï¼Œä»¥åŠ (3) IB æ¥æ”¶å’Œç´¯ç§¯ä¹Ÿç”±åŠ¨æ€è°ƒæ•´çš„ warp å¤„ç†ã€‚</p>
</blockquote>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒIB å’Œ NVLink çš„é€šä¿¡å®ç°å®Œå…¨é‡å ï¼Œæ¯ä¸ª token èƒ½å¤Ÿåœ¨ä¸äº§ç”Ÿ NVLink é¢å¤–å¼€é”€çš„æƒ…å†µä¸‹ï¼Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå¹³å‡é«˜æ•ˆé€‰æ‹© 3.2 ä¸ªä¸“å®¶ã€‚è¿™æ„å‘³ç€ï¼Œè™½ç„¶ DeepSeek-V3 å®é™…åªé€‰æ‹© 8 ä¸ªè·¯ç”±ä¸“å®¶ï¼Œä½†å®ƒå¯ä»¥å°†è¿™ä¸ªæ•°å­—æ‰©å±•åˆ°æœ€å¤š 13 ä¸ªä¸“å®¶ï¼ˆ4 ä¸ªèŠ‚ç‚¹ Ã— 3.2 ä¸ªä¸“å®¶/èŠ‚ç‚¹ï¼‰ï¼ŒåŒæ—¶ä¿æŒç›¸åŒçš„é€šä¿¡æˆæœ¬ã€‚</p>
<blockquote>
<p>DSV3é‡‡ç”¨äº†1ä¸ªå…±äº«ä¸“å®¶å’Œ256ä¸ªè·¯ç”±ä¸“å®¶çš„MoEæ¶æ„ï¼Œæ¯ä¸ªtokenä¼šæ¿€æ´»8ä¸ªè·¯ç”±ä¸“å®¶ã€‚</p>
</blockquote>
<h4 id="2-2-3-ç”¨äºFP8è®­ç»ƒçš„æ··åˆç²¾åº¦æ¡†æ¶"><a href="#2-2-3-ç”¨äºFP8è®­ç»ƒçš„æ··åˆç²¾åº¦æ¡†æ¶" class="headerlink" title="2.2.3 ç”¨äºFP8è®­ç»ƒçš„æ··åˆç²¾åº¦æ¡†æ¶"></a>2.2.3 ç”¨äºFP8è®­ç»ƒçš„æ··åˆç²¾åº¦æ¡†æ¶</h4><p>è¿™é‡Œå¹¶æ²¡æœ‰å°†å…¨é‡å‚æ•°FP8é‡åŒ–è®­ç»ƒï¼Œå¤§å¤šæ•°è®¡ç®—å¯†é›†å‹æ“ä½œéƒ½åœ¨FP8ä¸­è¿›è¡Œï¼Œè€Œä¸€äº›å…³é”®æ“ä½œåˆ™æˆ˜ç•¥æ€§åœ°ä¿ç•™å…¶åŸå§‹æ•°æ®æ ¼å¼ï¼Œä»¥å¹³è¡¡è®­ç»ƒæ•ˆç‡å’Œæ•°å€¼ç¨³å®šæ€§ã€‚</p>
<p><strong>å“ªäº›ç®—å­å¯ç”¨FP8é‡åŒ–å»è®¡ç®—ï¼Ÿå–èˆé€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>å¤§å¤šæ•°æ ¸å¿ƒè®¡ç®—è¿‡ç¨‹ï¼Œå³ GEMM è¿ç®—ï¼Œéƒ½ä»¥ FP8 ç²¾åº¦å®ç°</li>
<li>æ¶‰åŠå¯¹ä½ç²¾åº¦è®¡ç®—çš„æ•æ„Ÿæ€§çš„ç®—å­ï¼Œä»ç„¶éœ€è¦æ›´é«˜çš„ç²¾åº¦</li>
<li>ä¸€äº›ä½æˆæœ¬ç®—å­ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´é«˜çš„ç²¾åº¦<br>ä»¥ä¸‹ç»„ä»¶ä¿ç•™äº†åŸå§‹ç²¾åº¦ï¼ˆä¾‹å¦‚ï¼ŒBF16 æˆ– FP32ï¼‰ï¼šEmbeddingæ¨¡å—ã€è¾“å‡ºå¤´ã€MoE é—¨æ§æ¨¡å—ã€Normalization ç®—å­ä»¥åŠ Attention ç®—å­ã€‚</li>
</ul>
<p><strong>å¦‚ä½•æé«˜ä½ç²¾åº¦è®­ç»ƒç²¾åº¦ï¼Ÿ</strong></p>
<ul>
<li>ç»†ç²’åº¦é‡åŒ–<blockquote>
<p>å¯¹æ¿€æ´»ï¼Œåœ¨tokenç»´åº¦é‡‡ç”¨group-wiseçš„é‡åŒ–(1<em>128)ï¼›å¯¹æƒé‡ï¼Œé‡‡ç”¨128</em> 128çš„block-wiseé‡åŒ–<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/20.jpg"></p>
</blockquote>
</li>
<li>æé«˜ç´¯åŠ ç²¾åº¦<blockquote>
<p>åœ¨ TensorCore ä¸Šæ‰§è¡ŒçŸ©é˜µ MMAï¼ˆçŸ©é˜µä¹˜æ³•ç´¯åŠ ï¼‰æ“ä½œæ—¶ï¼Œæ¯å½“ç´¯åŠ è¾¾åˆ°ä¸€ä¸ªé—´éš”æ—¶ï¼Œè¿™äº›éƒ¨åˆ†ç»“æœä¼šè¢«ä¼ è¾“åˆ° CUDA Cores ä¸Šçš„ FP32 å¯„å­˜å™¨ä¸­ï¼Œå¹¶åœ¨é‚£é‡Œè¿›è¡ŒFP32 ç²¾åº¦çš„ç´¯åŠ è®¡ç®—ã€‚<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/21.jpg"></p>
</blockquote>
</li>
</ul>
<h4 id="2-2-4-MTPçš„è®­ç»ƒç›®æ ‡"><a href="#2-2-4-MTPçš„è®­ç»ƒç›®æ ‡" class="headerlink" title="2.2.4 MTPçš„è®­ç»ƒç›®æ ‡"></a>2.2.4 MTPçš„è®­ç»ƒç›®æ ‡</h4><p>DeepSeekV3è®­ç»ƒè¿‡ç¨‹è®¾ç½®äº†å¤šTokené¢„æµ‹çš„ç›®æ ‡ï¼Œä»æŠ€æœ¯æŠ¥å‘Šçš„æ¶ˆèå®éªŒçœ‹å‡ºï¼Œç¡®å®æé«˜äº†æ¨¡å‹åœ¨å¤§å¤šæ•°è¯„ä¼°åŸºå‡†ä¸Šçš„æ€§èƒ½ï¼Œè€Œä¸”MTPæ¨¡å—è¿˜å¯ä»¥ç”¨äºæ¨ç†åŠ é€Ÿã€‚<br><img src="/2025/02/07/DeepSeek%E7%9A%84%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF/22.jpg"></p>
<h4 id="2-2-5-æ¨ç†éƒ¨ç½²æ–¹æ¡ˆ"><a href="#2-2-5-æ¨ç†éƒ¨ç½²æ–¹æ¡ˆ" class="headerlink" title="2.2.5 æ¨ç†éƒ¨ç½²æ–¹æ¡ˆ"></a>2.2.5 æ¨ç†éƒ¨ç½²æ–¹æ¡ˆ</h4><p>DeepSeek-V3 æ•´ä½“å‚æ•°é‡è¾¾åˆ°äº†671Bï¼Œå¦‚æ­¤å¤šçš„å‚æ•°é‡ï¼Œæˆ‘ä»¬çœ‹ä¸‹ä»–çš„ä¸€ä¸ªéƒ¨ç½²æ–¹æ¡ˆï¼š<br><strong>æ¨ç†éƒ¨ç½²é‡‡ç”¨äº†é¢„å¡«å……(Prefilling)å’Œè§£ç (Decoding)åˆ†ç¦»çš„ç­–ç•¥</strong>ï¼Œç¡®ä¿äº†åœ¨çº¿æœåŠ¡çš„é«˜ååé‡å’Œä½å»¶è¿Ÿã€‚é€šè¿‡å†—ä½™ä¸“å®¶éƒ¨ç½²å’ŒåŠ¨æ€è·¯ç”±ç­–ç•¥ï¼Œæ¨¡å‹åœ¨æ¨ç†æ—¶ä¿æŒäº†é«˜æ•ˆçš„è´Ÿè½½å‡è¡¡ã€‚<br>æ•´å¥—éƒ¨ç½²æ–¹æ¡ˆä¸‹æ¥åŸºæœ¬æ˜¯è·¨æœºåˆ†å¸ƒå¼æ¨ç†ã€‚</p>
<p>2.2.5.1 Prefill é˜¶æ®µ<br>è¿™ä¸ªé˜¶æ®µç®€å•è¯´å°±æ˜¯å¹¶è¡Œå¤„ç†ç”¨æˆ·çš„Promptï¼Œå°†å…¶è½¬ä¸ºKV Cacheã€‚</p>
<blockquote>
<p>é¢„å¡«å……é˜¶æ®µçš„æœ€å°éƒ¨ç½²å•å…ƒç”±4ä¸ªèŠ‚ç‚¹ç»„æˆï¼Œæ¯ä¸ªèŠ‚ç‚¹é…å¤‡32ä¸ªGPUã€‚æ³¨æ„åŠ›éƒ¨åˆ†é‡‡ç”¨4è·¯å¼ é‡å¹¶è¡Œï¼ˆTP4ï¼‰å’Œåºåˆ—å¹¶è¡Œï¼ˆSPï¼‰ï¼Œå¹¶ç»“åˆ8è·¯æ•°æ®å¹¶è¡Œï¼ˆDP8ï¼‰ã€‚å…¶è¾ƒå°çš„TPè§„æ¨¡ï¼ˆ4è·¯ï¼‰é™åˆ¶äº†TPé€šä¿¡çš„å¼€é”€ã€‚å¯¹äºMoEéƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨32è·¯ä¸“å®¶å¹¶è¡Œï¼ˆEP32ï¼‰</p>
</blockquote>
<p>2.2.5.2 Decoder é˜¶æ®µ<br>è¿™ä¸ªé˜¶æ®µå°±æ˜¯åšè‡ªå›å½’çš„æ¯ä¸ªTokençš„è¾“å‡ºã€‚</p>
<blockquote>
<p>è§£ç é˜¶æ®µçš„æœ€å°éƒ¨ç½²å•å…ƒç”±40ä¸ªèŠ‚ç‚¹å’Œ320ä¸ªGPUç»„æˆã€‚æ³¨æ„åŠ›éƒ¨åˆ†é‡‡ç”¨TP4å’ŒSPï¼Œç»“åˆDP80ï¼Œè€ŒMoEéƒ¨åˆ†ä½¿ç”¨EP320ã€‚å¯¹äºMoEéƒ¨åˆ†ï¼Œæ¯ä¸ªGPUåªæ‰¿è½½ä¸€ä¸ªä¸“å®¶ï¼Œ64ä¸ªGPUè´Ÿè´£æ‰¿è½½å†—ä½™ä¸“å®¶å’Œå…±äº«ä¸“å®¶ï»¿</p>
</blockquote>
<h2 id="æ€»ç»“ï¼šä¸ºä»€ä¹ˆDeepSeekV3è®­ç»ƒæˆæœ¬è¿™ä¹ˆä½ï¼Ÿ"><a href="#æ€»ç»“ï¼šä¸ºä»€ä¹ˆDeepSeekV3è®­ç»ƒæˆæœ¬è¿™ä¹ˆä½ï¼Ÿ" class="headerlink" title="æ€»ç»“ï¼šä¸ºä»€ä¹ˆDeepSeekV3è®­ç»ƒæˆæœ¬è¿™ä¹ˆä½ï¼Ÿ"></a>æ€»ç»“ï¼šä¸ºä»€ä¹ˆDeepSeekV3è®­ç»ƒæˆæœ¬è¿™ä¹ˆä½ï¼Ÿ</h2><p><strong>è®­ç»ƒæˆæœ¬ä¸»è¦ç”±æ¨¡å‹æ¶æ„ä»¥åŠè®­ç»ƒæ¶æ„æ‰€å†³å®šï¼Œè€Œä¸”ä¸¤è€…ä¸€å®šæ˜¯ç›¸è¾…ç›¸æˆã€‚ä»æŠ¥å‘Šä¸­å¯ä»¥çœ‹å‡ºä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š</strong><br>I.<strong>MLA æœºåˆ¶</strong>ï¼šé€šè¿‡å¯¹KVåšè”åˆä½ç§©å‹ç¼©å¤§å¹…å‡å°‘KV Cacheï¼Œç›¸æ¯”ä¸šç•Œä»KVæ•°é‡è§’åº¦åšKV Cacheçš„å‡å°‘ï¼ŒMLA çš„å‹ç¼©å®ç°å¾ˆè€ƒéªŒç ”ç©¶å›¢é˜Ÿçš„åŸºæœ¬åŠŸã€‚<br>II.<strong>FP8 è®­ç»ƒ</strong>ï¼šé€šè¿‡ä½ç²¾åº¦è®¡ç®—å‡å°‘äº† GPU å†…å­˜ä½¿ç”¨å’Œè®¡ç®—å¼€é”€ï¼ŒæŠ€æœ¯æŠ¥å‘Šä¸­ä¹Ÿæåˆ°FP8æ··åˆç²¾åº¦è®­ç»ƒæ¡†æ¶æ˜¯é¦–æ¬¡åœ¨ä¸€ä¸ªæå¤§è§„æ¨¡çš„æ¨¡å‹ä¸ŠéªŒè¯äº†å…¶æœ‰æ•ˆæ€§ï¼Œè¿™ä¸€ç‚¹ä¹Ÿçœ‹å‡ºDeepSeekçš„Infraå·¥ç¨‹å›¢é˜Ÿçš„åº•è•´ã€‚<br>III.<strong>MoE æ¶æ„</strong>ï¼šé€šè¿‡MoEç¨€ç–æ¿€æ´»æœºåˆ¶å¤§å¹…å‡å°‘äº†è®¡ç®—é‡ï¼Œç›¸æ¯”Qwenå’ŒLlamaçš„Denseæ¶æ„æœ‰å¾ˆå¤§çš„è®­æ¨å…ˆå¤©ä¼˜åŠ¿ï¼Œä¸è¿‡éš¾é¢˜(ä¸“å®¶çš„è´Ÿè½½ã€é€šä¿¡ã€è·¯ç”±)ä¹Ÿç»™åˆ°äº†Infraå·¥ç¨‹å›¢é˜Ÿã€‚</p>
<h2 id="ä¸‰ã€ä¸ºä»€ä¹ˆæ˜¯DeepSeekï¼Ÿ"><a href="#ä¸‰ã€ä¸ºä»€ä¹ˆæ˜¯DeepSeekï¼Ÿ" class="headerlink" title="ä¸‰ã€ä¸ºä»€ä¹ˆæ˜¯DeepSeekï¼Ÿ"></a>ä¸‰ã€ä¸ºä»€ä¹ˆæ˜¯DeepSeekï¼Ÿ</h2><p>åœ¨ç¡…è°·ï¼Œç±»ä¼¼DeepSeekè¿™æ ·çš„AIåˆ›æ–°å¹¶ä¸å°‘æœ‰ï¼Œåªæ˜¯è¿™æ¬¡æ˜¯ä¸€å®¶ä¸­å›½å…¬å¸åšå‡ºäº†è¿™ä¸ªåŠ¨ä½œï¼Œç›¸æ¯”ä¼ ç»Ÿçš„â€˜ç¾å›½åˆ›æ–°ã€ä¸­å›½åº”ç”¨â€™çš„æ¨¡å¼æ˜¾å¾—æ ¼å¤–çš„è®©äººå…´å¥‹ã€‚</p>
<p>ä»æœ€è¿‘çš„ä¸€äº›è®¿è°ˆä»¥åŠDeepSeekçš„æŠ€æœ¯æŠ¥å‘Šä¸­ä¹Ÿèƒ½çœ‹å‡ºä»¥ä¸‹å‡ ç‚¹ï¼š<br>1ã€å¤§æ¨¡å‹æ˜¯ä¸€ä¸ªçŸ¥è¯†å¯†é›†å‹äº§ä¸šï¼Œå¦‚ä½•ç»„ç»‡é«˜å¯†åº¦äººæ‰ï¼Ÿæ˜¾ç„¶DeepSeekåšåˆ°äº†ã€‚<br>2ã€å¤§æ¨¡å‹æŠ€æœ¯æ²¡æœ‰é­”æ³•ï¼Œæ›´å¤šæ—¶å€™å°±æ˜¯è€ƒéªŒåŸºæœ¬åŠŸå’Œé©±åŠ¨åŠ›ã€‚<br>3ã€ä¸ä»¥å•†ä¸šåŒ–ä¸ºç¬¬ä¸€è¦ä¹‰ï¼Œå¾ˆå¤šæ—¶å€™èƒ½è½»è£…ä¸Šé˜µã€‚</p>
<h2 id="å››ã€ä¸ªäººæ€è€ƒ"><a href="#å››ã€ä¸ªäººæ€è€ƒ" class="headerlink" title="å››ã€ä¸ªäººæ€è€ƒ"></a>å››ã€ä¸ªäººæ€è€ƒ</h2><p>1ã€é•¿è¿œæ¥çœ‹ï¼Œåç»­å¯èƒ½ä¼šæœ‰ä¸“é—¨çš„é€‚é…Transformeræ¶æ„çš„èŠ¯ç‰‡ï¼Œå°±åƒä¸ºå·ç§¯è®¾è®¡äº†ASICèŠ¯ç‰‡ã€‚<br>2ã€å¤šTokené¢„æµ‹ã€MoEæ¶æ„å¯èƒ½å¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½æ˜¯å¤§æ¨¡å‹è®­æ¨æ¶æ„çƒ­é—¨ç ”ç©¶æ–¹å‘ã€‚<br>3ã€åœ¨å›½å†…åšAIï¼Œåº”ç”¨å§‹ç»ˆä¼šæ¯”åŸºç¡€ç ”ç©¶æœ‰å¸‚åœºï¼Œæ›´æœ‰è¯è¯­æƒï¼Œä½†æ˜¯åŸºç¡€åˆ›æ–°å’Œæµ·å¤–çš„ä»£é™…å·®è·ä¼šè¶Šæ¥è¶Šå°ã€‚<br>4ã€å¤§æ¨¡å‹è®­ç»ƒå’Œæ¨ç†ï¼Œè½¯ç¡¬ä»¶æ˜¯ä¸€ä¸ªååŒçš„ç”Ÿæ€ï¼ŒDeepSeekçš„å‡ºç°å°†ä¼šä¿ƒè¿›AIå…¨è¡Œä¸šçš„æ›´åŠ å¿«é€Ÿä¸”ä½æˆæœ¬çš„è¿­ä»£ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>1ã€<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2404.19737">Better &amp; Faster Large Language Models via Multi-token Predictionï»¿</a><br>4ã€<a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2412.19437">DeepSeek-V3 Technical Report</a>ï»¿<br>5ã€<a target="_blank" rel="noopener" href="https://arxiv.org/pdf/2405.04434">DeepSeek-V2: A Strong, Economical, and Efficient Mixture-of-Experts Language Model</a>ï»¿<br>6ã€<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/8423473404">deepseek v3çš„æˆæœ¬è¿™ä¹ˆä½çš„æ ¹æœ¬åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</a>ï»¿<br>7ã€<a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1811.06965">GPipe: Easy Scaling with Micro-Batch Pipeline Parallelism</a> ï»¿</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/54/">54</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Weiming Zhuang</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>




</body>
</html>
